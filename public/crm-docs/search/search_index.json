{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"CRM Dokumentace","text":"<p>Tato str\u00e1nka obsahuje okam\u017eit\u00fd n\u00e1vod jak dokumentaci spr\u00e1vn\u011b udr\u017eovat a tak\u00e9 p\u0159ipraven\u00fd AI prompt pro kontextov\u00e9 dotazy / generov\u00e1n\u00ed.</p>"},{"location":"#jak-udrzovat-dokumentaci","title":"Jak udr\u017eovat dokumentaci","text":"<p>Principy: 1. Single Source of Truth: Generovan\u00e9 reference v <code>docs/16-generated</code> NIKDY ru\u010dn\u011b needitovat (\u00fapravy pouze p\u0159es k\u00f3d / gener\u00e1tor v <code>DocsRefresh</code> nebo meta soubory). 2. Viditelnost Diff\u016f: Ka\u017ed\u00e1 zm\u011bna model\u016f / rout / job\u016f \u2192 v\u017edy <code>php artisan docs:refresh</code> p\u0159ed commitem (CI failne pokud chyb\u00ed diff commit). 3. Popisy Menu: Texty sekc\u00ed a polo\u017eek v CRM menu udr\u017eovat v <code>docs/_meta/menu.php</code> (gener\u00e1tor vytvo\u0159\u00ed tabulky v <code>navigation.md</code>). 4. Strukturovan\u00e9 Rozhodnut\u00ed: Ka\u017ed\u00e9 v\u00fdznamn\u00e9 arch / procesn\u00ed rozhodnut\u00ed \u2192 p\u0159idat ADR do <code>docs/12-adr</code> (pou\u017eij \u0161ablonu <code>15-templates/adr-template.md</code>). 5. Modulov\u00e1 Dokumentace: Ka\u017ed\u00fd nov\u00fd modul m\u00e1 vlastn\u00ed soubor v <code>docs/04-modules</code> + dopln\u011bn\u00ed do <code>mkdocs.yml</code> + p\u0159\u00edpadn\u011b sekci v \"Jak CRM funguje\". 6. Generovan\u00e9 Artefakty: P\u0159id\u00e1n\u00ed nov\u00e9ho typu generovan\u00e9ho v\u00fdstupu \u2192 roz\u0161\u00ed\u0159it t\u0159\u00eddu <code>app/Console/Commands/DocsRefresh.php</code> a p\u0159idat do nav v <code>mkdocs.yml</code>. 7. Review Cadence: Minim\u00e1ln\u011b 1\u00d7 t\u00fddn\u011b proj\u00edt (a) po\u010det v\u00fdskyt\u016f <code>_(popis chyb\u00ed)_</code> v <code>navigation.md</code>, (b) zastaral\u00e9 ADR (doplnit superseded), (c) zm\u011bny sch\u00e9matu vs. DB Schema (gen). 8. Minim\u00e1ln\u00ed Metadata Model\u016f: P\u0159i p\u0159id\u00e1n\u00ed modelu doplnit <code>$fillable</code>, <code>$casts</code> a stru\u010dn\u00fd PHPDoc (prvn\u00ed \u0159\u00e1dek se prom\u00edtne v job katalogu / budouc\u00edch gener\u00e1torech). 9. Alerting &amp; Observability: P\u0159i p\u0159id\u00e1n\u00ed nov\u00e9 ops aktivity logovat p\u0159es <code>OpsActivity</code> pro budouc\u00ed metriky. 10. AI Ready: Preferovat kr\u00e1tk\u00e9, deklarativn\u00ed odstavce p\u0159ed dlouh\u00fdmi esejemi \u2013 usnad\u0148uje extrakci kontextu pro AI.</p> <p>Workflow (rychl\u00fd check\u2011list p\u0159ed PR): - [ ] Zm\u011bny k\u00f3du ovliv\u0148uj\u00ed routy / joby / schedule / modely?     - Ano \u2192 spustit <code>php artisan docs:refresh</code>. - [ ] P\u0159ibyly nov\u00e9 menu polo\u017eky? \u2192 aktualizovat <code>docs/_meta/menu.php</code>. - [ ] Nov\u00e9 rozhodnut\u00ed? \u2192 ADR. - [ ] Nov\u00fd modul / integrace? \u2192 modulov\u00fd soubor + <code>.env.example</code> prom\u011bnn\u00e9 + sekce v How it Works. - [ ] Build statick\u00e9ho webu (voliteln\u00e9 lok\u00e1ln\u011b) <code>bash scripts/docs/build.sh</code>.</p> <p>Nej\u010dast\u011bj\u0161\u00ed chyby &amp; prevence: | Chyba | Prevence | |-------|----------| | Chyb\u011bj\u00edc\u00ed commit generovan\u00fdch soubor\u016f | Spustit <code>docs:refresh</code> p\u0159ed push (CI detekuje) | | Rozbit\u00e1 navigace (mkdocs) | Po editaci <code>mkdocs.yml</code> rychle spustit lok\u00e1ln\u00ed build | | Nezdokumentovan\u00e1 nov\u00e1 route | P\u0159idat popis do <code>menu.php</code> (jinak (popis chyb\u00ed)) | | Zapomenut\u00e9 ADR | P\u0159ed merge zkontrolovat difflog / PR konverzaci |</p> <p>Z\u00e1kladn\u00ed adres\u00e1\u0159ov\u00e9 role: | Cesta | \u00da\u010del | |-------|------| | <code>docs/01-intro</code> | Vysv\u011btluj\u00edc\u00ed vstupn\u00ed p\u0159ehled (How it works) | | <code>docs/02-architecture</code> | Architektonick\u00e9 diagramy / p\u0159ehledy | | <code>docs/03-domain</code> | Dom\u00e9nov\u00fd model, ERD reference odkazy | | <code>docs/04-modules</code> | Modulov\u00e9 dokumenty (ru\u010dn\u00ed) | | <code>docs/12-adr</code> | Architecture Decision Records | | <code>docs/13-runbooks</code> | Operativn\u00ed runbooky | | <code>docs/14-checklists</code> | Kontroln\u00ed seznamy | | <code>docs/15-templates</code> | \u0160ablony (ADR, modul) | | <code>docs/16-generated</code> | Auto generovan\u00e9 reference | | <code>docs/_meta</code> | Konfig / mapov\u00e1n\u00ed pro gener\u00e1tory |</p>"},{"location":"#ai-prompt-kopiruj-vloz-do-nastroje","title":"AI Prompt (kop\u00edruj &amp; vlo\u017e do n\u00e1stroje)","text":"<p>Pou\u017eij tento prompt pro AI agenta, aby efektivn\u011b dopl\u0148oval / aktualizoval dokumentaci.</p> <pre><code>SYSTEM CONTEXT:\nJsi technick\u00fd dokumenta\u010dn\u00ed asistent pro Laravel CRM projekt. Dodr\u017euj existuj\u00edc\u00ed strukturu MkDocs.\n\nREPO DOKUMENTA\u010cN\u00cd ZDROJE (priority):\n1. How it Works: docs/01-intro/how-it-works.md (business &amp; flow context)\n2. Domain Model + ERD + Model Fields: docs/03-domain/*.md + docs/16-generated/erd.md + model-fields.md + db-schema.md\n3. Menu / Navigace: docs/16-generated/navigation.md + meta popisy v docs/_meta/menu.php\n4. Ops / Runbooks: docs/04-modules/ops.md + docs/13-runbooks/ops-runbook.md\n5. ADR: docs/12-adr (rozhodnut\u00ed \u2013 respektuj, pokud nejsou superseded)\n6. Generovan\u00e9 reference: docs/16-generated (NEedituj ru\u010dn\u011b)\n\nPO\u017dADAVKY NA TVORBU / \u00daPRAVY:\n- Pokud zm\u011bna vy\u017eaduje generovan\u00fd soubor, navrhni \u00fapravu k\u00f3du (DocsRefresh) m\u00edsto ru\u010dn\u00ed editace.\n- Stru\u010dn\u00e9 v\u011bcn\u00e9 formulace, prvn\u00ed odstavec ka\u017ed\u00e9 nov\u00e9 sekce = summary pro embedding.\n- Ka\u017ed\u00fd nov\u00fd modul: soubor v docs/04-modules + aktualizace mkdocs.yml + p\u0159\u00edpadn\u00fd z\u00e1znam v How it Works.\n- Nov\u00e9 rozhodnut\u00ed: vytvo\u0159 ADR dle \u0161ablony docs/15-templates/adr-template.md.\n- U menu polo\u017eek: pokud p\u0159id\u00e1v\u00e1\u0161 nebo roz\u0161i\u0159uje\u0161 route, dopl\u0148 popis do docs/_meta/menu.php.\n\nKONTROLY P\u0158ED HOTOVO:\n1. Je pot\u0159eba spustit `php artisan docs:refresh`? (routy / modely / joby / schedule zm\u011bny)\n2. Byl upraven `mkdocs.yml` pokud p\u0159ibyly ru\u010dn\u00ed str\u00e1nky?\n3. Z\u016fstaly n\u011bkde placeholdery \"(popis chyb\u00ed)\" kter\u00e9 lze doplnit?\n4. Pot\u0159ebuje zm\u011bna ADR (nov\u00e9 nebo superseded)?\n\nV\u00ddSTUP:\n- Seznam p\u0159esn\u00fdch soubor\u016f k vytvo\u0159en\u00ed/\u00faprav\u011b.\n- Stru\u010dn\u00e9 shrnut\u00ed pro\u010d.\n- N\u00e1vrh patch\u016f (diff styl) NEobsahuj\u00edc\u00ed generovan\u00e9 16-generated*.md soubory.\n\nBezpe\u010dnost: Neunikat tajn\u00e9 hodnoty z .env ani credentials.\n</code></pre> <p>Profesn\u00ed intern\u00ed dokumentace generovan\u00e1 z Markdown + automatick\u00fdch v\u00fdpis\u016f.</p>"},{"location":"#rychly-start","title":"Rychl\u00fd start","text":"<ol> <li><code>php artisan docs:refresh</code> \u2013 regenerace referenc\u00ed.</li> <li><code>bash scripts/docs/build.sh</code> \u2013 build HTML (vy\u017eaduje Docker).</li> <li>Otev\u0159i <code>site/index.html</code> nebo publikovan\u00e9 <code>/crm-docs/</code>.</li> </ol>"},{"location":"#sekce-stav","title":"Sekce (stav)","text":"<ul> <li>Architektura \u2013 skeleton.</li> <li>Moduly \u2013 Ops hotovo; dal\u0161\u00ed TBD.</li> <li>Runtime \u2013 generovan\u00e9 (routy, schedule, jobs, env matrix).</li> <li>Runbook \u2013 udr\u017eov\u00e1n v <code>docs/13-runbooks</code>.</li> </ul>"},{"location":"#konvence","title":"Konvence","text":"<ul> <li>Slo\u017eka <code>docs/16-generated</code> = auto output (commitovat). </li> <li>Ru\u010dn\u011b psan\u00e9 soubory: modulov\u00e9, ADR, architektura.</li> </ul>"},{"location":"#prikazy","title":"P\u0159\u00edkazy","text":"\u00da\u010del P\u0159\u00edkaz Regenerace <code>php artisan docs:refresh</code> Build HTML <code>bash scripts/docs/build.sh</code>"},{"location":"#dalsi-kroky","title":"Dal\u0161\u00ed kroky","text":"<ul> <li>Doplnit modul ActiveCampaign, Knowledge.</li> <li>Zav\u00e9st ADR prvn\u00ed sady.</li> </ul>"},{"location":"01-intro/changelog/","title":"Changelog &amp; Release Notes","text":"<p>Tento dokument udr\u017euje auditn\u00ed stopu v\u00fdznamn\u00fdch zm\u011bn aplikace. Ka\u017ed\u00e1 polo\u017eka mus\u00ed b\u00fdt konzistentn\u00ed s principy dokumentace (aktu\u00e1lnost, jasn\u00e1 orientace, dopad na u\u017eivatele a provoz).</p>"},{"location":"01-intro/changelog/#format-polozky","title":"Form\u00e1t polo\u017eky","text":"<pre><code>## [YYYY-MM-DD] vX.Y.Z (TYPE)\n### Shrnut\u00ed\nStru\u010dn\u00e1 v\u011bta co se zm\u011bnilo / p\u0159ibylo / opravilo.\n\n### Detaily\n- Kontext / d\u016fvod\n- Co bylo p\u0159id\u00e1no / zm\u011bn\u011bno / odstran\u011bno\n- Dot\u010den\u00e9 moduly / routes / config\n\n### Dopady\n- U\u017eivatel: \u2026\n- Provoz / infra: \u2026\n- Bezpe\u010dnost / compliance: \u2026 (pokud relevantn\u00ed)\n\n### Migrace / Kroky po nasazen\u00ed\n- \u2026\n\n### Odkazy\n- ADR: \u2026\n- Souvisej\u00edc\u00ed dokumenty: \u2026\n</code></pre> <p>TYPE pou\u017e\u00edvejte: <code>ADDED</code>, <code>CHANGED</code>, <code>FIXED</code>, <code>REMOVED</code>, <code>SECURITY</code>, <code>PERF</code>, <code>DOCS</code>.</p> <p>Nov\u00e9 polo\u017eky p\u0159id\u00e1vejte NAHORU (nejnov\u011bj\u0161\u00ed prvn\u00ed) kv\u016fli rychl\u00e9 orientaci.</p>"},{"location":"01-intro/changelog/#posledni-zmeny","title":"Posledn\u00ed zm\u011bny","text":"<p>Planned: Produktov\u00fd modul (synchronizace Heureka feed\u016f) \u2013 bude verzov\u00e1no jako <code>ADDED</code> po dokon\u010den\u00ed f\u00e1ze 1 (datov\u00fd model). N\u00e1vrh a implementa\u010dn\u00ed pl\u00e1n viz sekce Produkty v dokumentaci.</p>"},{"location":"01-intro/changelog/#2025-09-06-v017-changed-ui-security","title":"[2025-09-06] v0.1.7 (CHANGED / UI / SECURITY)","text":""},{"location":"01-intro/changelog/#shrnuti","title":"Shrnut\u00ed","text":"<p>Vylep\u0161en\u00e9 UI produkt\u016f (table styl jako \"Brands Listing\" + v\u00fdchoz\u00ed zobrazen\u00ed table) a \u00faprava bezpe\u010dnostn\u00edch hlavi\u010dek kv\u016fli na\u010d\u00edt\u00e1n\u00ed extern\u00edch obr\u00e1zk\u016f.</p>"},{"location":"01-intro/changelog/#detaily","title":"Detaily","text":"<ul> <li>P\u0159id\u00e1n nov\u00fd table layout pro <code>/crm/products?view=table</code> inspirovan\u00fd komponentou Brands Listing (avatar kruh, status te\u010dka, dropdown akce, kompaktn\u00ed footer).</li> <li>V\u00fdchoz\u00ed m\u00f3d p\u0159ep\u00edna\u010de grid/table zm\u011bn\u011bn na <code>table</code> (lep\u0161\u00ed datov\u00e1 hustota pro 2000+ z\u00e1znam\u016f).</li> <li>Odstran\u011bno duplicitn\u00ed str\u00e1nkov\u00e1n\u00ed (ponech\u00e1no jen ve footeru karty v table m\u00f3du).</li> <li>Grid m\u00f3d zachov\u00e1n (karty) \u2013 beze zm\u011bny logiky; pouze kosmetick\u00e9 drobnosti (hover, badge blur) ji\u017e d\u0159\u00edve.</li> <li>Do\u010dasn\u011b uvoln\u011bna politika CORP/COEP (komentov\u00e1no v <code>crm-headers.yml</code>) kv\u016fli hot-link obr\u00e1zk\u016fm z <code>www.esl.cz</code> (dodavatel nevrac\u00ed pot\u0159ebn\u00e9 hlavi\u010dky). Pl\u00e1n: pozd\u011bji proxy/cache lok\u00e1ln\u011b a obnovit striktn\u00ed politiky.</li> <li>CSP ji\u017e d\u0159\u00edve roz\u0161\u00ed\u0159eno o <code>img-src https:</code>; toto chov\u00e1n\u00ed ponech\u00e1no.</li> </ul>"},{"location":"01-intro/changelog/#dopady","title":"Dopady","text":"<ul> <li>U\u017eivatel: P\u0159ehledn\u011bj\u0161\u00ed tabulkov\u00e9 zobrazen\u00ed jako default \u2192 rychlej\u0161\u00ed orientace, m\u00e9n\u011b scrollov\u00e1n\u00ed.</li> <li>Provoz: Do\u010dasn\u00e9 sn\u00ed\u017een\u00ed izolace (COEP/CORP) \u2013 akceptovateln\u00e9 kr\u00e1tkodob\u011b; nutno sledovat budouc\u00ed reintrodukci politik.</li> <li>V\u00fdvoj: P\u0159ipraven\u00fd podklad pro per-user preference view (mo\u017eno pozd\u011bji ulo\u017eit do session / DB).</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky-po-nasazeni","title":"Migrace / Kroky po nasazen\u00ed","text":"<ol> <li>Nen\u00ed pot\u0159eba spou\u0161t\u011bt migrace.</li> <li>Ov\u011b\u0159it na\u010d\u00edt\u00e1n\u00ed produktov\u00fdch obr\u00e1zk\u016f (s\u00ed\u0165 v DevTools bez blokac\u00ed).</li> <li>Pozd\u011bji implementovat image proxy a znovu zapnout <code>Cross-Origin-Resource-Policy</code> a <code>Cross-Origin-Embedder-Policy</code>.</li> </ol>"},{"location":"01-intro/changelog/#odkazy","title":"Odkazy","text":"<ul> <li><code>resources/views/products/index.blade.php</code></li> <li><code>infra/traefik/dynamic/crm-headers.yml</code></li> <li><code>docs/01-intro/changelog.md</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-06-v016-added-changed","title":"[2025-09-06] v0.1.6 (ADDED / CHANGED)","text":""},{"location":"01-intro/changelog/#shrnuti_1","title":"Shrnut\u00ed","text":"<p>Implementace produktov\u00e9ho modulu (full import, delta dostupnost\u00ed, audit, pl\u00e1nova\u010d, OpsActivity logov\u00e1n\u00ed, UI z\u00e1klad).</p>"},{"location":"01-intro/changelog/#detaily_1","title":"Detaily","text":"<ul> <li>Migrace vytvo\u0159eny a aplikov\u00e1ny (<code>products</code>, <code>product_price_changes</code>, <code>product_availability_changes</code>).</li> <li>Full import (<code>products:import-full</code>) naplnil 2332 produkt\u016f (hash-based upsert, audit cen).</li> <li>Delta sync (<code>products:sync-availability</code>) s audit tabulkou (nullable <code>new_code</code>).</li> <li>Scheduler: full import denn\u011b 04:10, availability ka\u017ed\u00fdch 15 minut (Kernel schedule).</li> <li>OpsActivity logov\u00e1n\u00ed pro oba p\u0159\u00edkazy (duration, po\u010dty new/updated/unchanged, changes).</li> <li>UI routy <code>/crm/products</code> + detail; polo\u017eka v sidenav s permission guard <code>products.view</code>.</li> <li>P\u0159id\u00e1na permissions <code>products.view</code>, <code>products.sync</code> (p\u0159es sync command + HasRoles na <code>User</code>).</li> <li>Parser opraven (DOMDocument wrap) \u2013 p\u016fvodn\u00ed <code>simplexml_import_dom</code> edge case.</li> <li>Changelog + dokumentace (Products overview) aktualizov\u00e1ny o stav implementace.</li> </ul>"},{"location":"01-intro/changelog/#dopady_1","title":"Dopady","text":"<ul> <li>U\u017eivatel: Z\u00e1kladn\u00ed katalog produkt\u016f s histori\u00ed cen/dostupnosti (MVP) dostupn\u00fd v CRM.</li> <li>Provoz: Metriky b\u011bh\u016f import\u016f dostupn\u00e9 v <code>ops_activities</code>; mo\u017enost budouc\u00edho dashboardu.</li> <li>V\u00fdvoj: Stabiln\u00ed z\u00e1klad pro dal\u0161\u00ed optimalizace (indexy, roz\u0161\u00ed\u0159en\u00ed filtr\u016f, pricing engine integrace).</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky-po-nasazeni_1","title":"Migrace / Kroky po nasazen\u00ed","text":"<ol> <li><code>php artisan migrate --force</code> (ji\u017e prob\u011bhlo v prost\u0159ed\u00ed).</li> <li><code>php artisan products:permissions-sync</code> + p\u0159i\u0159adit <code>products.view</code> u\u017eivatel\u016fm (provedeno pro prvn\u00edho u\u017eivatele).</li> <li>Ov\u011b\u0159it cron b\u011bh scheduler kontejneru (jobs se spust\u00ed dle definic v Kernelu).</li> <li>Monitorovat OpsActivity polo\u017eky p\u0159i prvn\u00edm no\u010dn\u00edm b\u011bhu.</li> </ol>"},{"location":"01-intro/changelog/#odkazy_1","title":"Odkazy","text":"<ul> <li><code>app/Console/Commands/ProductsImportFull.php</code></li> <li><code>app/Console/Commands/ProductsSyncAvailability.php</code></li> <li><code>app/Services/Products/HeurekaProductStream.php</code></li> <li><code>app/Services/Products/AvailabilityDeltaStream.php</code></li> <li><code>app/Models/OpsActivity.php</code></li> <li><code>resources/views/products/</code></li> <li><code>routes/web.php</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-06-v015-fixed-docs","title":"[2025-09-06] v0.1.5 (FIXED / DOCS)","text":""},{"location":"01-intro/changelog/#shrnuti_2","title":"Shrnut\u00ed","text":"<p>Dal\u0161\u00ed stabilizace p\u0159ihl\u00e1\u0161en\u00ed (intermitentn\u00ed 419) + roz\u0161\u00ed\u0159en\u00ed dokumentace Produktov\u00e9ho modulu (anal\u00fdza re\u00e1ln\u00e9ho Heureka feedu, implementa\u010dn\u00ed pl\u00e1n) a p\u0159id\u00e1n\u00ed do navigace.</p>"},{"location":"01-intro/changelog/#detaily_2","title":"Detaily","text":"<ul> <li>Middleware hardening auth flow:<ul> <li>P\u0159id\u00e1n <code>NoCache</code> middleware (GET /login) \u2013 zabra\u0148uje serv\u00edrov\u00e1n\u00ed zastaral\u00e9 str\u00e1nky s neplatn\u00fdm CSRF tokenem z cache.</li> <li>P\u0159id\u00e1n <code>RotateSessionId</code> middleware (POST /login) \u2013 zaji\u0161\u0165uje regeneraci session ID (ochrana proti potenci\u00e1ln\u00edmu edge p\u0159\u00edpadu opakovan\u00e9ho pou\u017eit\u00ed).</li> <li>Logout nyn\u00ed \u010dist\u00ed intern\u00ed flag <code>_rotated</code>.</li> <li>Roz\u0161\u00ed\u0159en debug endpoint <code>/_debug/csrf</code> (dev) o <code>rotated_flag</code> pro sledov\u00e1n\u00ed regenerace.</li> <li>GET /login ozna\u010den <code>nocache</code> middlewarem; POST /login <code>rotate.session</code>.</li> </ul> </li> <li>Dokumentace:<ul> <li>P\u0159id\u00e1na sekce Produkty \u2192 Implementa\u010dn\u00ed pl\u00e1n + detailn\u00ed anal\u00fdza re\u00e1ln\u00e9ho feedu <code>heureka.xml</code> (frekvence tag\u016f, max d\u00e9lky, n\u00e1vrh DB sch\u00e9matu, transformace, mapov\u00e1n\u00ed dostupnosti).</li> <li>Aktualizov\u00e1na navigace (<code>mkdocs.yml</code>) \u2013 zano\u0159en\u00ed polo\u017eky Implementa\u010dn\u00ed pl\u00e1n.</li> <li>Ulo\u017eeny zdrojov\u00e9 feedy do <code>docs/feeds/</code> pro auditovatelnost anal\u00fdzy.</li> </ul> </li> <li>P\u0159\u00edprava datov\u00e9ho modelu: definov\u00e1na c\u00edlov\u00e1 tabulka <code>products</code> (price_vat_cents, category_hash, hash_payload, audit timestamps) + audit tabulky price &amp; availability changes.</li> </ul>"},{"location":"01-intro/changelog/#dopady_2","title":"Dopady","text":"<ul> <li>U\u017eivatel: P\u0159ihl\u00e1\u0161en\u00ed konzistentn\u011bj\u0161\u00ed i po opakovan\u00fdch cyklech p\u0159ihl\u00e1\u0161en\u00ed/odhl\u00e1\u0161en\u00ed.</li> <li>Provoz: Snadn\u011bj\u0161\u00ed diagnostika (roz\u0161\u00ed\u0159en\u00fd debug JSON + explicitn\u00ed no-store hlavi\u010dky).</li> <li>V\u00fdvoj: Jasn\u00fd, daty podlo\u017een\u00fd pl\u00e1n Produktov\u00e9ho modulu minimalizuje refaktoring pozd\u011bji.</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky-po-nasazeni_2","title":"Migrace / Kroky po nasazen\u00ed","text":"<ol> <li>Nasadit k\u00f3d (nov\u00e9 middleware t\u0159\u00eddy + \u00fapravy rout). </li> <li>Ov\u011b\u0159it v prohl\u00ed\u017ee\u010di (inkognito) 3\u00d7 cyklus login\u2192logout bez 419.</li> <li>Zkontrolovat logy na absenci nov\u00fdch TokenMismatch z\u00e1znam\u016f.</li> <li>Zah\u00e1jit implementaci migrac\u00ed pro <code>products</code> dle dokumentace.</li> </ol>"},{"location":"01-intro/changelog/#odkazy_2","title":"Odkazy","text":"<ul> <li><code>app/Http/Middleware/NoCache.php</code></li> <li><code>app/Http/Middleware/RotateSessionId.php</code></li> <li><code>routes/web.php</code></li> <li><code>bootstrap/app.php</code></li> <li><code>docs/06-products/implementation-plan.md</code></li> <li><code>docs/06-products/overview.md</code></li> <li><code>docs/feeds/heureka.xml</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-05-v014-fixed","title":"[2025-09-05] v0.1.4 (FIXED)","text":""},{"location":"01-intro/changelog/#shrnuti_3","title":"Shrnut\u00ed","text":"<p>Stabilizace p\u0159ihl\u00e1\u0161en\u00ed za reverzn\u00ed proxy: p\u0159id\u00e1n TrustProxies middleware, diagnostika CSRF a roz\u0161\u00ed\u0159en\u00e9 logov\u00e1n\u00ed token mismatch.</p>"},{"location":"01-intro/changelog/#detaily_3","title":"Detaily","text":"<ul> <li>P\u0159id\u00e1n <code>app/Http/Middleware/TrustProxies.php</code> (d\u016fv\u011bra X-Forwarded-* hlavi\u010dk\u00e1m: spr\u00e1vn\u00e1 detekce HTTPS \u2192 konzistentn\u00ed secure cookies / CSRF).</li> <li>Aktualizov\u00e1n <code>bootstrap/app.php</code> \u2013 za\u0159azen\u00ed <code>TrustProxies</code> na za\u010d\u00e1tek web stacku.</li> <li>Roz\u0161\u00ed\u0159en <code>VerifyCsrfToken</code> o detailn\u00ed log z\u00e1znam p\u0159i <code>TokenMismatchException</code> (session id, zkr\u00e1cen\u00e9 tokeny, UA, cookie presence, same-site, secure flag) pro rychlou anal\u00fdzu sporadick\u00fdch 419.</li> <li>P\u0159id\u00e1na neproduk\u010dn\u00ed diagnostick\u00e1 trasa <code>/_debug/csrf</code> (zobrazuje session_id, csrf token, cookie dom\u00e9nu / flagy) \u2013 automaticky vynech\u00e1na v <code>production</code>.</li> <li>Ov\u011b\u0159eno automatizovan\u00fdm prohl\u00ed\u017ee\u010dem: POST /login vrac\u00ed 302 (spr\u00e1vn\u00e9 chov\u00e1n\u00ed), \u017e\u00e1dn\u00fd 419.</li> </ul>"},{"location":"01-intro/changelog/#dopady_3","title":"Dopady","text":"<ul> <li>U\u017eivatel: P\u0159ihl\u00e1\u0161en\u00ed nyn\u00ed konzistentn\u00ed i za Traefik/Nginx (eliminace n\u00e1hodn\u00fdch 419).</li> <li>Provoz: Snadn\u00e9 lad\u011bn\u00ed budouc\u00edch probl\u00e9m\u016f d\u00edky strukturovan\u00e9mu logu a debug trase (ni\u017e\u0161\u00ed MTTR).</li> <li>Bezpe\u010dnost: Zachov\u00e1na ochrana CSRF; \u017e\u00e1dn\u00e9 otev\u0159en\u00ed v\u00fdjimek \u2013 debug endpoint nen\u00ed v produkci.</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky-po-nasazeni_3","title":"Migrace / Kroky po nasazen\u00ed","text":"<ol> <li>Nasadit zm\u011bny.</li> <li>Vymazat star\u00e9 cookies (pokud byly nastavov\u00e1ny s nespr\u00e1vn\u00fdm sch\u00e9matem) \u2013 voliteln\u00e9.</li> <li>Zkontrolovat logy na absenci nov\u00fdch \"CSRF token mismatch\" z\u00e1znam\u016f po b\u011b\u017en\u00e9m pou\u017e\u00edv\u00e1n\u00ed.</li> <li>Po ov\u011b\u0159en\u00ed lze p\u0159\u00edpadn\u011b odstranit diagnostick\u00fd endpoint (ponech\u00e1no do\u010dasn\u011b pro monitoring prvn\u00ed t\u00fdden).</li> </ol>"},{"location":"01-intro/changelog/#odkazy_3","title":"Odkazy","text":"<ul> <li><code>app/Http/Middleware/TrustProxies.php</code></li> <li><code>app/Http/Middleware/VerifyCsrfToken.php</code></li> <li><code>bootstrap/app.php</code></li> <li><code>routes/web.php</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-04-v013-docs","title":"[2025-09-04] v0.1.3 (DOCS)","text":""},{"location":"01-intro/changelog/#shrnuti_4","title":"Shrnut\u00ed","text":"<p>Roz\u0161\u00ed\u0159ena a zp\u0159esn\u011bna dokumentace: nov\u00e9 README, pr\u016fvodce \u0161ablonou Adminto, skript pro build statick\u00fdch docs a validace changelogu v release pipeline.</p>"},{"location":"01-intro/changelog/#detaily_4","title":"Detaily","text":"<ul> <li>P\u0159id\u00e1n dokument <code>Adminto \u0160ablona</code> (<code>docs/02-architecture/adminto-template.md</code>) \u2013 integrace, pluginy, roadmap.</li> <li>P\u0159id\u00e1n skript <code>scripts/build-docs.sh</code> (Docker build MkDocs \u2192 <code>public/crm-docs</code>).</li> <li>README kompletn\u011b p\u0159epracov\u00e1no pro CRM (stack, quick start, release flow, roadmap).</li> <li>Release workflow dopln\u011bn o krok validace p\u0159\u00edtomnosti changelog polo\u017eky pro tag.</li> <li>Navigace MkDocs dopln\u011bna o polo\u017eku \u201eAdminto \u0160ablona\u201c.</li> <li>Rebuild statick\u00fdch docs (viditelnost nov\u00e9 str\u00e1nky + v0.1.2 polo\u017eky).</li> </ul>"},{"location":"01-intro/changelog/#dopady_4","title":"Dopady","text":"<ul> <li>U\u017eivatel / T\u00fdm: Rychlej\u0161\u00ed onboarding \u2013 README a \u0161ablonov\u00fd p\u0159ehled poskytuj\u00ed kontext.</li> <li>Provoz: Jednozna\u010dn\u00fd postup pro rebuild dokumentace (sn\u00ed\u017een\u00ed manu\u00e1ln\u00edch chyb).</li> <li>Governance: Release proces nyn\u00ed chr\u00e1n\u00ed konzistenci verz\u00ed (chyb\u011bj\u00edc\u00ed polo\u017eka = selh\u00e1n\u00ed workflow).</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky","title":"Migrace / Kroky","text":"<ol> <li>Nen\u00ed pot\u0159eba DB migrace.</li> <li>P\u0159i dal\u0161\u00ed verzi pou\u017e\u00edvej <code>scripts/build-docs.sh</code> p\u0159ed nasazen\u00edm (zaji\u0161t\u011bn\u00ed aktu\u00e1ln\u00edho statick\u00e9ho webu).</li> <li>Zachovej form\u00e1t changelogu \u2013 validace je striktn\u00ed.</li> </ol>"},{"location":"01-intro/changelog/#odkazy_4","title":"Odkazy","text":"<ul> <li><code>.github/workflows/release.yml</code></li> <li><code>scripts/build-docs.sh</code></li> <li><code>README.md</code></li> <li><code>docs/02-architecture/adminto-template.md</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-04-v012-changed","title":"[2025-09-04] v0.1.2 (CHANGED)","text":""},{"location":"01-intro/changelog/#shrnuti_5","title":"Shrnut\u00ed","text":"<p>Zavedena automatizovan\u00e1 release pipeline, gener\u00e1tor release notes a povinn\u00e1 validace changelogu v CI.</p>"},{"location":"01-intro/changelog/#detaily_5","title":"Detaily","text":"<ul> <li>P\u0159id\u00e1n p\u0159\u00edkaz <code>php artisan release:notes</code> pro extrakci pozn\u00e1mek z changelogu.</li> <li>Workflow <code>.github/workflows/release.yml</code> publikuje GitHub Release p\u0159i tagu <code>v*.*.*</code> (SemVer).</li> <li>Dopln\u011bn krok validace: kontrola existence polo\u017eky pro dan\u00fd tag v <code>docs/01-intro/changelog.md</code> (chr\u00e1n\u00ed konzistenci historie).</li> <li>Roz\u0161\u00ed\u0159en dokument <code>git-publishing.md</code> (sekce: Automatizovan\u00e1 Release Akce + validace changelogu).</li> <li>Governance changelogu: p\u0159\u00edkaz <code>changelog:add</code> + skript <code>scripts/validate-changelog.php</code> popsan\u00fd ji\u017e d\u0159\u00edve \u2013 nyn\u00ed napojen i na release flow.</li> <li>CI (<code>.github/workflows/ci.yml</code>) nad\u00e1le hl\u00edd\u00e1 aktu\u00e1lnost dokumentace a strukturu changelogu.</li> </ul>"},{"location":"01-intro/changelog/#dopady_5","title":"Dopady","text":"<ul> <li>U\u017eivatel: Transparentn\u011bj\u0161\u00ed vyd\u00e1n\u00ed \u2013 ka\u017ed\u00e9 ozna\u010den\u00e9 verz\u00ed m\u00e1 okam\u017eit\u011b public release notes.</li> <li>Provoz / infra: Sn\u00ed\u017een\u00ed manu\u00e1ln\u00ed pr\u00e1ce p\u0159i releasu, men\u0161\u00ed riziko opomenut\u00ed krok\u016f.</li> <li>Bezpe\u010dnost / compliance: Traceability verz\u00ed + auditn\u00ed stopa zm\u011bn CI konfigurace.</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky_1","title":"Migrace / Kroky","text":"<ol> <li>Nen\u00ed pot\u0159eba DB migrace.</li> <li>P\u0159i p\u0159\u00edprav\u011b dal\u0161\u00ed verze nejprve <code>php artisan changelog:add</code>, pot\u00e9 commit &amp; tag.</li> <li>Ov\u011b\u0159it lok\u00e1ln\u011b <code>php artisan release:notes vX.Y.Z</code> p\u0159ed push tagu.</li> </ol>"},{"location":"01-intro/changelog/#odkazy_5","title":"Odkazy","text":"<ul> <li><code>.github/workflows/release.yml</code></li> <li><code>app/Console/Commands/ReleaseNotes.php</code></li> <li><code>docs/02-architecture/git-publishing.md</code></li> <li><code>scripts/validate-changelog.php</code></li> <li><code>app/Console/Commands/ChangelogAdd.php</code></li> </ul>"},{"location":"01-intro/changelog/#2025-09-04-v011-fixed","title":"[2025-09-04] v0.1.1 (FIXED)","text":""},{"location":"01-intro/changelog/#shrnuti_6","title":"Shrnut\u00ed","text":"<p>Opraven 419 (Page Expired) p\u0159i p\u0159ihl\u00e1\u0161en\u00ed \u2013 dopln\u011bna web middleware vrstva (session &amp; CSRF).</p>"},{"location":"01-intro/changelog/#detaily_6","title":"Detaily","text":"<ul> <li>P\u0159id\u00e1ny t\u0159\u00eddy <code>EncryptCookies</code>, <code>VerifyCsrfToken</code>, <code>Authenticate</code>.</li> <li>V <code>bootstrap/app.php</code> registrov\u00e1n web middleware stack.</li> <li>Alias <code>auth</code> nyn\u00ed skute\u010dn\u011b chr\u00e1n\u00ed chr\u00e1n\u011bn\u00e9 routy.</li> </ul>"},{"location":"01-intro/changelog/#dopady_6","title":"Dopady","text":"<ul> <li>Bezpe\u010dnost: Aktivn\u00ed CSRF ochrana.</li> <li>Stabilita: Korektn\u00ed udr\u017een\u00ed session a redirect po loginu.</li> </ul>"},{"location":"01-intro/changelog/#migrace-kroky_2","title":"Migrace / Kroky","text":"<ol> <li>Nasadit.</li> <li>(Voliteln\u011b) Smazat star\u00e9 cookies dom\u00e9ny <code>.opent2.com</code>.</li> <li>Retest POST /login (o\u010dek\u00e1van\u00fd 302 na <code>/crm</code>).</li> </ol>"},{"location":"01-intro/changelog/#odkazy_6","title":"Odkazy","text":"<ul> <li><code>app/Http/Middleware/*</code></li> <li><code>bootstrap/app.php</code></li> </ul>"},{"location":"01-intro/how-it-works/","title":"Jak CRM funguje (Business &amp; Technick\u00fd P\u0159ehled)","text":"<p>Tento p\u0159ehled propojuje obchodn\u00ed procesy s implementovan\u00fdmi moduly. Slou\u017e\u00ed jako vstupn\u00ed bod pro nov\u00e9 \u010dleny t\u00fdmu.</p>"},{"location":"01-intro/how-it-works/#1-zakladni-domenove-toky","title":"1. Z\u00e1kladn\u00ed Dom\u00e9nov\u00e9 Toky","text":"Tok Start Kroky (zkr\u00e1cen\u011b) Konec / Artefakt Lead \u2192 Opportunity \u2192 Deal Lead (import / formul\u00e1\u0159) Kvalifikace \u2192 konverze na Opportunity \u2192 Pipeline pohyb Deal (uzav\u0159en\u00ed Won/Lost) Company &amp; Contact Enrichment Company / Contact vytvo\u0159en\u00ed Normalizace + identita + AC sync dopln\u011bn\u00ed Aktualizovan\u00fd profil + segmentace Sales Order Lifecycle Opportunity (Won) Ru\u010dn\u00ed / automat. zalo\u017een\u00ed SalesOrder + polo\u017eky Faktura\u010dn\u00ed / reporting v\u00fdstupy Task Management Ru\u010dn\u00ed / syst\u00e9mov\u00fd trigger P\u0159i\u0159azen\u00ed (user), status zm\u011bny, dokon\u010den\u00ed Aktivita v historii + SLA metriky Knowledge Ingestion Upload / Note Chunking \u2192 Embedding \u2192 Ulo\u017een\u00ed v Qdrant Fulltext + vektorov\u00e9 vyhled\u00e1v\u00e1n\u00ed ActiveCampaign Sync Cron (job) Incremental fetch contacts \u2192 normalizace \u2192 upsert Kontakty aktu\u00e1ln\u00ed v\u016f\u010di AC Backup &amp; Verify Napl\u00e1novan\u00e9 joby Z\u00e1loha \u2192 Verify restore test \u2192 Report OpsActivity + report + alerting"},{"location":"01-intro/how-it-works/#2-moduly-a-odpovednosti","title":"2. Moduly a Odpov\u011bdnosti","text":"<ul> <li>Companies / Contacts: Centr\u00e1ln\u00ed j\u00e1dro identit. Kontakty normalizuj\u00ed email/telefon a ukl\u00e1daj\u00ed marketing status.</li> <li>Opportunities &amp; Deals: Pipeline + pravd\u011bpodobnost + d\u016fvody uzav\u0159en\u00ed (close reason) \u2192 predikce.</li> <li>Tasks &amp; Projects: Kr\u00e1tkodob\u00e9 vs. dlouhodob\u00e9 pr\u00e1ce. Task polymorfn\u00ed (taskable) nav\u00e1z\u00e1n\u00ed na Company/Contact/Project.</li> <li>Sales Orders: Monetizace \u2013 hodnoty &amp; polo\u017eky (SalesOrderItem) \u2013 z\u00e1klad pro revenue reporting.</li> <li>Knowledge Base: Dokumenty \u2192 KnowledgeDocument \u2192 KnowledgeChunk (embedding + metadata) \u2192 vyhled\u00e1v\u00e1n\u00ed.</li> <li>Ops: Z\u00e1lohy, verifikace obnovy, alerty, metriky, audit (<code>ops_activities</code>).</li> <li>Integrace (ActiveCampaign, Qdrant, Embeddings): Odd\u011blen\u00e9 konfig sekce, testy a udr\u017eiteln\u00e9 parametry.</li> </ul>"},{"location":"01-intro/how-it-works/#3-hlavni-automatizace","title":"3. Hlavn\u00ed Automatizace","text":"Automatizace Mechanika Frekvence V\u00fdsledek ActiveCampaignSyncJob Incremental contacts fetch (limit/offset) 1 min Aktualizace kontakt\u016f RunBackupJob + Verify Spatie backup + restore test denn\u011b Validovan\u00fd dump EvaluateBackupHealthJob Kontrola st\u00e1\u0159\u00ed dump\u016f/snapshot\u016f/verify 10 min Alert / Slack zpr\u00e1va Qdrant Reindex (manu\u00e1ln\u00ed) Recreate + purge ad-hoc Konsistentn\u00ed vektorov\u00fd index"},{"location":"01-intro/how-it-works/#4-datove-principy","title":"4. Datov\u00e9 Principy","text":"<ul> <li>Fillable + casts = z\u00e1klad pro heuristick\u00e9 generov\u00e1n\u00ed ERD &amp; Model Fields.</li> <li>INFORMATION_SCHEMA generuje p\u0159esn\u00e9 typy / NULL / indexy (viz DB Schema).</li> <li>Normalizace (email, phone) \u2013 minimalizuje duplicity pro segmentaci.</li> <li>Embedding dimenze konzistentn\u00ed (zm\u011bna vy\u017eaduje full reindex).</li> </ul>"},{"location":"01-intro/how-it-works/#5-navigace-ux-logika","title":"5. Navigace &amp; UX Logika","text":"<p>Viz generovan\u00e9: Navigace (gen). Struktura menu odvozen\u00e1 z rout <code>/crm/*</code>. Popisy se udr\u017euj\u00ed v <code>docs/_meta/menu.php</code> (single source). CI zaji\u0161\u0165uje, aby generovan\u00fd soubor byl aktu\u00e1ln\u00ed.</p>"},{"location":"01-intro/how-it-works/#6-alerting-observability","title":"6. Alerting &amp; Observability","text":"<ul> <li>Prometheus endpoint: <code>/crm/ops/metrics</code> (chr\u00e1n\u011bno opr\u00e1vn\u011bn\u00edm) \u2013 export metrik v\u00fdkonu a \u010derstvosti.</li> <li>Slack webhook (<code>ALERT_SLACK_WEBHOOK</code>) \u2013 odesl\u00e1n\u00ed struktur\u00e1ln\u00edch alert\u016f (STALE/FAIL/Overdue).</li> <li>Audit: <code>ops_activities</code> \u2013 datov\u00e1 z\u00e1kladna pro report a historick\u00e9 diagn\u00f3zy.</li> </ul>"},{"location":"01-intro/how-it-works/#7-rozsiritelnost","title":"7. Roz\u0161i\u0159itelnost","text":"Oblast Doporu\u010den\u00fd Pattern Nov\u00e1 entita Eloquent model + <code>$fillable</code> + migrace + doplnit doc blok (popis) Nov\u00fd modul P\u0159idat sekci v <code>docs/_meta/menu.php</code> + ADR (decision) Nov\u00e1 integrace Konfig kl\u00ed\u010de do <code>.env.example</code> + modulov\u00fd README + health test route Dal\u0161\u00ed metriky P\u0159idat gauge/counter do <code>MetricsController</code> + update ops.md Extra ACL Spatie permission seeding + permissions (gen) refresh"},{"location":"01-intro/how-it-works/#8-quality-gates-dokumentace","title":"8. Quality Gates Dokumentace","text":"<ul> <li><code>php artisan docs:refresh</code> spustit lok\u00e1ln\u011b p\u0159ed PR.</li> <li>CI job failne, pokud <code>docs/16-generated</code> diff \u2260 \u010dist\u00e9.</li> <li>Minim\u00e1ln\u00ed pokryt\u00ed popis\u016f menu: doporu\u010deno &gt;90% (sledovat po\u010det \"(popis chyb\u00ed)\").</li> </ul>"},{"location":"01-intro/how-it-works/#9-budouci-vylepseni","title":"9. Budouc\u00ed Vylep\u0161en\u00ed","text":"<ul> <li>Automatick\u00fd screenshot vybran\u00fdch UI (vizu\u00e1ln\u00ed regresn\u00ed p\u0159\u00edloha dokumentace).</li> <li>Generace sekce Analytics (konverzn\u00ed pom\u011bry) \u2192 pipeline v\u00fdpo\u010det cronem.</li> <li>Mermaid sekce stavov\u00e9ho stroje Opportunity (f\u00e1ze / p\u0159echody).</li> </ul> <p>Aktualizujte p\u0159i zm\u011bn\u011b obchodn\u00ed logiky, nov\u00fdch modulech nebo zm\u011bn\u011b datov\u00fdch pravidel.</p>"},{"location":"02-architecture/adminto-template/","title":"Adminto \u0160ablona (Laravel v2.0) \u2013 Integrace","text":"<p>Tento projekt vyu\u017e\u00edv\u00e1 placenou \u0161ablonu Adminto (Laravel 11, Bootstrap 5.3.3) jako z\u00e1klad UI. Zde je praktick\u00fd p\u0159ehled co z n\u00ed m\u00e1me, kde hledat zdrojov\u00e9 \u010d\u00e1sti a jak spr\u00e1vn\u011b dopl\u0148ovat nov\u00e9 UI prvky.</p>"},{"location":"02-architecture/adminto-template/#struktura-zdroju-sablony","title":"Struktura zdroj\u016f \u0161ablony","text":"<p>Um\u00edst\u011bn\u00ed origin\u00e1ln\u00edch soubor\u016f (nemodifikovat, slou\u017e\u00ed jako referen\u010dn\u00ed zdroj):</p> <pre><code>/srv/projects/crm/template/Adminto-Laravel_v2.0/Adminto            # p\u016fvodn\u00ed k\u00f3d\n/srv/projects/crm/template/Adminto-Laravel_v2.0/Documentation      # vendor dokumentace (HTML)\n</code></pre> <p>Adaptovan\u00e9 \u010d\u00e1sti byly p\u0159ekop\u00edrov\u00e1ny a upraveny v na\u0161em app repozit\u00e1\u0159i (<code>resources/</code>, <code>public/</code>, SCSS/JS p\u0159es Vite). P\u016fvodn\u00ed Gulp flow jsme NEP\u0158EVZALI \u2013 build \u0159e\u0161\u00ed Vite.</p>"},{"location":"02-architecture/adminto-template/#hlavni-oblast-prevzeti","title":"Hlavn\u00ed oblast p\u0159evzet\u00ed","text":"Oblast Stav integrace Pozn\u00e1mka Layout (sidebar, topbar) P\u0159evzato + custom \u00fapravy Soubor <code>resources/views/layouts/partials/sidebar.blade.php</code> obsahuje sekce CRM + zbytek demo menu. Ikony (Remix, Tabler, Solar) P\u0159ipraveno V menu sekce Icons \u2013 lze pou\u017e\u00edt pro rychlou UI symboliku. Komponenty UI (Base/Extended) Z\u00e1klad ponech\u00e1n Demo routy zat\u00edm p\u0159ev\u00e1\u017en\u011b placeholdery. Form komponenty &amp; validace K dispozici Vyu\u017e\u00edt dle pot\u0159eby \u2013 sladit s laravel form request validac\u00ed. Tabulky &amp; Datatables K dispozici Pozor na duplicitn\u00ed JS inicializace \u2013 preferuj centralizovan\u00fd modul. Grafy (Apexcharts, Flot, Chart.js, atd.) Neaktivn\u00ed v dom\u00e9nov\u00e9 logice Aktivuj pouze pot\u0159ebn\u00e9 knihovny (tree\u2011shake / lazy load). Mapy (Google, Vector, Leaflet) Leaflet integrace u\u017e v z\u00e1vislostech Ostatn\u00ed jen pokud p\u0159id\u00e1me funkci. V\u00edce\u00farov\u0148ov\u00e9 menu Ponech\u00e1no (demo) Zva\u017e redukci pro sn\u00ed\u017een\u00ed kognitivn\u00edho \u0161umu."},{"location":"02-architecture/adminto-template/#doporuceny-postup-pri-pridavani-novych-obrazovek","title":"Doporu\u010den\u00fd postup p\u0159i p\u0159id\u00e1v\u00e1n\u00ed nov\u00fdch obrazovek","text":"<ol> <li>Navrhni dom\u00e9novou URL a route name (prefix <code>crm.</code> nebo <code>marketing.</code> nebo modul).  </li> <li>Roz\u0161i\u0159 <code>sidebar.blade.php</code> \u2013 minimalizuj vno\u0159en\u00ed (max 2 \u00farovn\u011b).  </li> <li>Vytvo\u0159 Blade view v odpov\u00eddaj\u00edc\u00ed slo\u017ece (<code>resources/views/\u2026</code>).  </li> <li>Pokud pot\u0159ebuje\u0161 JS plugin:  </li> <li>Zkontroluj v dokumentaci Adminto (tabulka plugin\u016f \u2013 n\u00ed\u017ee).  </li> <li>Pokud u\u017e m\u00e1me modern\u00ed ekvivalent (nap\u0159. nativn\u00ed Date picker / Flatpickr), preferuj existuj\u00edc\u00ed knihovnu.  </li> <li>Stylov\u00e1n\u00ed: P\u0159idej SCSS prom\u011bnn\u00e9 do <code>resources/scss/_theme-default.scss</code> (nenahrazuj vendor CSS ru\u010dn\u011b).  </li> <li>Aktualizuj generovanou navigaci (<code>php artisan docs:refresh</code>) a p\u0159\u00edpadn\u011b popisy v <code>docs/_meta/menu.php</code>.  </li> <li>P\u0159idej z\u00e1znam do changelogu (TYPE <code>ADDED</code> / <code>CHANGED</code>).</li> </ol>"},{"location":"02-architecture/adminto-template/#prizpusobeni-customization-jadro","title":"P\u0159izp\u016fsoben\u00ed (Customization) \u2013 j\u00e1dro","text":"<p>Z dokumentace (soubor <code>customization.html</code>):</p> <p>\u00daprava palety barev prob\u00edh\u00e1 zm\u011bnou SCSS prom\u011bnn\u00fdch v <code>_theme-default.scss</code> (u n\u00e1s: <code>resources/scss/</code>). Po \u00faprav\u011b spustit build Vite (<code>npm run dev</code> nebo <code>vite build</code>).</p> <p>Dal\u0161\u00ed layout varianty (top navigation, horizontal) lze aktivovat \u00fapravou atributu <code>data-layout</code> na <code>&lt;html&gt;</code> + odebr\u00e1n\u00edm include sidebaru a p\u0159id\u00e1n\u00edm horizont\u00e1ln\u00ed navigace (viz origin\u00e1ln\u00ed kroky). Aktu\u00e1ln\u011b z\u016fst\u00e1v\u00e1me u vertik\u00e1ln\u00edho layoutu.</p>"},{"location":"02-architecture/adminto-template/#pluginy-mapping-potrebnych-assetu","title":"Pluginy \u2013 mapping pot\u0159ebn\u00fdch asset\u016f","text":"<p>Z origin\u00e1ln\u00ed tabulky (zkr\u00e1cen\u00fd v\u00fdb\u011br b\u011b\u017en\u011b relevantn\u00edch):</p> Funkce CSS JS Custom Init Datatables dataTables.bootstrap4.min.css \u2026 jquery.dataTables.min.js \u2026 datatables.init.js Dropzone Upload dropzone.min.css dropzone.min.js \u2013 Summernote WYSIWYG summernote-bs4.css summernote-bs4.min.js form-summernote.init.js Quill Editor quill.*.css quill.min.js (+ katex.min.js) form-quilljs.init.js Range Slider ion.rangeSlider.css ion.rangeSlider.min.js range-sliders.init.js ApexCharts \u2013 apexcharts.min.js apexcharts.init.js SweetAlert2 sweetalert2.min.css sweetalert2.min.js sweet-alerts.init.js Select2 select2.min.css select2.min.js form-advanced.init.js Parsley (form validation) \u2013 parsley.min.js form-validation.init.js Daterangepicker daterangepicker.css daterangepicker.js + moment.js form-pickers.init.js Dropzone dropzone.min.css dropzone.min.js \u2013 Leaflet Maps (extern\u00ed) leaflet.js (vlastn\u00ed inicializace) <p>Pozn\u00e1mky: * Nep\u0159eb\u00edrej v\u0161echny pluginy do glob\u00e1ln\u00ed bundle \u2013 pouze importy na str\u00e1nk\u00e1ch, kde jsou pot\u0159eba (Vite dynamic import). * Up\u0159ednost\u0148uj modern\u00ed alternativy (nap\u0159. nativn\u00ed Date picker vs. bootstrap-datepicker) pro redukci velikosti.</p>"},{"location":"02-architecture/adminto-template/#performance-bundling-guidelines","title":"Performance &amp; Bundling Guidelines","text":"<ul> <li>Ka\u017ed\u00fd v\u011bt\u0161\u00ed plugin lazy\u2011load (dynamic <code>import()</code> v komponent\u011b).</li> <li>Sd\u00edlen\u00e9 utility (SweetAlert wrapper, AJAX helper) centralizuj do <code>resources/js/lib/</code>.</li> <li>Sleduj velikost produk\u010dn\u00edho bundlu (<code>vite build --report</code> \u2013 p\u0159\u00edpadn\u011b doplnit plugin pozd\u011bji).</li> </ul>"},{"location":"02-architecture/adminto-template/#bezpecnost-udrzba","title":"Bezpe\u010dnost &amp; \u00dadr\u017eba","text":"<ul> <li>Sleduj upstream verze \u0161ablony (soubor <code>Documentation/changelog.html</code>).</li> <li>P\u0159i aktualizaci: diff proti na\u0161im p\u0159epsan\u00fdm Blade view \u2013 za\u010dni jen layouty a partialy.</li> <li>Zm\u011bny UI knihoven v\u017edy s changelog polo\u017ekou (<code>CHANGED</code> nebo <code>SECURITY</code> pokud oprava CVE pluginu).</li> </ul>"},{"location":"02-architecture/adminto-template/#redukce-demo-balastu-doporuceno","title":"Redukce Demo Balastu (Doporu\u010deno)","text":"<p>Kr\u00e1tkodob\u00e9 kandid\u00e1ty k odstran\u011bn\u00ed / skryt\u00ed: - Multi Level menu (ponechat jen pokud re\u00e1ln\u00e1 pot\u0159eba). - Nadbyte\u010dn\u00e9 grafy (ponechat 1 knihovnu \u2013 preferen\u010dn\u011b ApexCharts). - Duplicitn\u00ed form pickery (sjednotit na jednu knihovnu + Quill jako default editor).</p>"},{"location":"02-architecture/adminto-template/#roadmap-integrace","title":"Roadmap Integrace","text":"Milestone C\u00edl Stav M1 Inventarizace pou\u017eit\u00fdch plugin\u016f vs. dostupn\u00fdch Prob\u011bhlo \u010d\u00e1ste\u010dn\u011b (tento dokument) M2 Odstranit nevyu\u017eit\u00e9 demosekce z menu TODO M3 Zavedeno lazy-loading pro t\u011b\u017ek\u00e9 moduly (charts, editors) TODO M4 Standardizovan\u00fd UI kit (komponenty jako Laravel Blade partials) TODO M5 Dokumentovan\u00fd upgrade proces na novou verzi \u0161ablony TODO <p>Posledn\u00ed \u00faprava: {{ date('Y-m-d') }}</p>"},{"location":"02-architecture/git-publishing/","title":"Publikace na GitHub &amp; Release Workflow","text":"<p>Tato sekce definuje standard pro nahr\u00e1n\u00ed a \u00fadr\u017ebu repozit\u00e1\u0159e na GitHubu.</p>"},{"location":"02-architecture/git-publishing/#1-cile","title":"1. C\u00edle","text":"<ul> <li>Reprodukovateln\u00e9 buildy</li> <li>Auditovateln\u00e1 historie (changelog, ADR)</li> <li>Ochrana tajemstv\u00ed (\u017e\u00e1dn\u00e9 kl\u00ed\u010de v git historii)</li> <li>Automatick\u00e1 validace (CI gates)</li> </ul>"},{"location":"02-architecture/git-publishing/#2-priprava-pred-prvnim-push","title":"2. P\u0159\u00edprava p\u0159ed prvn\u00edm push","text":"<p>Kontroln\u00ed seznam: 1. <code>.gitignore</code> pokr\u00fdv\u00e1 <code>vendor/</code>, <code>node_modules/</code>, runtime a <code>.env</code> (hotovo \u2013 viz root). 2. <code>APP_KEY</code> nen\u00ed commitnut (jen v CI se generuje). 3. \u017d\u00e1dn\u00e9 tajn\u00e9 tokeny ve zdroj\u00edch: grep <code>OPENROUTER_API_KEY</code>, <code>API_KEY</code>, <code>PASSWORD</code> \u2013 pouze placeholdery. 4. <code>docs/01-intro/changelog.md</code> m\u00e1 prvn\u00ed verzi vX.Y.Z. 5. CI workflow <code>.github/workflows/ci.yml</code> existuje (testy, docs, changelog validace). 6. <code>LICENSE</code> (TODO pokud m\u00e1 b\u00fdt ve\u0159ejn\u00e9). 7. <code>README.md</code> (TODO \u2013 stru\u010dn\u00fd p\u0159ehled a odkaz na docs).</p>"},{"location":"02-architecture/git-publishing/#3-inicializace-repozitare","title":"3. Inicializace repozit\u00e1\u0159e","text":"<pre><code>git init\ngit add .\ngit commit -m \"chore: initial commit\"\ngit branch -M main\ngit remote add origin git@github.com:ORG/REPO.git\ngit push -u origin main\n</code></pre>"},{"location":"02-architecture/git-publishing/#4-verzovani","title":"4. Verzov\u00e1n\u00ed","text":"<p>Strategie: SemVer (MAJOR.MINOR.PATCH). - PATCH: opravy bez dopadu na API / sch\u00e9ma - MINOR: nov\u00e9 funkce kompatibiln\u00ed - MAJOR: nekompatibiln\u00ed zm\u011bny / migra\u010dn\u00ed kroky</p> <p>Tagging release: <pre><code>VERSION=v0.1.1\ngit tag -a $VERSION -m \"Release $VERSION\"\ngit push origin $VERSION\n</code></pre></p>"},{"location":"02-architecture/git-publishing/#5-changelog-flow","title":"5. Changelog Flow","text":"<ol> <li>Ka\u017ed\u00fd PR mus\u00ed obsahovat p\u0159\u00edkaz (lok\u00e1ln\u011b) <code>php artisan changelog:add TYPE \"Shrnut\u00ed\" ...</code></li> <li>CI validuje form\u00e1t.</li> <li>P\u0159i tagov\u00e1n\u00ed se NEedituje minul\u00e1 historie.</li> </ol>"},{"location":"02-architecture/git-publishing/#6-release-checklist","title":"6. Release Checklist","text":"Krok Popis Stav Testy <code>phpunit</code> zelen\u00e9 Changelog Nov\u00e1 polo\u017eka p\u0159\u00edtomna Dokumentace <code>composer docs</code> bez diffu Migrace Nov\u00e9 migrace otestov\u00e1ny na staging Bezpe\u010dnost \u017d\u00e1dn\u00e9 tajemstv\u00ed v diffu Build assets <code>npm run build</code> lok\u00e1ln\u011b ov\u011b\u0159eno Z\u00e1loha DB Spu\u0161t\u011bn manu\u00e1ln\u00ed backup p\u0159ed deploymentem"},{"location":"02-architecture/git-publishing/#7-ochrana-tajemstvi","title":"7. Ochrana tajemstv\u00ed","text":"<ul> <li>V\u0161echny runtime kl\u00ed\u010de pouze v <code>.env</code> / secret store (GitHub Actions secrets).</li> <li>P\u0159idat pozd\u011bji: skript <code>scripts/scan-secrets.sh</code> (TODO) + CI krok.</li> </ul>"},{"location":"02-architecture/git-publishing/#8-github-actions-dalsi-doporuceni","title":"8. GitHub Actions \u2013 dal\u0161\u00ed doporu\u010den\u00ed","text":"<p>Mo\u017en\u00e9 budouc\u00ed kroky: - Cache <code>node_modules</code> + build artefakt\u016f - Coverage report + badge - Security scan (Trivy) pro Docker image</p>"},{"location":"02-architecture/git-publishing/#9-rollback-strategie","title":"9. Rollback Strategie","text":"<ul> <li>Minor release lze revertovat <code>git revert</code> merge commit.</li> <li>P\u0159ed MAJOR: export DB sch\u00e9matu + z\u00e1loha.</li> <li>Dokumentovat breaking changes v samostatn\u00e9 sekci changelogu.</li> </ul>"},{"location":"02-architecture/git-publishing/#10-todo-dalsi-rozsireni","title":"10. TODO / Dal\u0161\u00ed roz\u0161\u00ed\u0159en\u00ed","text":"<ul> <li>[ ] README doplnit</li> <li>[ ] LICENSE vybrat (MIT / proprietary)</li> <li>[ ] Secrets scanning (Gitleaks)</li> <li>[ ] Automatick\u00e9 generov\u00e1n\u00ed release notes z changelogu</li> </ul> <p>Aktualizace t\u00e9to str\u00e1nky mus\u00ed prob\u011bhnout p\u0159i zm\u011bn\u011b release procesu nebo bezpe\u010dnostn\u00edch z\u00e1sad.</p>"},{"location":"02-architecture/git-publishing/#11-krok-za-krokem-prvni-privatni-github-nasazeni","title":"11. Krok za krokem: Prvn\u00ed priv\u00e1tn\u00ed GitHub nasazen\u00ed","text":"<p>Pokud nem\u016f\u017ee asistovat automatizace, postupuj ru\u010dn\u011b podle t\u011bchto p\u0159esn\u00fdch krok\u016f.</p>"},{"location":"02-architecture/git-publishing/#predpoklady","title":"P\u0159edpoklady","text":"<ul> <li>Na serveru je projekt (u\u017e inicializovan\u00fd <code>git init</code> a prvn\u00ed commit \u2013 hotovo).</li> <li>M\u00e1\u0161 GitHub \u00fa\u010det a pr\u00e1vo vytv\u00e1\u0159et repozit\u00e1\u0159e v organizaci / pod sv\u00fdm \u00fa\u010dtem.</li> </ul>"},{"location":"02-architecture/git-publishing/#varianta-a-push-z-lokalni-stanice-doporuceno","title":"Varianta A: Push z lok\u00e1ln\u00ed stanice (doporu\u010deno)","text":"<ol> <li>St\u00e1hni si projekt ze serveru (nebo vyv\u00edjej lok\u00e1ln\u011b) \u2013 ov\u011b\u0159 \u017ee slo\u017eka obsahuje <code>.git</code>.</li> <li>Na GitHubu vytvo\u0159 repozit\u00e1\u0159:<ul> <li>Web UI: <code>+</code> (vpravo naho\u0159e) \u2192 <code>New repository</code>.</li> <li><code>Repository name</code>: nap\u0159. <code>crm-esl</code>.</li> <li>Visibility: <code>Private</code>.</li> <li>Neza\u0161krt\u00e1vej auto\u2010inicializa\u010dn\u00ed README / .gitignore (u\u017e je v projektu).</li> <li>Vytvo\u0159.</li> </ul> </li> <li>P\u0159idej remote a push:     <pre><code>git remote add origin git@github.com:ORG_OR_USER/crm-esl.git\ngit push -u origin main\n</code></pre></li> <li>Ov\u011b\u0159 v UI, \u017ee soubory jsou online.</li> </ol>"},{"location":"02-architecture/git-publishing/#varianta-b-push-primo-ze-serveru-deploy-key","title":"Varianta B: Push p\u0159\u00edmo ze serveru (deploy key)","text":"<ol> <li>Na serveru vygeneruj dedikovan\u00fd kl\u00ed\u010d:     <pre><code>ssh-keygen -t ed25519 -C \"crm-esl-deploy\" -f ~/.ssh/id_crm_esl\n</code></pre></li> <li>P\u0159idej do <code>~/.ssh/config</code>:     <pre><code>Host github-crm\n  HostName github.com\n  User git\n  IdentityFile ~/.ssh/id_crm_esl\n  IdentitiesOnly yes\n</code></pre></li> <li>Zobraz public kl\u00ed\u010d a zkop\u00edruj:     <pre><code>cat ~/.ssh/id_crm_esl.pub\n</code></pre></li> <li>GitHub repo \u2192 Settings \u2192 Deploy keys \u2192 Add deploy key (n\u00e1zev nap\u0159. <code>server-initial</code>) \u2014 povol Write access (jen pokud ze serveru bude\u0161 pushovat).</li> <li>P\u0159idej remote a push:     <pre><code>git remote add origin git@github-crm:ORG_OR_USER/crm-esl.git\ngit push -u origin main\n</code></pre></li> </ol>"},{"location":"02-architecture/git-publishing/#alternativa-https-s-pat","title":"(Alternativa) HTTPS s PAT","text":"<p>Pou\u017eij jen pokud SSH nen\u00ed mo\u017en\u00e9: <pre><code>git remote add origin https://github.com/ORG_OR_USER/crm-esl.git\ngit push -u origin main\n</code></pre> P\u0159i promptu zadej Personal Access Token (PAT) m\u00edsto hesla (doporu\u010d rozsah <code>repo</code> + expiration). </p>"},{"location":"02-architecture/git-publishing/#po-prvnim-push-zakladni-hardening","title":"Po prvn\u00edm push \u2013 z\u00e1kladn\u00ed hardening","text":"<ol> <li>Repo \u2192 Settings \u2192 General \u2192 \"Allow forking\" vypnout (pokud nechce\u0161 forky).</li> <li>Repo \u2192 Settings \u2192 Branches \u2192 Add rule <code>main</code>:<ul> <li>Require pull request before merging.</li> <li>Require status checks (pozd\u011bji a\u017e testy b\u011b\u017e\u00ed).</li> </ul> </li> <li>Repo \u2192 Settings \u2192 Actions \u2192 General \u2192 Povolit Actions pro priv\u00e1tn\u00ed.</li> <li>Repo \u2192 Settings \u2192 Secrets and variables \u2192 Actions \u2192 Add secrets (nap\u0159. <code>PROD_SSH_HOST</code>, <code>PROD_SSH_USER</code>, atd. \u2013 dle budouc\u00edho CD).</li> </ol>"},{"location":"02-architecture/git-publishing/#tagovani-prvni-verze","title":"Tagov\u00e1n\u00ed prvn\u00ed verze","text":"<p><pre><code>git tag -a v0.1.1 -m \"Initial private release\"\ngit push origin v0.1.1\n</code></pre> Na GitHubu \u2192 Releases \u2192 Draft new release \u2192 vyber tag <code>v0.1.1</code>.  Changelog posledn\u00ed polo\u017eku z\u00edsk\u00e1\u0161: <pre><code>awk '/^### \\[/ {if (c++) exit} {print}' docs/01-intro/changelog.md\n</code></pre> V\u00fdstup vlo\u017e do release notes (m\u016f\u017ee\u0161 odstranit intern\u00ed sekce pokud chce\u0161 krat\u0161\u00ed text pro ve\u0159ejn\u00e9 u\u017eivatele).</p>"},{"location":"02-architecture/git-publishing/#pridani-nove-zmeny-do-changelogu-pred-dalsi-verzi","title":"P\u0159id\u00e1n\u00ed nov\u00e9 zm\u011bny do changelogu p\u0159ed dal\u0161\u00ed verz\u00ed","text":"<pre><code>php artisan changelog:add ADDED \"Nov\u00fd modul X\" --details=\"Backend + UI\" --impact=\"U\u017eivatel: nov\u00e9 funkce; Provoz: \u017e\u00e1dn\u00fd\"\ngit add docs/01-intro/changelog.md\ngit commit -m \"docs: changelog pro modul X\"\n</code></pre>"},{"location":"02-architecture/git-publishing/#rychla-kontrola-ze-nic-citliveho-neuniklo","title":"Rychl\u00e1 kontrola \u017ee nic citliv\u00e9ho neuniklo","text":"<p><pre><code>grep -R \"API_KEY\" -n . | head\ngrep -R \"SECRET\" -n . | head\ngrep -R \"PASSWORD\" -n . | head\n</code></pre> Pokud najde\u0161 re\u00e1ln\u00e9 hodnoty (ne placeholdery), odeber a p\u0159idej do <code>.env</code>.</p>"},{"location":"02-architecture/git-publishing/#minimalni-rollback-pokud-neco-rozbijes-v-main","title":"Minim\u00e1ln\u00ed rollback (pokud n\u011bco rozbije\u0161 v main)","text":"<p><pre><code>git revert &lt;SHA-problematic-commit&gt;\ngit push origin main\n</code></pre> Pokud \u0161lo o release tag, vytvo\u0159 n\u00e1sledn\u011b novou PATCH verzi s opravou (nap\u0159. v0.1.2).</p>"},{"location":"02-architecture/git-publishing/#nejcastejsi-chyby-reseni","title":"Nej\u010dast\u011bj\u0161\u00ed chyby &amp; \u0159e\u0161en\u00ed","text":"Probl\u00e9m P\u0159\u00ed\u010dina Oprava Permission denied (publickey) \u0160patn\u00fd kl\u00ed\u010d nebo nen\u00ed na GitHubu Zkontroluj <code>ssh -T git@github.com</code> PAT authentication failed \u0160patn\u00fd scope nebo expirovan\u00fd token Vytvo\u0159 nov\u00fd PAT se scope <code>repo</code> CI nevid\u00ed <code>.env</code> Chyb\u00ed <code>.env.example</code> P\u0159\u00edtomno \u2013 doplnit nov\u00e9 kl\u00ed\u010de dle pot\u0159eby Changelog gate sel\u017ee Nespr\u00e1vn\u00fd TYPE / po\u0159ad\u00ed Spus\u0165 validator lok\u00e1ln\u011b <code>php scripts/validate-changelog.php</code>"},{"location":"02-architecture/git-publishing/#co-necommitovat-nikdy","title":"Co NEcommitovat nikdy","text":"<ul> <li>Skute\u010dn\u00e9 API kl\u00ed\u010de, hesla, priv\u00e1tn\u00ed SSH kl\u00ed\u010de.</li> <li>Dumpy datab\u00e1z\u00ed (pou\u017eij artefakt / priv storage).</li> <li>Velk\u00e9 bin\u00e1rky (&gt;100MB) \u2013 pou\u017eij Git LFS nebo extern\u00ed storage.</li> </ul> <p>Tento n\u00e1vod roz\u0161\u00ed\u0159il p\u016fvodn\u00ed sekce \u2013 p\u0159i zm\u011bn\u011b procesu aktualizuj soub\u011b\u017en\u011b Release Checklist.</p>"},{"location":"02-architecture/git-publishing/#12-automatizovane-release-notes","title":"12. Automatizovan\u00e9 Release Notes","text":"<p>Pro generov\u00e1n\u00ed textu pro GitHub Release pou\u017eij artisan p\u0159\u00edkaz:</p> <p>Z\u00edskat nejnov\u011bj\u0161\u00ed z\u00e1znam (v\u010detn\u011b nadpisu): <pre><code>php artisan release:notes\n</code></pre></p> <p>Jen obsah bez nadpisu (vhodn\u00e9 pro GitHub Release body): <pre><code>php artisan release:notes --no-heading\n</code></pre></p> <p>Konkr\u00e9tn\u00ed verze: <pre><code>php artisan release:notes v0.1.1\n</code></pre></p> <p>Ulo\u017eit do souboru (CI pipeline artefakt): <pre><code>php artisan release:notes v0.1.1 --output=release_notes.md\n</code></pre></p>"},{"location":"02-architecture/git-publishing/#integrace-do-ci-priklad-tag-workflow-vystupu","title":"Integrace do CI (p\u0159\u00edklad tag workflow v\u00fdstupu)","text":"<p>P\u0159idej job, kter\u00fd p\u0159i push tagu vygeneruje pozn\u00e1mky: <pre><code>    release-notes:\n        if: startsWith(github.ref, 'refs/tags/')\n        runs-on: ubuntu-latest\n        steps:\n            - uses: actions/checkout@v4\n            - uses: shivammathur/setup-php@v2\n                with:\n                    php-version: '8.3'\n            - run: composer install --no-interaction --prefer-dist --no-scripts\n            - name: Generate notes\n                run: php artisan release:notes ${GITHUB_REF#refs/tags/} --no-heading --output=release_notes.md\n            - name: Show notes\n                run: cat release_notes.md\n</code></pre></p> <p>GitHub Release lze n\u00e1sledn\u011b vytvo\u0159it ru\u010dn\u011b a vlo\u017eit generovan\u00fd obsah, nebo doplnit akci typu <code>softprops/action-gh-release</code> a p\u0159edat <code>body_path: release_notes.md</code>.</p>"},{"location":"02-architecture/git-publishing/#automatizovana-release-akce","title":"Automatizovan\u00e1 Release Akce","text":"<p>V repozit\u00e1\u0159i je workflow <code>.github/workflows/release.yml</code>, kter\u00e9 p\u0159i push tagu <code>v*.*.*</code>: 1. Spust\u00ed instalaci z\u00e1vislost\u00ed. 2. Vygeneruje release notes z changelogu (<code>release:notes</code>). 3. Vytvo\u0159\u00ed GitHub Release s t\u011bmito pozn\u00e1mkami.</p> <p>Nav\u00edc krok \"Validate changelog entry\" ov\u011b\u0159\u00ed, \u017ee v <code>docs/01-intro/changelog.md</code> existuje nadpis pro dan\u00fd tag \u2013 pokud ne, workflow sel\u017ee (chr\u00e1n\u00ed p\u0159ed zapomenut\u00fdm z\u00e1znamem).</p>"},{"location":"02-architecture/git-publishing/#rucni-rebuild-staticke-dokumentace","title":"Ru\u010dn\u00ed rebuild statick\u00e9 dokumentace","text":"<p>Markdown zm\u011bny (nap\u0159. nov\u00fd changelog) se projev\u00ed na webu a\u017e po p\u0159ebuild\u011bn\u00ed MkDocs do <code>public/crm-docs</code>.</p> <p>Pou\u017eij skript:</p> <pre><code>scripts/build-docs.sh\n</code></pre> <p>Co d\u011bl\u00e1: 1. Spust\u00ed <code>php artisan docs:refresh</code> (vygeneruje referen\u010dn\u00ed sekce). 2. Spust\u00ed kontejner <code>squidfunk/mkdocs-material</code> a buildne statick\u00fd web.</p> <p>V\u00fdstup: <code>public/crm-docs/index.html</code> + ostatn\u00ed.</p> <p>Po buildu ov\u011b\u0159: <pre><code>grep -q \"vX.Y.Z\" public/crm-docs/01-intro/changelog/index.html &amp;&amp; echo OK\n</code></pre></p> <p>Pokud nasazen\u00ed b\u011b\u017e\u00ed v Dockeru, sta\u010d\u00ed rebuild uvnit\u0159 aplika\u010dn\u00edho kontejneru a Nginx okam\u017eit\u011b serv\u00edruje nov\u00e9 soubory.</p> <p>Postup pro nov\u00fd release: <pre><code>php artisan changelog:add ADDED \"Nov\u00e1 funkce Y\" --details=\"...\" --impact=\"...\"\ngit add docs/01-intro/changelog.md\ngit commit -m \"docs: changelog pro Y\"\nVERSION=v0.1.2\ngit tag -a $VERSION -m \"Release $VERSION\"\ngit push origin main $VERSION\n</code></pre> Workflow automaticky zalo\u017e\u00ed Release. Ov\u011b\u0159 na GitHubu v sekci Releases.</p>"},{"location":"02-architecture/infrastructure/","title":"Infrastruktura &amp; Prost\u0159ed\u00ed","text":""},{"location":"02-architecture/infrastructure/#domena-url","title":"Dom\u00e9na / URL","text":"<ul> <li>Prim\u00e1rn\u00ed dom\u00e9na (aktu\u00e1ln\u00ed instance): <code>https://ce1.opent2.com</code></li> <li>Dokumentace staticky serv\u00edrovan\u00e1 na: <code>https://ce1.opent2.com/crm-docs/</code></li> <li>Reverzn\u00ed proxy / router: Traefik (extern\u00ed s\u00ed\u0165 <code>web</code>).</li> </ul>"},{"location":"02-architecture/infrastructure/#vps-host","title":"VPS / Host","text":"<ul> <li>Linux VPS (typ: standard x86_64) \u2013 parametry CPU/RAM nejsou v repozit\u00e1\u0159i; doplnit do ADR pokud budou SLA.</li> <li>Perzistence dat: host adres\u00e1\u0159e pod <code>/srv/volumes/crm/*</code> a <code>/srv/backups/crm/*</code>.</li> </ul>"},{"location":"02-architecture/infrastructure/#docker-sluzby-docker-compose","title":"Docker Slu\u017eby (docker-compose)","text":"Service Image \u00da\u010del Persistentn\u00ed volume db mysql:8.0 Prim\u00e1rn\u00ed MySQL datab\u00e1ze <code>/srv/volumes/crm/mysql-data</code> redis redis:alpine Cache / queue backend <code>/srv/volumes/crm/redis-data</code> qdrant qdrant/qdrant:latest Vector store (knowledge) <code>/srv/volumes/crm/qdrant-data</code> app crmeslcz-crm-app (Dockerfile.app) PHP-FPM / Laravel aplikace bind <code>/srv/volumes/crm/src</code> scheduler crmeslcz-crm-scheduler Laravel schedule worker bind source + logs queue crmeslcz-crm-queue Queue worker (jobs) bind source + logs embedder crmeslcz-embedder Embedding service (extern\u00ed API vol\u00e1n\u00ed) n/a playwright crmeslcz-playwright-runner E2E / scraping / test automace n/a web nginx:1.27-alpine HTTP server + statick\u00e9 docs bind source + logs mailhog mailhog/mailhog Lok\u00e1ln\u00ed SMTP testing ephemeral"},{"location":"02-architecture/infrastructure/#sitova-topologie","title":"S\u00ed\u0165ov\u00e1 Topologie","text":"<ul> <li>Intern\u00ed s\u00ed\u0165: <code>crm-internal</code> (app, db, redis, qdrant, workers, embedder, playwright, mailhog)</li> <li>Extern\u00ed: <code>web</code> (Traefik + web container)</li> <li>Traefik sm\u011bruje host <code>ce1.opent2.com</code> na service <code>web</code> port 80.</li> </ul>"},{"location":"02-architecture/infrastructure/#healthchecks","title":"Healthchecks","text":"Service Test Interval Retry db <code>mysqladmin ping</code> 30s 5 redis <code>redis-cli ping</code> 30s 5 qdrant HTTP GET <code>/collections</code> 30s 5 app <code>php -v</code> 30s 5 web HTTP GET <code>/healthz</code> 20s 5"},{"location":"02-architecture/infrastructure/#logy-soubory","title":"Logy &amp; Soubory","text":"Path Popis <code>/srv/volumes/crm/src</code> Aplika\u010dn\u00ed zdrojov\u00fd k\u00f3d (bind) <code>/srv/volumes/crm/logs/php</code> PHP-FPM / app logy <code>/srv/volumes/crm/logs/nginx</code> Nginx access/error <code>/srv/volumes/crm/mysql-data</code> Datov\u00e9 soubory MySQL <code>/srv/volumes/crm/redis-data</code> Redis persistence <code>/srv/volumes/crm/qdrant-data</code> Qdrant storage <code>/srv/backups/crm</code> Z\u00e1lohy + verify + reporty <code>/srv/backups/crm/reports</code> Markdown reporty generovan\u00e9 jobem"},{"location":"02-architecture/infrastructure/#zalohy-verify","title":"Z\u00e1lohy &amp; Verify","text":"<ul> <li>Spou\u0161t\u011bn\u00e9 joby: <code>RunBackupJob</code>, <code>RunVerifyRestoreJob</code>, <code>GenerateBackupReportJob</code>, <code>EvaluateBackupHealthJob</code>.</li> <li>Reporty sumarizov\u00e1ny v <code>backup-report-latest.md</code> (generov\u00e1no).</li> <li>Verifikace: import dumpu do temp DB + sanity checks.</li> </ul>"},{"location":"02-architecture/infrastructure/#build-deploy","title":"Build &amp; Deploy","text":"Oblast Mechanismus Dok. generace <code>php artisan docs:refresh</code> + MkDocs (Material) -&gt; <code>public/crm-docs</code> CI GitHub Actions <code>ci.yml</code> (tests, lint, docs diff) Frontend assets Vite (viz <code>npm run dev</code> v <code>composer dev</code> skriptu)"},{"location":"02-architecture/infrastructure/#bezpecnost-konfigurace","title":"Bezpe\u010dnost / Konfigurace","text":"<ul> <li><code>.env</code> hodnoty (viz <code>.env.example</code>): DB, Redis, RESTIC, ActiveCampaign, OPS_* prahy.</li> <li>Slack alerting: <code>ALERT_SLACK_WEBHOOK</code> (pokud nen\u00ed nastaveno, tich\u00fd re\u017eim alert\u016f).</li> <li>Opr\u00e1vn\u011bn\u00ed: Spatie Role/Permission (dokumentov\u00e1no v <code>permissions.md</code>).</li> </ul>"},{"location":"02-architecture/infrastructure/#doporucene-budouci-vylepseni-infra","title":"Doporu\u010den\u00e9 Budouc\u00ed Vylep\u0161en\u00ed (Infra)","text":"T\u00e9ma N\u00e1vrh P\u0159\u00ednos Observability P\u0159idat Prometheus scrape (extern\u00ed) + Grafana dashboard Viditelnost trend\u016f Logs struktura JSON log channel pro ops a access Snadn\u00e1 agregace / filtrace Backups integrity Periodick\u00fd SHA256 audit + random restore drill Vy\u0161\u0161\u00ed jistota obnovy Rate Limiting P\u0159idat konfigurovateln\u00e9 limity na kritick\u00e9 API (knowledge ingest) Ochrana v\u00fdkonu Secrets management Vault / SSM m\u00edsto prost\u00e9ho <code>.env</code> Bezpe\u010dnost <p>Aktualizovat p\u0159i zm\u011bn\u011b docker-compose, p\u0159id\u00e1n\u00ed slu\u017eeb nebo zm\u011bn\u011b cest.</p>"},{"location":"02-architecture/overview/","title":"Architektura \u2013 P\u0159ehled","text":"<p>High-level popis (doplnit diagramy).</p>"},{"location":"02-architecture/testing-strategy/","title":"Testovac\u00ed Strategie","text":""},{"location":"02-architecture/testing-strategy/#aktualni-stav-testu","title":"Aktu\u00e1ln\u00ed Stav Test\u016f","text":"Typ Sou\u010dasn\u00e9 pokryt\u00ed / p\u0159\u00edklady Feature (HTTP) Ops dashboard p\u0159\u00edstup &amp; permission testy, metrics endpoint (status + obsah) Unit <code>BackupStatusService</code> edge case (missing dir), ops help konfig testy Factories Model factories vyu\u017e\u00edv\u00e1ny v feature testech (User, OpsActivity) Datab\u00e1ze RefreshDatabase (sqlite fallback / migrace) <p>Uk\u00e1zkov\u00e9 existuj\u00edc\u00ed testy: - <code>tests/Feature/OpsMetricsContentTest.php</code> \u2013 validace metrik a gauge n\u00e1zv\u016f. - <code>tests/Feature/OpsDashboardAccessTest.php</code> \u2013 autorizace zobrazen\u00ed. - <code>tests/Unit/BackupStatusServiceTest.php</code> \u2013 logika fallbacku.</p>"},{"location":"02-architecture/testing-strategy/#gaps-chybejici-oblasti","title":"Gaps / Chyb\u011bj\u00edc\u00ed Oblasti","text":"Oblast Chyb\u00ed D\u016fsledek Dom\u00e9nov\u00e9 modely (scopes) Testy Opportunity lifecycle (won/lost), Contact normalizace Riziko regres\u00ed v business logice ActiveCampaign sync Mock API + delta sync sc\u00e9n\u00e1\u0159e (rate limit, offset reset) Nezaji\u0161t\u011bn\u00e1 robustnost integrace Knowledge ingestion Pipeline (upload \u2192 chunk \u2192 embedding \u2192 index) Skryt\u00e1 selh\u00e1n\u00ed p\u0159i zm\u011bn\u00e1ch embedding provider\u016f Permissions Seed &amp; enforcement test (ops.view vs. ostatn\u00ed) Tich\u00e9 opr\u00e1vn\u011bn\u00ed chyby Queue jobs Idempotence + retry logic testy Potenci\u00e1ln\u00ed duplikace / race conditions Schedule Kontrola, \u017ee kritick\u00e9 joby jsou napl\u00e1nov\u00e1ny (snapshot test) Necht\u011bn\u00e9 vypu\u0161t\u011bn\u00ed \u00falohy Backup verify Simulace fake dump + verify log parsing Verify m\u016f\u017ee degradovat bez pov\u0161imnut\u00ed API Rate limiting Throttle testy (chat, search) Mo\u017en\u00e9 DoS chov\u00e1n\u00ed Metrics coverage Test p\u0159\u00edtomnosti v\u0161ech o\u010dek\u00e1van\u00fdch metrik (snapshot) Tich\u00e1 ztr\u00e1ta metrik"},{"location":"02-architecture/testing-strategy/#doporuceny-roadmap-testu","title":"Doporu\u010den\u00fd Roadmap Test\u016f","text":"<ol> <li>Domain Behavior Suite</li> <li>Opportunitiy: transitions \u2192 won/lost sets closed_at; probability guard.</li> <li>Contact: email/phone normalization (valid/invalid cases).</li> <li>Integrace: ActiveCampaign Mock Server</li> <li>Simulace 200, 403 (rate limit), sch\u00e9ma zm\u011bna (neo\u010dek\u00e1van\u00e9 pole) \u2013 o\u010dek\u00e1van\u00e9 handling.</li> <li>Knowledge Pipeline</li> <li>Fake text upload \u2192 generovan\u00fd po\u010det chunk\u016f \u2192 index existence.</li> <li>Permissions &amp; ACL</li> <li>Matrix test: role vs. resource gates (403 vs 200) \u2013 snapshot.</li> <li>Backup / Verify E2E (tag @slow)</li> <li>Generovat mal\u00fd test dump + verify restore job \u2192 assert OpsActivity success.</li> <li>Schedule Assertions</li> <li>Test, \u017ee Kernel obsahuje o\u010dek\u00e1van\u00e9 patterny (regex extrakce).</li> <li>Metrics Snapshot</li> <li>Generace kontroln\u00edho seznamu metrik do fixture, test porovn\u00e1 set (ignoruje hodnoty).</li> <li>Job Idempotence</li> <li>Spu\u0161t\u011bn\u00ed jobu dvakr\u00e1t (nap\u0159. ActiveCampaignSyncJob) \u2013 bez duplik\u00e1t\u016f / ztr\u00e1t.</li> </ol>"},{"location":"02-architecture/testing-strategy/#nastroje-a-praktiky","title":"N\u00e1stroje a Praktiky","text":"T\u00e9ma Doporu\u010den\u00ed Test dat Minim\u00e1ln\u00ed factories; \u017e\u00e1dn\u00e9 masivn\u00ed seedery v unit testech Izolace integrac\u00ed Mock HTTP (HTTP::fake) pro ActiveCampaign/Qdrant v unit level Rychl\u00e9 zp\u011btn\u00e9 vazby Odd\u011blit <code>@slow</code> skupinu (verify, pipeline) do separ\u00e1tn\u00edho GitHub jobu Coverage P\u0159idat <code>Xdebug</code> nebo <code>pcov</code> jen v coverage workflow (voliteln\u00e9) Mutace Striker / Infection (voliteln\u011b) pro kritick\u00e9 business funkce"},{"location":"02-architecture/testing-strategy/#metriky-kvality-cilove","title":"Metriky Kvality (c\u00edlov\u00e9)","text":"Metrika C\u00edl Feature business kritick\u00e9 flows pokryty \u2265 80% kritick\u00fdch cest Integrace (mock sc\u00e9n\u00e1\u0159e) \u2265 3 kl\u00ed\u010dov\u00e9 varianty na integraci Idempotence job\u016f testov\u00e1na Top 5 kritick\u00fdch job\u016f Permission matrix test 100% definovan\u00fdch gate rout"},{"location":"02-architecture/testing-strategy/#priklad-template-pro-novy-feature-test","title":"P\u0159\u00edklad Template pro Nov\u00fd Feature Test","text":"<pre><code>public function test_contact_email_is_normalized(): void\n{\n    $user = User::factory()-&gt;create();\n    $this-&gt;actingAs($user);\n    $resp = $this-&gt;post('/crm/contacts', [\n        'first_name' =&gt; 'John',\n        'last_name' =&gt; 'Doe',\n        'email' =&gt; '  JOHN.DOE+tag@Example.COM  ',\n    ]);\n    $resp-&gt;assertRedirect();\n    $contact = Contact::first();\n    $this-&gt;assertEquals('john.doe@example.com', $contact-&gt;normalized_email);\n}\n</code></pre> <p>Aktualizovat p\u0159i p\u0159id\u00e1n\u00ed nov\u00fdch integra\u010dn\u00edch slu\u017eeb nebo modul\u016f.</p>"},{"location":"03-domain/domain-model/","title":"Dom\u00e9nov\u00fd Model (Inicialn\u00ed Skeleton)","text":"<p>Tento dokument je dopln\u011bn: ERD (generov\u00e1no), Model Fields a DB Schema (generov\u00e1no). N\u00ed\u017ee jsou shrnut\u00e9 popisy dom\u00e9nov\u00fdch entit.</p>"},{"location":"03-domain/domain-model/#entity-z-appmodels","title":"Entity (z <code>app/Models</code>)","text":"Model Popis Company Firma / \u00fa\u010det; dr\u017e\u00ed z\u00e1kladn\u00ed profil (odv\u011btv\u00ed, velikost, revenue) a agreguje kontakty, p\u0159\u00edle\u017eitosti, projekty a objedn\u00e1vky. Contact Osoba spojen\u00e1 s firmou; obsahuje normalizaci emailu/telefonu a marketing status. ContactCustomField Dynamick\u00e9 (kl\u00ed\u010d, hodnota, typ) roz\u0161\u00ed\u0159en\u00ed kontaktu + mapov\u00e1n\u00ed na AC field. ContactIdentity Extern\u00ed identity kontaktu (zdroj, external_id/hash) pro deduplikaci. Deal Dohoda nav\u00e1zan\u00e1 na Opportunity (kontrakt / fin\u00e1ln\u00ed f\u00e1ze) se stavem podpisu. KnowledgeChunk Jeden vektorov\u00fd chunk dokumentu (text + embedding + metadata + qdrant_point_id). KnowledgeDocument Zdrojov\u00fd dokument pro znalostn\u00ed b\u00e1zi (stav indexace, embedding meta, po\u010dty chunk\u016f). KnowledgeNote Ru\u010dn\u011b psan\u00e1 pozn\u00e1mka u\u017eivatele s tagy (ne v\u017edy vektorizov\u00e1no). Lead (TBD \u2013 soubor nen\u00ed dopln\u011bn / z\u0159ejm\u011b budouc\u00ed f\u00e1ze) Opportunity Obchodn\u00ed p\u0159\u00edle\u017eitost s f\u00e1zemi (stage, probability, expected_close_date). OpsActivity Z\u00e1znam o provozn\u00ed aktivit\u011b (backup, verifikace, atd.) v\u010detn\u011b \u010dasov\u00e9ho pr\u016fb\u011bhu. ProductGroup (TBD \u2013 strom kategori\u00ed / produktov\u00fdch skupin \u2013 chyb\u00ed model ve v\u00fdpisu find) Project Projekt (\u010dasov\u00e9 obdob\u00ed / definovan\u00fd c\u00edl) nav\u00e1zan\u00fd na firmu/kontakt, agreguje \u00fakoly. SalesOrder Prodejn\u00ed objedn\u00e1vka (order_date, total_amount) nav\u00e1zan\u00e1 na firmu a kontakt. SalesOrderItem Polo\u017eka objedn\u00e1vky (ceny, slevy, skupiny) \u2013 decimal p\u0159esnost zachov\u00e1na pro anal\u00fdzu. SystemSetting Runtime nastaven\u00ed (key/value) s helpery <code>get</code> a <code>set</code>. Tag \u0160t\u00edtky prim\u00e1rn\u011b pro kontakty (pivot contact_tag). Task \u00dakol p\u0159i\u0159aditeln\u00fd k polymorfn\u00ed entit\u011b (Company/Contact/Project) + priority/status. User Autentizovan\u00fd u\u017eivatel (is_admin flag). AcSyncRun Z\u00e1znam b\u011bhu AC synchronizace (offset, counts, sample IDs, message). AppLink Konfigurovateln\u00e9 odkazy v aplikaci (UI launch bord). ChatToolAudit Audit z\u00e1znam interakce AI n\u00e1stroje (payload + result_meta + duration)."},{"location":"03-domain/domain-model/#vztahy-vyber","title":"Vztahy (v\u00fdb\u011br)","text":"<ul> <li>Company 1:N Contact / Opportunity / Project / SalesOrder</li> <li>Contact 1:N Opportunity / Project / SalesOrder; M:N Tag</li> <li>Opportunity 1:1 Deal (logick\u00e1 n\u00e1vaznost; nen\u00ed ciz\u00ed kl\u00ed\u010d v uk\u00e1zce \u2013 ov\u011b\u0159it p\u0159i ERD)</li> <li>KnowledgeDocument 1:N KnowledgeChunk</li> <li>SalesOrder 1:N SalesOrderItem</li> <li>Task morphTo (Company|Contact|Project) + p\u0159\u00edm\u00e9 project_id (dual linkage)</li> <li>AcSyncRun izolovan\u00e1 tabulka log\u016f (\u017e\u00e1dn\u00e9 FK) \u2013 nav\u00e1z\u00e1n\u00ed pouze logick\u00e9 p\u0159es \u010das</li> </ul>"},{"location":"03-domain/domain-model/#domain-rules-pocatecni","title":"Domain Rules (po\u010d\u00e1te\u010dn\u00ed)","text":"<ul> <li>Contact: normalizace emailu &amp; telefonu p\u0159i <code>saving</code> \u2013 odfiltrov\u00e1n\u00ed placeholder\u016f.</li> <li>Opportunity: f\u00e1ze <code>won|lost</code> definuj\u00ed uzav\u0159en\u00fd stav (scopes <code>open/closed/won/lost</code>).</li> <li>SalesOrderItem: decimal p\u0159esnost pro ceny a slevy (finan\u010dn\u00ed anal\u00fdza; neagregovat v aplika\u010dn\u00ed vrstv\u011b s floaty).</li> <li>SystemSetting: jedine\u010dnost kl\u00ed\u010de vynucena p\u0159es <code>updateOrCreate</code>.</li> <li>Knowledge* entity: embedding dimenze mus\u00ed b\u00fdt konzistentn\u00ed (p\u0159i zm\u011bn\u011b \u2192 reindex all).</li> </ul>"},{"location":"03-domain/domain-model/#plan-doplneni","title":"Pl\u00e1n dopln\u011bn\u00ed","text":"<ol> <li>Vygenerovat ERD \u2192 <code>docs/16-generated/erd.svg</code> (script add: php artisan docs:erd nebo external tool \u2013 pending).</li> <li>Sloupcov\u00e9 tabulky \u2013 hotovo (viz DB Schema (gen), INFORMATION_SCHEMA introspekce).</li> <li>P\u0159idat sekci \"Lifecycle Events\" (boot hooks: Contact normalizace).</li> <li>P\u0159idat business SLA metriky (lead \u2192 opportunity conversion, opportunity cycle time).</li> </ol>"},{"location":"04-modules/ops/","title":"Ops Modul","text":"<p>Provozn\u00ed (operations) subsyst\u00e9m zaji\u0161\u0165uj\u00edc\u00ed: z\u00e1lohy, ov\u011b\u0159ov\u00e1n\u00ed obnovy, health reporting, audit aktivit.</p>"},{"location":"04-modules/ops/#cile","title":"C\u00edle","text":"<ul> <li>Spolehliv\u00e9 denn\u00ed (a ad-hoc) z\u00e1lohy datab\u00e1ze a aplika\u010dn\u00edch dat.</li> <li>Automatick\u00e1 periodick\u00e1 verifikace obnovitelnosti (restore + sanity checks).</li> <li>Viditelnost: auditn\u00ed trail kl\u00ed\u010dov\u00fdch ops \u00fakon\u016f (<code>ops_activities</code>).</li> <li>Rychl\u00e1 diagnostika probl\u00e9m\u016f (report + Slack notifikace \u2013 pl\u00e1n).</li> </ul>"},{"location":"04-modules/ops/#klicove-jobs","title":"Kl\u00ed\u010dov\u00e9 Jobs","text":"Job Funkce Frekvence <code>RunBackupJob</code> (spatie/backup command) Spou\u0161t\u00ed z\u00e1lohu (files + DB) denn\u011b / manu\u00e1ln\u011b <code>CleanupBackupsJob</code> \u010cist\u00ed star\u00e9 z\u00e1lohy dle retention denn\u011b po backup <code>RunVerifyRestoreJob</code> Vytvo\u0159\u00ed temp DB, importuje posledn\u00ed dump, ov\u011b\u0159\u00ed po\u010dty tabulek/\u0159\u00e1dk\u016f denn\u011b <code>GenerateBackupReportJob</code> Sestav\u00ed Markdown report (p\u0159ehled posledn\u00edch z\u00e1loh) denn\u011b po verify <code>EvaluateBackupHealthJob</code> Vyhodnot\u00ed posledn\u00ed b\u011bhy a nastav\u00ed status (pending) denn\u011b"},{"location":"04-modules/ops/#datove-artefakty","title":"Datov\u00e9 Artefakty","text":"<ul> <li>Slo\u017eka backup storage (S3 / lok\u00e1ln\u00ed volume) \u2013 snapshoty + dumpy.</li> <li>Tabulka <code>ops_activities</code> \u2013 log pr\u016fb\u011bhu (start/finish, status, duration, meta).</li> </ul>"},{"location":"04-modules/ops/#metriky-cilove","title":"Metriky (c\u00edlov\u00e9)","text":"Metrika C\u00edl Pozn\u00e1mka Backup success rate (7d) \u2265 99% Pom\u011br \u00fasp\u011b\u0161n\u00fdch backup job\u016f Verify success rate (7d) \u2265 99% Obnovovac\u00ed testy RPO (max age posledn\u00ed valid backup) &lt; 24h RPO definice Restore duration (min) sledovat trend M\u011b\u0159\u00ed \u010das importu dumpu"},{"location":"04-modules/ops/#exponovany-endpoint-plan","title":"Exponovan\u00fd endpoint (pl\u00e1n)","text":"<p><code>GET /crm/ops/metrics</code> vr\u00e1t\u00ed Prometheus text form\u00e1t, kl\u00ed\u010de (prefix <code>crm_ops_</code>): - <code>crm_ops_last_db_dump_age_minutes</code> - <code>crm_ops_last_verify_restore_age_hours</code> - <code>crm_ops_backup_success_rate_7d</code> - <code>crm_ops_verify_success_rate_7d</code> - <code>crm_ops_restore_duration_seconds_last</code></p> <p>Generov\u00e1no slu\u017ebou <code>BackupStatusService</code> + jednoduch\u00fd controller. Aktualizace ka\u017ed\u00e9 vol\u00e1n\u00ed (on-demand scrape).</p>"},{"location":"04-modules/ops/#alerting-eskalace","title":"Alerting / Eskalace","text":"<ul> <li>(Pl\u00e1n) Slack webhook p\u0159i: 2\u00d7 po sob\u011b fail verify, chyb\u011bj\u00edc\u00ed dump &gt;24h.</li> <li>Email fallback (cron) pokud Slack sel\u017ee.</li> </ul>"},{"location":"04-modules/ops/#slack-implementace-navrh","title":"Slack implementace (n\u00e1vrh)","text":"<p>Konfig: <code>ALERT_SLACK_WEBHOOK</code>. Slu\u017eba <code>AlertService</code>: <pre><code>public function send(string $event, array $context = []): void {\n    if (!($url = env('ALERT_SLACK_WEBHOOK'))) return;\n    $payload = [\n        'text' =&gt; \"[OPS] $event\".(empty($context)?'':\" ```\".json_encode($context, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT).\"```\")\n    ];\n    Http::timeout(3)-&gt;post($url, $payload);\n}\n</code></pre> Rate-limit: jednoduch\u00fd cache kl\u00ed\u010d <code>ops_alert_{$event}</code> TTL 5m pro potla\u010den\u00ed bou\u0159\u00ed.</p>"},{"location":"04-modules/ops/#proces-restore-automaticky-test","title":"Proces Restore (automatick\u00fd test)","text":"<ol> <li>Vytvo\u0159en\u00ed do\u010dasn\u00e9 DB (n\u00e1zev s prefixem <code>verify_</code>).</li> <li>Import posledn\u00edho dumpu (<code>mysql &lt; file.sql.gz</code>).</li> <li>Ov\u011b\u0159en\u00ed: po\u010det tabulek, sampling kl\u00ed\u010dov\u00fdch \u2013 Companies, Contacts.</li> <li>Drop temporary DB.</li> </ol>"},{"location":"04-modules/ops/#roadmap","title":"Roadmap","text":"<ul> <li>P\u0159idat metriky do Promethea / pushgateway.</li> <li>P\u0159idat export reportu do <code>docs/16-generated/backup-report.md</code>.</li> <li>Integrace Slack alert\u016f.</li> <li>Automatick\u00fd cleanup ne\u00fasp\u011b\u0161n\u00fdch temp DB p\u0159i restartu.</li> </ul>"},{"location":"04-modules/ops/#bezpecnostni-poznamky","title":"Bezpe\u010dnostn\u00ed Pozn\u00e1mky","text":"<ul> <li>Dumpy dr\u017eet jen na priv\u00e1tn\u00edm storage (necommitovat).</li> <li>Skr\u00fdt citliv\u00e9 hodnoty ve reportu (hash/email anonymizace budouc\u00ed).</li> </ul>"},{"location":"05-integrations/activecampaign/","title":"Integrace: ActiveCampaign","text":""},{"location":"05-integrations/activecampaign/#ucel","title":"\u00da\u010del","text":"<p>Pravideln\u00e1 inkrement\u00e1ln\u00ed synchronizace kontakt\u016f z ActiveCampaign do intern\u00edch tabulek (kontakty, identity, log \u0161ar\u017e\u00ed <code>ac_sync_runs</code>).</p>"},{"location":"05-integrations/activecampaign/#flow-zjednoduseno","title":"Flow (zjednodu\u0161eno)","text":"<ol> <li>Scheduled job <code>ActiveCampaignSyncJob</code> b\u011b\u017e\u00ed ka\u017edou minutu.</li> <li>Z DB (SystemSetting) \u010dte offset <code>ac_sync_offset</code> a flag <code>ac_sync_enabled</code>.</li> <li>Vol\u00e1 AC API <code>GET /contacts</code> se str\u00e1nkov\u00e1n\u00edm (limit, offset, order by cdate DESC).</li> <li>Importer normalizuje &amp; mapuje pole \u2192 vytvo\u0159\u00ed / aktualizuje kontakty.</li> <li>Ulo\u017e\u00ed nov\u00fd offset (posun o po\u010det zpracovan\u00fdch).</li> </ol>"},{"location":"05-integrations/activecampaign/#modely-tabulky","title":"Modely / tabulky","text":"<ul> <li><code>contacts</code> / <code>contact_identities</code> \u2013 c\u00edlov\u00e1 data.</li> <li><code>ac_sync_runs</code> \u2013 pr\u016fb\u011bh synchronizac\u00ed (offset, po\u010dty, chybov\u00e9 stavy).</li> <li><code>system_settings</code> \u2013 runtime p\u0159ep\u00edna\u010de.</li> </ul>"},{"location":"05-integrations/activecampaign/#konfigurace-nastaveni","title":"Konfigurace / nastaven\u00ed","text":"Kl\u00ed\u010d SystemSetting V\u00fdznam ac_sync_enabled Povolit / zak\u00e1zat automatickou \u0161ar\u017ei ac_sync_offset Aktu\u00e1ln\u00ed offset v AC str\u00e1nkov\u00e1n\u00ed <p>ENV prom\u011bnn\u00e9 (viz <code>.env.example</code>): <code>AC_BASE_URL</code>, <code>AC_API_TOKEN</code>.</p>"},{"location":"05-integrations/activecampaign/#failure-modes","title":"Failure Modes","text":"Sc\u00e9n\u00e1\u0159 Detekce Mitigace Rate limit / 403 Importer vr\u00e1t\u00ed soft-fail (<code>ok=false</code>) Job skon\u010d\u00ed OK bez posunu offsetu, log warning API zm\u011bna sch\u00e9matu V\u00fdjimka v importeru Alert v logu, manu\u00e1ln\u00ed z\u00e1sah Desynchronizace offsetu Skok v po\u010dtu kontakt\u016f Ru\u010dn\u00ed reset offsetu (SystemSetting)"},{"location":"05-integrations/activecampaign/#alerting","title":"Alerting","text":"<ul> <li>(Pl\u00e1n) Slack notifikace p\u0159i opakovan\u00e9 soft-fail sekvenci.</li> </ul>"},{"location":"05-integrations/activecampaign/#manualni-spusteni","title":"Manu\u00e1ln\u00ed spu\u0161t\u011bn\u00ed","text":"<p><pre><code>php artisan queue:dispatch \"App\\\\Jobs\\\\ActiveCampaignSyncJob\"\n</code></pre> (Alternativn\u011b tinker a new instance s force=true.)</p>"},{"location":"05-integrations/activecampaign/#rozsireni","title":"Roz\u0161\u00ed\u0159en\u00ed","text":"<ul> <li>Delta sync zm\u011bn\u011bn\u00fdch od ur\u010dit\u00e9ho \u010dasu.</li> <li>Webhook push re\u017eim.</li> </ul>"},{"location":"05-integrations/embeddings-providers/","title":"Embeddings Providers","text":"<p>Shrnut\u00ed podporovan\u00fdch poskytovatel\u016f v <code>EmbeddingsService</code>.</p> Provider Auth Endpoint Omezen\u00ed Pozn\u00e1mky openai Bearer token https://api.openai.com/v1/embeddings D\u00e9lka input ~8k token\u016f Standardn\u00ed JSON form\u00e1t (data[0].embedding) gemini API key v URL param https://generativelanguage.googleapis.com/...:embedContent Limit textu ~8k Struktura embedding.embedding.values openrouter Bearer token + voliteln\u00e9 hlavi\u010dky https://openrouter.ai/api/v1/embeddings Model n\u00e1zev s vendor prefixem OpenAI-kompatibiln\u00ed struktura local \u017e\u00e1dn\u00fd (intern\u00ed) http://embedder:8080/embeddings Podle vlastn\u00ed slu\u017eby Vrac\u00ed pole vectors[0]"},{"location":"05-integrations/embeddings-providers/#runtime-prepinace-systemsetting-klice","title":"Runtime p\u0159ep\u00edna\u010de (SystemSetting kl\u00ed\u010de)","text":"Kl\u00ed\u010d V\u00fdznam Fallback embeddings.provider Aktivn\u00ed provider config/qdrant.php embeddings.model N\u00e1zev modelu config embeddings.openai_api_key API kl\u00ed\u010d env OPENAI_API_KEY embeddings.gemini_api_key API kl\u00ed\u010d env GOOGLE_GEMINI_API_KEY embeddings.openrouter_api_key API kl\u00ed\u010d env OPENROUTER_API_KEY embeddings.local_url URL lok\u00e1ln\u00ed slu\u017eby env EMBEDDINGS_LOCAL_URL embeddings.dimension Fixn\u00ed dimenze config / inference"},{"location":"05-integrations/embeddings-providers/#chovani-pri-chybe","title":"Chov\u00e1n\u00ed p\u0159i chyb\u011b","text":"<ul> <li>Chyb\u011bj\u00edc\u00ed kl\u00ed\u010d \u2192 metoda vrac\u00ed <code>null</code>.</li> <li>HTTP ne-200 \u2192 <code>null</code>.</li> <li>Nevalidn\u00ed JSON / struktura \u2192 <code>null</code> (volaj\u00edc\u00ed rozhodne o fallbacku nebo skipu).</li> </ul>"},{"location":"05-integrations/embeddings-providers/#doporuceni","title":"Doporu\u010den\u00ed","text":"<ul> <li>Uchovat dimenzi embedding\u016f konzistentn\u00ed po celou dobu (zm\u011bna vy\u017eaduje reindex kolekce).</li> <li>Logovat m\u00edru selh\u00e1n\u00ed embedding fetch (prom\u011bnn\u00e9 metriky budouc\u00ed roz\u0161\u00ed\u0159en\u00ed).</li> </ul>"},{"location":"05-integrations/qdrant/","title":"Integrace: Qdrant","text":"<p>Vektorov\u00fd vyhled\u00e1vac\u00ed backend pro znalostn\u00ed b\u00e1zi.</p>"},{"location":"05-integrations/qdrant/#ucel","title":"\u00da\u010del","text":"<p>Umo\u017e\u0148uje semantick\u00e9 vyhled\u00e1v\u00e1n\u00ed p\u0159es embeddings dokument\u016f (notes, files) pro intern\u00ed znalostn\u00ed asistenci.</p>"},{"location":"05-integrations/qdrant/#komponenty","title":"Komponenty","text":"<ul> <li><code>QdrantClient</code> \u2013 HTTP wrapper (kolekce, upsert, search, count, deleteByFilter)</li> <li><code>EmbeddingsService</code> \u2013 abstrakce nad poskytovateli embedding\u016f (OpenAI / Gemini / OpenRouter / Local)</li> <li><code>IndexKnowledgeDocumentJob</code> (odhad dle n\u00e1zvu) \u2013 indexace obsahu</li> </ul>"},{"location":"05-integrations/qdrant/#konfigurace-configqdrantphp","title":"Konfigurace (<code>config/qdrant.php</code>)","text":"Kl\u00ed\u010d V\u00fdznam enabled Glob\u00e1ln\u00ed p\u0159ep\u00edna\u010d url Z\u00e1kladn\u00ed URL Qdrant API api_key API kl\u00ed\u010d pokud vy\u017eadov\u00e1no collection N\u00e1zev kolekce embeddings.provider openai / gemini / openrouter / local embeddings.model Model jm\u00e9na dle provideru embeddings.dimension Voliteln\u00e9 p\u0159eps\u00e1n\u00ed dimenze"},{"location":"05-integrations/qdrant/#embedding-providers","title":"Embedding Providers","text":"Provider Vol\u00e1n\u00ed Pozn\u00e1mka openai POST /v1/embeddings Vy\u017eaduje OPENAI_API_KEY gemini POST generativelanguage.googleapis.com ...:embedContent Rate limit odli\u0161n\u00fd openrouter POST /api/v1/embeddings Normalizace modelu s vendor prefixem local POST /embeddings (internal service) Normalizace vectoru (normalize=true)"},{"location":"05-integrations/qdrant/#failure-modes","title":"Failure Modes","text":"Sc\u00e9n\u00e1\u0159 Detekce Chov\u00e1n\u00ed Embedding provider bez kl\u00ed\u010de Vr\u00e1ceno null Dokument p\u0159esko\u010den / log debug Timeout HTTP Http::timeout() v\u00fdjimka Vr\u00e1ceno null \u2192 vynechan\u00fd embedding Chybn\u00e1 kolekce (neexistuje) ensureCollection false Recreate nebo log warning Upsert sel\u017ee !ok odpov\u011b\u010f Log warning + pokra\u010dov\u00e1n\u00ed"},{"location":"05-integrations/qdrant/#bezpecnost","title":"Bezpe\u010dnost","text":"<ul> <li>API kl\u00ed\u010de dr\u017eet v env / SystemSetting.</li> <li>Omezit p\u0159\u00edstup Qdrant jen na intern\u00ed s\u00ed\u0165 (docker network <code>crm-internal</code>).</li> </ul>"},{"location":"05-integrations/qdrant/#rozsireni","title":"Roz\u0161\u00ed\u0159en\u00ed","text":"<ul> <li>P\u0159idat batch upsert s retry.</li> <li>P\u0159idat metriky (po\u010det vektor\u016f, latency).</li> </ul>"},{"location":"06-products/implementation-plan/","title":"Implementa\u010dn\u00ed Pl\u00e1n Produktov\u00e9ho Modulu","text":"<p>Tento dokument rozepisuje konkr\u00e9tn\u00ed \u00fakoly, jejich po\u0159ad\u00ed, akcepta\u010dn\u00ed krit\u00e9ria a technick\u00e9 detaily.</p>"},{"location":"06-products/implementation-plan/#legenda-stavu","title":"Legenda stav\u016f","text":"<ul> <li>TODO \u2013 neimplementov\u00e1no</li> <li>IN PROGRESS \u2013 rozpracov\u00e1no</li> <li>DONE \u2013 hotovo (merge v main + changelog)</li> </ul>"},{"location":"06-products/implementation-plan/#faze-1-datovy-model","title":"F\u00e1ze 1: Datov\u00fd Model","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 1.1 Migrace tabulky <code>products</code> migration + model Sloupce dle n\u00e1vrhu, indexy external_id, ean, category_path TODO 1.2 Audit tab. <code>product_price_changes</code> migration FK na product, old/new value, created_at TODO 1.3 Audit tab. <code>product_availability_changes</code> migration FK na product, old/new code, stock qty, created_at TODO 1.4 Eloquent model <code>Product</code> + scopes Model Scopes: filterCategory, filterAvailability, filterManufacturer, search TODO"},{"location":"06-products/implementation-plan/#faze-2-full-import-pipeline","title":"F\u00e1ze 2: Full Import Pipeline","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 2.1 Parsovac\u00ed slu\u017eba (stream) Service class Um\u00ed iterovat polo\u017eky bez na\u010dten\u00ed cel\u00e9ho XML do pam\u011bti TODO 2.2 Canonical builder + hash Service Stabiln\u00ed SHA1 generace nad sorted keys TODO 2.3 Command <code>products:import-full</code> Artisan command Log summary (new/updated/unchanged/errors) TODO 2.4 Upsert logic (chunked) Service method Chunk &lt;=1000, transakce, minimalizace N+1 TODO 2.5 Ops event log integration Event dispatch Z\u00e1znam v ops_events s metrikami TODO"},{"location":"06-products/implementation-plan/#faze-3-availability-delta-sync","title":"F\u00e1ze 3: Availability Delta Sync","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 3.1 Parsov\u00e1n\u00ed availability feedu Service Map external_id \u2192 changes TODO 3.2 Command <code>products:sync-availability</code> Command Statistiky: changed count, skipped, errors TODO 3.3 Audit z\u00e1pis availability zm\u011bn Insert logic Spr\u00e1vn\u011b uchov\u00e1v\u00e1 historii TODO 3.4 Ops event log integration Event Ud\u00e1lost products.availability_sync TODO"},{"location":"06-products/implementation-plan/#faze-4-ui-seznam-detail","title":"F\u00e1ze 4: UI - Seznam &amp; Detail","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 4.1 Route + Controller index Controller + route Autorizace products.view TODO 4.2 Blade seznam (Adminto) View Breadcrumb, collapsible filtry, clickable rows, tooltips sync info TODO 4.3 Detailov\u00e1 str\u00e1nka (Adminto) View + controller show Tabs historie (cena/dostupnost), lazy obr\u00e1zek, badges TODO 4.4 Filtrovac\u00ed logika (scopes) Implementace Kombinace filtr\u016f bez v\u00fdrazn\u00e9ho zpomalen\u00ed TODO 4.5 Permission seeding Seeder update Admin role m\u00e1 products.view + products.sync TODO 4.6 UX polish &amp; a11y Review checklist Tooltips aktivn\u00ed, kl\u00e1vesov\u00e1 navigace, kontrast badges TODO"},{"location":"06-products/implementation-plan/#faze-5-integrace-ops-scheduler","title":"F\u00e1ze 5: Integrace Ops &amp; Scheduler","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 5.1 Napl\u00e1nov\u00e1n\u00ed cron\u016f Kernel schedule Cron z\u00e1pisy viditeln\u00e9 v generovan\u00e9m schedule.md TODO 5.2 Ops dashboard widget Blade partial Zobrazuje posledn\u00ed full import &amp; availability sync TODO 5.3 Ru\u010dn\u00ed spu\u0161t\u011bn\u00ed akc\u00ed Ops controller endpoint Throttle + autorizace products.sync TODO"},{"location":"06-products/implementation-plan/#faze-6-logovani-a-observabilita","title":"F\u00e1ze 6: Logov\u00e1n\u00ed a Observabilita","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 6.1 Chybov\u00e9 retry wrapper Trait / helper Exponenci\u00e1ln\u00ed backoff (max 3) TODO 6.2 Maskov\u00e1n\u00ed feed URL tokenu Logger config Token se v logu nikdy neobjev\u00ed v pln\u00e9 podob\u011b TODO 6.3 Alert podm\u00ednky (budouc\u00ed) Spec Definice pravidel (doc) TODO"},{"location":"06-products/implementation-plan/#faze-7-optimalizace-hardening","title":"F\u00e1ze 7: Optimalizace &amp; Hardening","text":"Krok Popis V\u00fdstup Krit\u00e9ria Stav 7.1 Indexy a EXPLAIN ov\u011b\u0159en\u00ed SQL / dokument EXPLAIN u filtr\u016f &lt; 50 ms p\u0159i 100k \u0159\u00e1dc\u00edch (c\u00edlen\u011b) TODO 7.2 Memory footprint test Report Full import &lt; 512MB peak TODO 7.3 Rate limiting ru\u010dn\u00edch sync\u016f Middleware Zabr\u00e1n\u011bn\u00ed zneu\u017eit\u00ed (nap\u0159. 5/min) TODO"},{"location":"06-products/implementation-plan/#datove-transformace-detail","title":"Datov\u00e9 transformace (detail)","text":"<pre><code>canonical = [\n  'external_id' =&gt; (string)$xml-&gt;ITEM_ID,\n  'name' =&gt; trim((string)$xml-&gt;PRODUCTNAME),\n  'description' =&gt; sanitizeHtml((string)$xml-&gt;DESCRIPTION),\n  'ean' =&gt; (string)$xml-&gt;EAN ?: null,\n  'manufacturer' =&gt; (string)$xml-&gt;MANUFACTURER ?: null,\n  'category_path' =&gt; buildCategoryPath($xml),\n  'url' =&gt; (string)$xml-&gt;URL,\n  'image_url' =&gt; (string)$xml-&gt;IMGURL ?: null,\n  'price_vat' =&gt; (float)$xml-&gt;PRICE_VAT,\n  'price_original_vat' =&gt; (float)$xml-&gt;ITEM_TYPE == 'action' ? (float)$xml-&gt;ORIGINAL_PRICE_VAT : null,\n  'currency' =&gt; 'CZK',\n  'availability_code' =&gt; (string)$xml-&gt;DELIVERY_DATE,\n  'availability_text' =&gt; mapAvailability((string)$xml-&gt;DELIVERY_DATE),\n  'stock_quantity' =&gt; null, // z availability feedu pozd\u011bji\n  'delivery_date' =&gt; (string)$xml-&gt;DELIVERY_DATE ?: null,\n];\n</code></pre> <p>Hash generace: <pre><code>$ordered = collect($canonical)-&gt;sortKeys()-&gt;all();\n$hash = sha1(json_encode($ordered, JSON_UNESCAPED_UNICODE));\n</code></pre></p>"},{"location":"06-products/implementation-plan/#pseudokod-full-importu","title":"Pseudok\u00f3d full importu","text":"<pre><code>foreach (streamHeurekaProducts($xmlFile) as $item) {\n  $canonical = buildCanonical($item);\n  $hash = canonicalHash($canonical);\n  $existing = $repo-&gt;findByExternalId($canonical['external_id']);\n  if (!$existing) { $toInsert[] = [...$canonical, 'hash_payload'=&gt;$hash]; continue; }\n  if ($existing-&gt;hash_payload !== $hash) {\n     $changes = diffPrice($existing, $canonical); // pokud cena jin\u00e1 -&gt; audit price change\n     $toUpdate[] = [...$canonical, 'id'=&gt;$existing-&gt;id, 'hash_payload'=&gt;$hash];\n  }\n  if (count($toInsert)+count($toUpdate) &gt;= 1000) { flushUpserts(); }\n}\nflushUpserts();\n</code></pre>"},{"location":"06-products/implementation-plan/#pseudokod-availability-sync","title":"Pseudok\u00f3d availability sync","text":"<pre><code>foreach (streamHeurekaAvailability($xmlFile) as $item) {\n  $externalId = (string)$item-&gt;ITEM_ID;\n  $newCode = (string)$item-&gt;DELIVERY_DATE;\n  $newQty = parseQty($item);\n  $p = $repo-&gt;findByExternalId($externalId);\n  if (!$p) continue;\n  if ($p-&gt;availability_code !== $newCode || $p-&gt;stock_quantity !== $newQty) {\n     auditAvailability($p, $newCode, $newQty);\n     $p-&gt;availability_code = $newCode;\n     $p-&gt;availability_text = mapAvailability($newCode);\n     $p-&gt;stock_quantity = $newQty;\n     $p-&gt;availability_synced_at = now();\n     $p-&gt;save();\n  }\n}\n</code></pre>"},{"location":"06-products/implementation-plan/#akceptacni-kriteria-modulu-mvp","title":"Akcepta\u010dn\u00ed krit\u00e9ria modulu (MVP)","text":"<ul> <li>Full import dokon\u010d\u00ed &lt; 30 min pro feed do 100k polo\u017eek.</li> <li>Delta sync &lt; 2 min.</li> <li>UI na\u010dte seznam &lt; 2 s p\u0159i 50k polo\u017ek\u00e1ch (paginace + indexy).</li> <li>Audit tabulky neobsahuj\u00ed duplik\u00e1ty stejn\u00fdch zm\u011bn back-to-back.</li> <li>UX: Filtry reaguj\u00ed &lt; 500 ms, historie na\u010dtena bez refresh (XHR) do tab\u016f.</li> </ul>"},{"location":"06-products/implementation-plan/#changelog","title":"Changelog","text":"<p>Po dokon\u010den\u00ed ka\u017ed\u00e9 f\u00e1ze p\u0159idat polo\u017eku (<code>ADDED</code>).</p>"},{"location":"06-products/implementation-plan/#bezpecnostni-opatreni","title":"Bezpe\u010dnostn\u00ed opat\u0159en\u00ed","text":"<ul> <li>Rate limit ru\u010dn\u00ed sync akce.</li> <li>Validace URL aby ne\u0161lo st\u00e1hnout jin\u00fd host.</li> <li>O\u0161et\u0159it XML entity (libxml_disable_entity_loader / LIBXML_NOENT nepou\u017e\u00edvat).</li> </ul> <p>Aktualizuj pr\u016fb\u011b\u017en\u011b dle skute\u010dn\u00e9 implementace.</p>"},{"location":"06-products/implementation-plan/#analyza-heureka-feedu-real-data","title":"Anal\u00fdza Heureka feedu (real data)","text":"<p>Zdroj: sta\u017een\u00fd soubor <code>docs/feeds/heureka.xml</code> (\u22482.6 MB, 2332 polo\u017eek).</p>"},{"location":"06-products/implementation-plan/#prehled-tagu-frekvence-a-statistiky","title":"P\u0159ehled tag\u016f (frekvence a statistiky)","text":"<pre><code>ITEMS (SHOPITEM)........ 2332\nITEM_ID................. 2332 (numeric, max d\u00e9lka 6 -&gt; rezerva varchar(32))\nPRODUCTNAME............. 2332 (max 105 znak\u016f)\nPRICE_VAT............... 2332 (0 \u2013 318230; \u010d\u00e1rka jako desetinn\u00fd odd\u011blova\u010d)\nDESCRIPTION............. 2332 (pr\u00e1zdn\u00e9 545; max d\u00e9lka 2350 po normalizaci)\nIMGURL.................. 2325 (7 chyb\u00ed) [.jpg 1280 | .gif 514 | .png 508 | .jpeg 23]\nMANUFACTURER............ 660 (nullable)\nCATEGORYTEXT............ 2332 (max 148 znak\u016f)\nEAN..................... 1773 (d\u00e9lky: 5..15, p\u0159evaha 9 -&gt; nen\u00ed \u010dist\u00e9 EAN13)\nITEMGROUP_ID............ 1992 (unique groups 359; v\u0161echny multi; 340 bez skupiny)\nDELIVERY_DATE........... distribuce: 7=1624, 0=681, pr\u00e1zdn\u00e9=26, 3=1\nDELIVERY_ID............. v\u017edy TOPTRANS\nPARAM bloky............. 160 (jen 72 polo\u017eek maj\u00ed param \u2192 n\u00edzk\u00e1 adopce)\n</code></pre>"},{"location":"06-products/implementation-plan/#revize-schematu-products","title":"Revize sch\u00e9matu <code>products</code>","text":"<p>Sloupce (srovn\u00e1no podle re\u00e1ln\u00fdch dat): <pre><code>id BIGINT AI PK\nexternal_id VARCHAR(32) UNIQUE\ngroup_id VARCHAR(32) NULL INDEX\nname VARCHAR(150)\ndescription TEXT NULL\nprice_vat_cents INT UNSIGNED\ncurrency CHAR(3) DEFAULT 'CZK'\nmanufacturer VARCHAR(80) NULL\nean VARCHAR(20) NULL INDEX\ncategory_path VARCHAR(255)\ncategory_hash CHAR(40) INDEX\nurl VARCHAR(255)\nimage_url VARCHAR(255) NULL\navailability_code VARCHAR(8) INDEX\navailability_text VARCHAR(32)\nstock_quantity INT UNSIGNED NULL\navailability_synced_at TIMESTAMP NULL\nhash_payload CHAR(40)\nfirst_imported_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\nlast_synced_at TIMESTAMP NULL\nlast_price_changed_at TIMESTAMP NULL\nlast_availability_changed_at TIMESTAMP NULL\ncreated_at TIMESTAMP\nupdated_at TIMESTAMP\n</code></pre></p>"},{"location":"06-products/implementation-plan/#audit-tabulky-upraveno","title":"Audit tabulky (upraveno)","text":"<p>product_price_changes(id, product_id FK, old_price_cents, new_price_cents, changed_at, INDEX(product_id, changed_at desc))</p> <p>product_availability_changes(id, product_id FK, old_code, new_code, old_stock_qty, new_stock_qty, changed_at, INDEX(product_id, changed_at desc))</p>"},{"location":"06-products/implementation-plan/#transformace","title":"Transformace","text":"<ul> <li>PRICE_VAT \u2192 replace \",\" -&gt; \".\" \u2192 float \u2192 cents (round) \u2192 int</li> <li>DESCRIPTION \u2192 trim, komprese whitespace, strip HTML tag\u016f</li> <li>CATEGORYTEXT \u2192 split <code>|</code> \u2192 trim \u2192 join <code>&gt;</code>; hash = sha1(lower(join('|', normalSegments)))</li> <li>EAN \u2192 ulo\u017eit raw (regex voln\u011b: <code>[0-9A-Za-z_-]{5,20}</code>), nevalidujeme EAN13</li> <li>ITEMGROUP_ID \u2192 uppercase, empty =&gt; NULL</li> <li>IMGURL \u2192 validace protokolu + p\u0159\u00edpona (.jpg/.jpeg/.png/.gif) jinak NULL</li> <li>DELIVERY_DATE \u2192 availability_code; mapov\u00e1n\u00ed v configu</li> </ul>"},{"location":"06-products/implementation-plan/#mapovani-dostupnosti-pocatecni-navrh","title":"Mapov\u00e1n\u00ed dostupnosti (po\u010d\u00e1te\u010dn\u00ed n\u00e1vrh)","text":"<pre><code>7 =&gt; Skladem\n0 =&gt; Na objedn\u00e1vku\n3 =&gt; Do 3 dn\u016f\n\"\" =&gt; Nezn\u00e1mo\ndefault =&gt; Nezn\u00e1mo\n</code></pre>"},{"location":"06-products/implementation-plan/#odlozene-prvky-mimo-mvp","title":"Odlo\u017een\u00e9 prvky (mimo MVP)","text":"<ul> <li>PARAM atributy \u2192 budouc\u00ed tabulka product_attributes nebo JSON.</li> <li>DETAIL dopravy (ceny TOPTRANS) \u2192 nyn\u00ed ignorov\u00e1no.</li> </ul>"},{"location":"06-products/implementation-plan/#edge-cases-pokryti","title":"Edge cases pokryt\u00ed","text":"<ul> <li>7 chyb\u011bj\u00edc\u00edch IMGURL \u2192 povoleno (NULL)</li> <li>545 pr\u00e1zdn\u00fdch DESCRIPTION \u2192 povoleno</li> <li>Heterogenn\u00ed EAN d\u00e9lky \u2192 no UNIQUE constraint</li> <li>Varianty (group_id) \u2013 index pro listingy</li> <li>Pr\u00e1zdn\u00e9 DELIVERY_DATE \u2192 map na Nezn\u00e1mo</li> </ul>"},{"location":"06-products/implementation-plan/#aktualizace-planovanych-kroku","title":"Aktualizace pl\u00e1novan\u00fdch krok\u016f","text":"<ul> <li>F\u00e1ze 1.1 doplnit: category_hash, hash_payload, \u010dasov\u00e9 sloupce zm\u011bn.</li> <li>F\u00e1ze 2 generuje category_hash + hash_payload + sleduje price delty.</li> <li>F\u00e1ze 3 jen availability_code / stock_quantity + audit availability.</li> </ul>"},{"location":"06-products/implementation-plan/#dalsi-akce","title":"Dal\u0161\u00ed akce","text":"<ol> <li>P\u0159ipravit migration skeleton dle v\u00fd\u0161e.</li> <li>Vytvo\u0159it config/products.php s availability map.</li> <li>Implementovat stream parser s p\u0159evodem PRICE_VAT do cents.</li> <li>P\u0159idat helper pro category_hash.</li> <li>P\u0159ipravit unit testy (price parsing, category normalize, availability map).</li> </ol>"},{"location":"06-products/overview/","title":"Produkty (N\u00e1vrh)","text":"<p>Tato sekce popisuje pl\u00e1n zaveden\u00ed produktov\u00e9ho modulu do CRM v\u010detn\u011b: - Datov\u00e9ho modelu - Importu ze zdrojov\u00fdch feed\u016f Heureka (zbo\u017e\u00ed + dostupnosti) - Synchroniza\u010dn\u00ed strategie (delta aktualizace) - UI str\u00e1nky pro spr\u00e1vu / n\u00e1hled produkt\u016f - Monitoring a chybov\u00e9 zachycen\u00ed</p>"},{"location":"06-products/overview/#cile","title":"C\u00edle","text":"<ul> <li>Centralizovat produktov\u00e1 data (n\u00e1zev, EAN, kategorie, ceny, dostupnost, URL, popis, v\u00fdrobce) uvnit\u0159 CRM.</li> <li>Umo\u017enit obchodn\u00edmu t\u00fdmu rychl\u00fd p\u0159ehled a filtrov\u00e1n\u00ed.</li> <li>Pr\u016fb\u011b\u017en\u011b aktualizovat dostupnost a ceny bez pln\u00e9ho reimportu.</li> <li>Logovat zm\u011bny (audit) pro anal\u00fdzu v\u00fdvoje cen a dostupnost\u00ed.</li> </ul>"},{"location":"06-products/overview/#zdroje-dat","title":"Zdroje dat","text":"Feed URL Popis Form\u00e1t Frekvence na\u010dten\u00ed Heureka zbo\u017e\u00ed https://www.esl.cz/feed/heureka?token=5f0dac7b23e1d Kompletn\u00ed katalog produkt\u016f (z\u00e1znamy) XML 1\u00d7 denn\u011b full refresh Heureka dostupnosti https://www.esl.cz/feed/heureka-stocks?token=5f0dac7b23e1d Pr\u016fb\u011b\u017en\u00e9 zm\u011bny dostupnosti / sklad\u016f XML ka\u017ed\u00fdch 15 min (delta)"},{"location":"06-products/overview/#datovy-model-navrh","title":"Datov\u00fd model (n\u00e1vrh)","text":"<p>Hlavn\u00ed tabulka: <code>products</code></p> Sloupec Typ Pozn\u00e1mka id BIGINT PK intern\u00ed ID external_id VARCHAR(100) index ID z feedu (nap\u0159. ITEM_ID) name VARCHAR(255) N\u00e1zev description LONGTEXT nullable Popis (HTML / text) ean VARCHAR(50) index nullable EAN k\u00f3d manufacturer VARCHAR(120) nullable V\u00fdrobce category_path VARCHAR(255) Kategori\u00e1ln\u00ed hierarchie (slou\u010den\u00fd string) url VARCHAR(500) Produktov\u00e1 URL (eshop) image_url VARCHAR(500) nullable Hlavn\u00ed obr\u00e1zek price_vat DECIMAL(10,2) Aktu\u00e1ln\u00ed cena s DPH price_original_vat DECIMAL(10,2) nullable P\u016fvodn\u00ed / doporu\u010den\u00e1 cena currency CHAR(3) default 'CZK' M\u011bna availability_code VARCHAR(50) K\u00f3d dostupnosti (nap\u0159. skladem) availability_text VARCHAR(120) P\u0159eklad / text dostupnosti stock_quantity INT nullable Po\u010det kus\u016f (pokud feed poskytuje) delivery_date VARCHAR(50) nullable Term\u00edn dod\u00e1n\u00ed (pokud feed poskytuje) hash_payload CHAR(40) SHA1 canonical payload (detekce zm\u011bn full feed) last_synced_at TIMESTAMP Posledn\u00ed \u00fasp\u011b\u0161n\u00e1 synchronizace z full feedu availability_synced_at TIMESTAMP nullable Posledn\u00ed delta dostupnosti created_at TIMESTAMP updated_at TIMESTAMP <p>Audit / zm\u011bny: <code>product_price_changes</code>, <code>product_availability_changes</code> (pouze zm\u011bny).</p>"},{"location":"06-products/overview/#importni-pipeline","title":"Importn\u00ed pipeline","text":""},{"location":"06-products/overview/#1-full-import-daily","title":"1. Full Import (Daily)","text":"<ul> <li>Scheduler job <code>products:import-full</code> (1\u00d7 denn\u011b, nap\u0159. 04:10).</li> <li>St\u00e1hne cel\u00fd Heureka feed (zbo\u017e\u00ed XML) do do\u010dasn\u00e9ho souboru.</li> <li>Stream / SAX parsov\u00e1n\u00ed (ni\u017e\u0161\u00ed pam\u011b\u0165ov\u00fd footprint) -&gt; canonical array -&gt; SHA1 JSON -&gt; hash.</li> <li>Detekce nov\u00fdch / zm\u011bn\u011bn\u00fdch produkt\u016f porovn\u00e1n\u00edm <code>hash_payload</code>.</li> <li>Upsert zm\u011bn\u011bn\u00e9 z\u00e1znamy v transakc\u00edch (chunky 500\u20131000).</li> <li>Log: po\u010det nov\u00fdch, zm\u011bn\u011bn\u00fdch, nezm\u011bn\u011bn\u00fdch, chybn\u00e9 polo\u017eky.</li> </ul>"},{"location":"06-products/overview/#2-availability-delta-every-15-min","title":"2. Availability Delta (Every 15 min)","text":"<ul> <li>Scheduler job <code>products:sync-availability</code>.</li> <li>Na\u010dte dostupnost feed (men\u0161\u00ed XML) \u2013 iterace polo\u017eek -&gt; match by <code>external_id</code>.</li> <li>Pokud zm\u011bna v <code>availability_code</code> nebo <code>stock_quantity</code> \u2192 ulo\u017eit a insert do audit tabulky.</li> <li><code>availability_synced_at</code> update pro produkt.</li> </ul>"},{"location":"06-products/overview/#3-error-handling","title":"3. Error Handling","text":"<ul> <li>S\u00ed\u0165 / HTTP chyba \u2192 retry (exponenci\u00e1ln\u00ed backoff max 3x) -&gt; pokud fail, ulo\u017eit z\u00e1znam do <code>ops_events</code> pro monitoring.</li> <li>XML parsing error \u2192 p\u0159esko\u010dit polo\u017eku + log detailu (limit 20 polo\u017eek na jeden b\u011bh).</li> </ul>"},{"location":"06-products/overview/#canonicalizace-dat","title":"Canonicalizace dat","text":"<ul> <li>Trim whitespace, unifikace m\u011bny na CZK.</li> <li>Ceny parse jako float \u2192 DECIMAL.</li> <li>Kategorie join path <code>&gt;</code> (nap\u0159. \"Elektronika &gt; Audio &gt; Sluch\u00e1tka\").</li> <li>Hash: SHA1 JSON se\u0159azen\u00fdch kl\u00ed\u010d\u016f (stabiln\u00ed po\u0159ad\u00ed pro opakovatelnost).</li> </ul>"},{"location":"06-products/overview/#ui-stranka","title":"UI Str\u00e1nka","text":"<p>Route: <code>GET /crm/products</code></p> <p>Z\u00e1kladn\u00ed seznam: - Sloupce: N\u00e1zev, Cena (aktu\u00e1ln\u00ed vs p\u016fvodn\u00ed), Dostupnost (barevn\u00fd badge), V\u00fdrobce, Kategorie (prvn\u00ed 2 \u00farovn\u011b), Posl. sync ikonky. - Filtrov\u00e1n\u00ed: kategorie (prefix match), dostupnost, v\u00fdrobce, cenov\u00e9 rozp\u011bt\u00ed, fulltext n\u00e1zev/EAN. - Akce (MVP): refresh availability (async trigger), detail produktu.</p> <p>Detail produktu: - Z\u00e1kladn\u00ed info + historie zm\u011bn (posledn\u00edch X cen a dostupnost\u00ed timeline).</p>"},{"location":"06-products/overview/#ui-a-sablona-adminto","title":"UI a \u0161ablona (Adminto)","text":"<p>Pou\u017eije se existuj\u00edc\u00ed Adminto layout (<code>@extends('layouts.base')</code>).</p> <p>Seznam (index) \u2013 komponenty: - Breadcrumb: \"CRM / Produkty\". - Header toolbar: tla\u010d\u00edtko \"Ru\u010dn\u00ed sync dostupnosti\" (pokud <code>products.sync</code>), export CSV (etapa pozd\u011bji), badge s po\u010dtem produkt\u016f. - Filtra\u010dn\u00ed panel (collapsible card) se z\u00e1kladn\u00edmi poli (text search, kategorie select (lazy), v\u00fdrobce select, dostupnost multi-select, cenov\u00e9 min/max). - Tabulka: \u010dist\u00e1 Bootstrap table + sticky header (CSS), str\u00e1nkov\u00e1n\u00ed dole (Laravel paginator). Ka\u017ed\u00fd \u0159\u00e1dek kliknuteln\u00fd (JS) -&gt; detail. - Dostupnost: barevn\u00e9 badge mapovan\u00e9 dle k\u00f3du (nap\u0159. zelen\u00e1 = skladem, oran\u017eov\u00e1 = do 3 dn\u016f, \u0161ed\u00e1 = nezn\u00e1m\u00e9) \u2013 konzistentn\u00ed s definic\u00ed v mapovac\u00ed funkci. - Posledn\u00ed sync: dv\u011b ikonky (full import vs availability) s tooltipem (<code>data-bs-toggle=\"tooltip\"</code>).</p> <p>Detail: - Breadcrumb: \"CRM / Produkty / {N\u00e1zev}\". - Lev\u00fd sloupec (col-lg-8): z\u00e1kladn\u00ed karta (n\u00e1zev, v\u00fdrobce, kategorie path jako small text, cena + p\u016fvodn\u00ed cena p\u0159e\u0161krtnut\u00e1 pokud existuje), dostupnost badge, primary akce (aktualizovat dostupnost jedn\u00e9 polo\u017eky \u2013 async). - Prav\u00fd sloupec (col-lg-4): obr\u00e1zek (lazy), metadata (EAN, external_id, URL link target _blank), posledn\u00ed sync timestamps. - Tabs: \"Historie cen\", \"Historie dostupnosti\" \u2013 timeline komponenta (vertical list) s datem + zm\u011bna star\u00e1 \u2192 nov\u00e1 (\u0161ipka). Paginace / infinite scroll (limit 50 z\u00e1znam\u016f na na\u010dten\u00ed).</p> <p>Interakce / JS: - Minim\u00e1ln\u00ed JS (Bootstrap tooltips + jednoduch\u00fd row click) \u2013 \u017e\u00e1dn\u00e1 heavy SPA knihovna. - Filtrovac\u00ed formul\u00e1\u0159 submit p\u0159es GET (SEO / shareable URL), persistent parametry. - Loading stav pro ru\u010dn\u00ed sync (disable button + spinner) \u2013 vyu\u017e\u00edt existuj\u00edc\u00ed spinner utility z Adminto (viz dokumentace <code>Adminto \u0160ablona</code>).</p> <p>P\u0159\u00edstupnost / u\u017eivatelsk\u00e1 p\u0159\u00edv\u011btivost: - Tab index zachov\u00e1n, filtry seskupeny p\u0159es <code>&lt;fieldset&gt;</code>. - Zaji\u0161t\u011bn\u00e9 kontrastn\u00ed barvy pro badge (WCAG AA). </p> <p>Reference: viz <code>Adminto \u0160ablona</code> dokument pro konvence komponent a utility t\u0159\u00eddy.</p>"},{"location":"06-products/overview/#monitoring-observabilita","title":"Monitoring / Observabilita","text":"<p>Implementov\u00e1no: zapisuje se do <code>ops_activities</code> (type <code>products.full_import</code>, <code>products.sync_availability</code>) \u2013 <code>meta</code> obsahuje metriky (new, updated, unchanged / updated, skipped, missing; duration_ms). Pl\u00e1n (budouc\u00ed): alerting (pokud full import &gt; 48h star\u00fd nebo &gt;5 po sob\u011b jdouc\u00edch delt bez zm\u011bn / s chybou).</p>"},{"location":"06-products/overview/#napojeni-na-existujici-ops-modul","title":"Napojen\u00ed na existuj\u00edc\u00ed Ops modul","text":"<ul> <li>Ops dashboard zobraz\u00ed posledn\u00ed full import + posledn\u00ed availability sync.</li> <li>Akce: ru\u010dn\u00ed vyvol\u00e1n\u00ed full importu / availability sync (throttle + autorizace <code>can:ops.execute</code>).</li> </ul>"},{"location":"06-products/overview/#permission-model","title":"Permission Model","text":"<ul> <li>Nov\u00e1 permission skupina <code>products.view</code>, <code>products.sync</code>.</li> <li>Default admin role \u2192 oboj\u00ed povoleno.</li> </ul>"},{"location":"06-products/overview/#scheduler-plan-navrh","title":"Scheduler Pl\u00e1n (n\u00e1vrh)","text":"Job Cron Popis products:import-full 10 4 * * * Full feed (zbo\u017e\u00ed) products:sync-availability */15 * * * * Dostupnosti delta"},{"location":"06-products/overview/#technicka-implementace-etapy","title":"Technick\u00e1 implementace (etapy)","text":"<ol> <li>Migrace DB tabulek (<code>products</code>, audit tabulky). \u2013 HOTOVO</li> <li>Parsovac\u00ed slu\u017eba + hash + full import command. \u2013 HOTOVO</li> <li>Availability sync command + audit. \u2013 HOTOVO (MVP)</li> <li>UI seznam + z\u00e1kladn\u00ed filtrov\u00e1n\u00ed. \u2013 HOTOVO (roz\u0161\u00ed\u0159en\u00ed filtr\u016f pending)</li> <li>Detail produktu + historie. \u2013 HOTOVO</li> <li>Integrace s Ops modulem (ud\u00e1losti, ru\u010dn\u00ed spu\u0161t\u011bn\u00ed). \u2013 HOTOVO (CLI; UI trigger pending)</li> <li>Permissions + cron z\u00e1pis do schedule dokumentace. \u2013 HOTOVO</li> <li>Optimalizace (indexy: external_id, ean, category_path prefix, availability_code) \u2013 PENDING</li> </ol>"},{"location":"06-products/overview/#edge-cases","title":"Edge Cases","text":"<ul> <li>Produkt odstran\u011bn z feedu: (MVP) ignorovat, dlouhodob\u011b p\u0159idat <code>is_active</code> flag p\u0159i neexistenci v dal\u0161\u00edch 7 dnech.</li> <li>Extreme ceny (0 nebo &gt; p\u0159im\u011b\u0159en\u00fd strop) \u2013 validovat a logovat.</li> <li>Duplicitn\u00ed external_id \u2192 log + skip druh\u00fd v\u00fdskyt.</li> </ul>"},{"location":"06-products/overview/#bezpecnost","title":"Bezpe\u010dnost","text":"<ul> <li>Extern\u00ed feed token je v URL \u2013 nepersistovat do DB (jen v env pokud bude pot\u0159eba). V logu maskovat.</li> <li>Ochrana proti DoS: limit velikosti sta\u017een\u00e9ho souboru (nap\u0159. 50MB guard).</li> </ul>"},{"location":"06-products/overview/#budouci-rozsireni","title":"Budouc\u00ed roz\u0161\u00ed\u0159en\u00ed","text":"<ul> <li>Napojen\u00ed na pricing engine (mar\u017ee, dynamika).</li> <li>Ulo\u017een\u00ed v\u00edce obr\u00e1zk\u016f (nov\u00e1 tabulka <code>product_images</code>).</li> <li>Fulltext index (Meilisearch / Elastic) pro pokro\u010dil\u00e9 vyhled\u00e1v\u00e1n\u00ed.</li> </ul> <p>Stav: Z\u00e1kladn\u00ed implementace dokon\u010dena; n\u00e1sleduj\u00ed optimalizace, UI akce a roz\u0161\u00ed\u0159en\u00ed filtr\u016f.</p>"},{"location":"07-runtime/jobs-catalog/","title":"Job Katalog","text":"<p>(Tento soubor bude \u010d\u00e1ste\u010dn\u011b generov\u00e1n/p\u0159episov\u00e1n skriptem.)</p> Job Queue Popis Pozn\u00e1mky"},{"location":"07-runtime/routes/","title":"Routy (placeholder)","text":"<p>Generov\u00e1no p\u0159\u00edkazem <code>php artisan docs:refresh</code>.</p>"},{"location":"07-runtime/schedule/","title":"Schedule (po\u010d\u00e1te\u010dn\u00ed \u2013 lze generovat pozd\u011bji)","text":"<p>Extrahovat z <code>App/Console/Kernel.php</code>.</p>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/","title":"ADR: Knowledge Subsystem","text":"<p>Status: Accepted Datum: 2025-09-04</p>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/#kontext","title":"Kontext","text":"<p>Pot\u0159ebujeme semantick\u00e9 vyhled\u00e1v\u00e1n\u00ed v intern\u00ed znalostn\u00ed b\u00e1zi (pozn\u00e1mky + nahran\u00e9 dokumenty). Po\u017eadavky: rychl\u00e1 indexace, mo\u017enost v\u00edce embedding provider\u016f, jednoduch\u00e9 maz\u00e1n\u00ed a reindex.</p>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/#rozhodnuti","title":"Rozhodnut\u00ed","text":"<p>Pou\u017eijeme Qdrant jako vektorov\u00fd store + vlastn\u00ed <code>EmbeddingsService</code> abstrakci nad poskytovateli (OpenAI, Gemini, OpenRouter, Local). Dokument se rozsek\u00e1 na chunky (heuristick\u00e1 d\u00e9lka ~1k token\u016f), ka\u017ed\u00fd chunk m\u00e1 embedding ulo\u017een v DB a v kolekci Qdrant. Metadata (provider, model, dimenze) ukl\u00e1d\u00e1me na \u00farovni dokumentu a chunku pro audit.</p>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/#dusledky","title":"D\u016fsledky","text":"<ul> <li>Snadn\u00e1 v\u00fdm\u011bna provideru bez migrace vektor\u016f (pokud zachov\u00e1 dimenzi) \u2013 p\u0159i zm\u011bn\u011b dimenze reindex.</li> <li>Qdrant kolekce centralizuje semantick\u00e9 dotazy.</li> <li>Z\u00e1vislost na extern\u00edm komponentu (Qdrant) \u2192 monitoring nutn\u00fd.</li> <li>Reindex p\u0159i zm\u011bn\u011b dimenze je n\u00e1kladn\u00fd (batch job).</li> </ul>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/#alternativy","title":"Alternativy","text":"<ol> <li>Pou\u017e\u00edt pouze lok\u00e1ln\u00ed embedding service + fulltext DB (nedosta\u010duj\u00edc\u00ed relevance).</li> <li>Elastic + dense_vector pole (komplexn\u011bj\u0161\u00ed spr\u00e1va, m\u00e9n\u011b feature pro ANN varianty).</li> </ol>"},{"location":"12-adr/ADR-20250904-knowledge-subsystem/#dalsi-kroky","title":"Dal\u0161\u00ed kroky","text":"<ul> <li>P\u0159idat metriky (po\u010dty chunk\u016f, latency embedding provider\u016f).</li> <li>Implementovat batch reindex command.</li> </ul>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/","title":"ADR-20250904: Adopce MkDocs + Material pro intern\u00ed dokumentaci","text":"<p>Status: Accepted</p>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#kontext","title":"Kontext","text":"<p>Pot\u0159eba udr\u017eovat konzistentn\u00ed, fulltextov\u011b prohled\u00e1vatelnou dokumentaci. P\u016fvodn\u011b pouze Markdown soubory bez strukturovan\u00e9 navigace.</p>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#rozhodnuti","title":"Rozhodnut\u00ed","text":"<p>Pou\u017e\u00edt MkDocs + Material theme. Uchovat zdroj v repozit\u00e1\u0159i (Markdown), generovat statick\u00fd web (CI / Docker). Generovan\u00e9 referen\u010dn\u00ed soubory v <code>docs/16-generated</code>.</p>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#alternativy","title":"Alternativy","text":"<ul> <li>Docusaurus: t\u011b\u017e\u0161\u00ed stack (React), nadbyte\u010dn\u00e9 pro \u010dist\u011b textov\u00e9 + n\u011bkolik diagram\u016f.</li> <li>GitBook SaaS: vendor lock-in, m\u00e9n\u011b kontroly nad CI.</li> <li>Jigsaw (PHP): men\u0161\u00ed ekosyst\u00e9m plugin\u016f.</li> </ul>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#dusledky","title":"D\u016fsledky","text":"<p>Pozitivn\u00ed: rychl\u00e1 navigace, verzov\u00e1n\u00ed, minim\u00e1ln\u00ed runtime n\u00e1klady (statika). Negativn\u00ed: nutn\u00fd build krok, z\u00e1vislost na Python image.</p>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#implementace","title":"Implementace","text":"<ol> <li>P\u0159id\u00e1n <code>mkdocs.yml</code>, struktura <code>docs/</code>.</li> <li>P\u0159\u00edkaz <code>docs:refresh</code> generuje routy, schedule, jobs, env matrix.</li> <li>Build skript <code>scripts/docs/build.sh</code> pro Docker pipeline.</li> </ol>"},{"location":"12-adr/ADR-20250904-mkdocs-adopce/#follow-up","title":"Follow-up","text":"<ul> <li>P\u0159idat gener\u00e1tor ERD.</li> <li>Zprovoznit CI job publikace.</li> <li>Doplnit ADR pro Ops modul a Knowledge architekturu.</li> </ul>"},{"location":"12-adr/ADR-20250904-ops-modul/","title":"ADR-20250904: Ops modul strategie z\u00e1loh","text":"<p>Status: Draft</p>"},{"location":"12-adr/ADR-20250904-ops-modul/#kontext","title":"Kontext","text":"<p>Pot\u0159eba standardizovat z\u00e1lohov\u00e1n\u00ed (DB dump + snapshot upload\u016f + verify restore) s auditn\u00ed stopou a dashboardem.</p>"},{"location":"12-adr/ADR-20250904-ops-modul/#rozhodnuti-navrh","title":"Rozhodnut\u00ed (n\u00e1vrh)","text":"<p>Centralizovat orchestrace do Ops modulu (Jobs + UI + tabulka <code>ops_activities</code>) m\u00edsto skript\u016f mimo aplikaci.</p>"},{"location":"12-adr/ADR-20250904-ops-modul/#alternativy","title":"Alternativy","text":"<ul> <li>Extern\u00ed Cron + shell skripty (ni\u017e\u0161\u00ed integrace, obt\u00ed\u017en\u00e9 auditov\u00e1n\u00ed)</li> <li>Specializovan\u00fd backup SaaS (n\u00e1klad, vendor lock)</li> </ul>"},{"location":"12-adr/ADR-20250904-ops-modul/#dusledky","title":"D\u016fsledky","text":"<ul> <li>Integrace s permission modelem, audit log.</li> <li>Snadn\u00e9 roz\u0161\u00ed\u0159en\u00ed o alerty.</li> <li>Aplikace mus\u00ed m\u00edt p\u0159\u00edstup k DB &amp; storage a n\u00e1stroj\u016fm (mysql, restic).</li> </ul>"},{"location":"12-adr/ADR-20250904-ops-modul/#implementace-kroky","title":"Implementace kroky","text":"<ol> <li>Jobs: RunDbBackupJob, RunStorageSnapshotJob, RunVerifyRestoreJob.</li> <li>Audit persist do <code>ops_activities</code>.</li> <li>Cron schedule + EvaluateBackupHealthJob.</li> <li>UI dashboard + kontextov\u00e1 n\u00e1pov\u011bda.</li> </ol>"},{"location":"12-adr/ADR-20250904-ops-modul/#otevrene-otazky","title":"Otev\u0159en\u00e9 ot\u00e1zky","text":"<ul> <li>Git tagging sidecar z\u016fst\u00e1v\u00e1 neimplementov\u00e1no.</li> <li>Verify restore frekvence vs. velikost DB.</li> </ul>"},{"location":"12-adr/ADR-20250904-ops-modul/#follow-up","title":"Follow-up","text":"<ul> <li>P\u0159idat metriky Prometheus endpoint.</li> <li>ADR update po p\u0159ijet\u00ed.</li> </ul>"},{"location":"12-adr/ADR-20250904-permissions-model/","title":"ADR: Permissions Model","text":"<p>Status: Accepted Datum: 2025-09-04</p>"},{"location":"12-adr/ADR-20250904-permissions-model/#kontext","title":"Kontext","text":"<p>Aplikace pot\u0159ebuje jemnozrnn\u00e1 opr\u00e1vn\u011bn\u00ed nad operacemi (\u010dten\u00ed/z\u00e1pis entit, provozn\u00ed akce). Pou\u017eit je bal\u00edk spatie/laravel-permission. Aktu\u00e1ln\u011b neexistuje formalizovan\u00fd seznam rol\u00ed.</p>"},{"location":"12-adr/ADR-20250904-permissions-model/#rozhodnuti","title":"Rozhodnut\u00ed","text":"<p>Pou\u017eijeme dynamick\u00e9 na\u010d\u00edt\u00e1n\u00ed opr\u00e1vn\u011bn\u00ed z DB a generov\u00e1n\u00ed p\u0159ehledu (<code>docs:refresh</code> -&gt; <code>permissions.md</code>). Role budou definov\u00e1ny v migrac\u00edch / seed skriptech (budouc\u00ed) a dokumentace se regeneruje. U\u017eivatel\u00e9 maj\u00ed nav\u00edc boolean <code>is_admin</code> pro full bypass.</p>"},{"location":"12-adr/ADR-20250904-permissions-model/#dusledky","title":"D\u016fsledky","text":"<ul> <li>Rychl\u00e1 \u00fadr\u017eba (UI / seed) bez pot\u0159eby m\u011bnit k\u00f3d.</li> <li>Dokumentace opr\u00e1vn\u011bn\u00ed je v\u017edy po b\u011bhu gener\u00e1toru up-to-date.</li> <li>Pot\u0159eba runtime DB p\u0159i generov\u00e1n\u00ed listu (fallback zpr\u00e1va pokud nen\u00ed dostupn\u00e9).</li> </ul>"},{"location":"12-adr/ADR-20250904-permissions-model/#alternativy","title":"Alternativy","text":"<ol> <li>Hardcodovat policy map v k\u00f3du (m\u00e9n\u011b flexibiln\u00ed).</li> <li>Pouze <code>is_admin</code> + hrub\u00e9 ACL (nedosta\u010duj\u00edc\u00ed pro audit/least-privilege).</li> </ol>"},{"location":"12-adr/ADR-20250904-permissions-model/#dalsi-kroky","title":"Dal\u0161\u00ed kroky","text":"<ul> <li>Definovat baseline role (nap\u0159. <code>sales_rep</code>, <code>sales_manager</code>, <code>ops_admin</code>).</li> <li>P\u0159idat test ov\u011b\u0159uj\u00edc\u00ed \u017ee ka\u017ed\u00e9 permission m\u00e1 p\u0159i\u0159azenou alespo\u0148 jednu roli (po zaveden\u00ed rol\u00ed).</li> </ul>"},{"location":"13-runbooks/ops-runbook/","title":"Ops Runbook (Z\u00e1lohy &amp; Obnova)","text":"<p>P\u0159esunuto z <code>RUNBOOK_OPS.md</code> (origin\u00e1l zachov\u00e1n pro diff). Aktualizace prov\u00e1d\u011bt zde.</p>"},{"location":"13-runbooks/ops-runbook/#1-rychly-stav-checklist","title":"1. Rychl\u00fd stav (Checklist)","text":"Kontrola P\u0159\u00edkaz / Akce O\u010dek\u00e1van\u00fd v\u00fdsledek Posledn\u00ed DB dump st\u00e1rnut\u00ed Web: Ops Dashboard / DB Z\u00e1loha Status OK / St\u00e1\u0159\u00ed &lt; prah STALE Posledn\u00ed snapshot uploads Ops Dashboard / Snapshot Status OK Verify restore fresh Ops Dashboard / Verify Status OK (v\u011bk &lt; verify_overdue_hours) Metriky dostupn\u00e9 GET /crm/ops/metrics HTTP 200 + prom text Posledn\u00ed alert Log <code>storage/logs/ops.log</code> \u017d\u00e1dn\u00e9 nov\u00e9 FAIL alerty"},{"location":"13-runbooks/ops-runbook/#2-manualni-spusteni","title":"2. Manu\u00e1ln\u00ed spu\u0161t\u011bn\u00ed","text":"Akce UI CLI DB Backup Tla\u010d\u00edtko \"Spustit DB Backup\" (alias do budoucna) Snapshot Upload\u016f \"Snapshot Upload\u016f\" (stejn\u00e9) Verify Restore \"Verify Restore\" (stejn\u00e9) Report \"Report\" pl\u00e1novan\u00e9"},{"location":"13-runbooks/ops-runbook/#3-obnova-disaster-recovery-scenar-db-korupce","title":"3. Obnova (Disaster Recovery) \u2013 sc\u00e9n\u00e1\u0159 DB korupce","text":"<ol> <li>Identifikuj posledn\u00ed validn\u00ed dump: <code>/srv/backups/crm/db/full-YYYYmmdd-HHMM.sql.gz</code> + ov\u011b\u0159 <code>sha256sum -c full-*.sql.gz.sha256</code>.</li> <li>P\u0159iprav pr\u00e1zdnou n\u00e1hradn\u00ed DB.</li> <li>Import: <pre><code>gunzip -c full-YYYYmmdd-HHMM.sql.gz | mysql -h &lt;host&gt; -u &lt;user&gt; -p &lt;dbname&gt;\n</code></pre></li> <li>Ov\u011b\u0159en\u00ed: tabulky vs. verify log, kritick\u00e9 tabulky existuj\u00ed.</li> <li>\u00daprava <code>.env</code> DB host a redeploy.</li> <li>Spus\u0165 Verify Restore ru\u010dn\u011b.</li> </ol>"},{"location":"13-runbooks/ops-runbook/#4-castecna-obnova-nahranych-souboru","title":"4. \u010c\u00e1ste\u010dn\u00e1 obnova nahran\u00fdch soubor\u016f","text":"<ol> <li>List snapshot\u016f: <pre><code>RESTIC_PASSWORD=$RESTIC_PASSWORD restic -r $RESTIC_REPO snapshots --tag uploads\n</code></pre></li> <li>Obnova: <pre><code>RESTIC_PASSWORD=$RESTIC_PASSWORD restic -r $RESTIC_REPO restore &lt;snapshot-id&gt; --target /tmp/restore_uploads\n</code></pre></li> <li>Selektivn\u00ed kopie zp\u011bt.</li> </ol>"},{"location":"13-runbooks/ops-runbook/#5-verify-restore-interni-workflow","title":"5. Verify Restore intern\u00ed workflow","text":"<p>Vybere dump, import, validace tabulek, log, cleanup, alert p\u0159i selh\u00e1n\u00ed.</p>"},{"location":"13-runbooks/ops-runbook/#6-migrace-legacy-zaloh","title":"6. Migrace legacy z\u00e1loh","text":"<p>Such\u00fd b\u011bh: <pre><code>php artisan ops:backups-migrate --dry-run\n</code></pre> Ostr\u00e1 migrace: <pre><code>php artisan ops:backups-migrate\n</code></pre></p>"},{"location":"13-runbooks/ops-runbook/#7-alerting-stavy","title":"7. Alerting stavy","text":"Alert Spou\u0161t\u011b\u010d Akce DB dump STALE/FAIL EvaluateBackupHealthJob Spustit dump / ov\u011b\u0159 cron Uploads snapshot STALE EvaluateBackupHealthJob Spustit snapshot job Verify restore overdue EvaluateBackupHealthJob Spustit verify Verify restore FAILED RunVerifyRestoreJob Analyzovat log"},{"location":"13-runbooks/ops-runbook/#8-slaba-mista-mesicni-checklist","title":"8. Slab\u00e1 m\u00edsta / m\u011bs\u00ed\u010dn\u00ed checklist","text":"<ul> <li>N\u00e1hodn\u00e1 validace dumpu.</li> <li>Trend velikosti dump\u016f.</li> <li>Restic <code>check</code>.</li> </ul>"},{"location":"13-runbooks/ops-runbook/#9-env-promenne-ops","title":"9. Env prom\u011bnn\u00e9 (ops)","text":"Var V\u00fdznam OPS_DB_DUMP_STALE_MIN Prah st\u00e1rnut\u00ed dumpu OPS_DB_DUMP_FAIL_MIN Prah FAIL OPS_SNAPSHOT_STALE_MIN Prah snapshotu OPS_VERIFY_OVERDUE_HOURS Prah verify (h) OPS_BACKUP_BASE Root adres\u00e1\u0159 OPS_VERIFY_AUTO Povolit weekly verify"},{"location":"13-runbooks/ops-runbook/#10-rychle-debug-prikazy","title":"10. Rychl\u00e9 debug p\u0159\u00edkazy","text":"<pre><code>ls -1t ${OPS_BACKUP_BASE:-/srv/backups/crm}/db/full-*.sql.gz 2&gt;/dev/null | head -1\nfind ${OPS_BACKUP_BASE:-/srv/backups/crm}/snapshots -type f -name 'snapshot-*.txt' -printf '%T@ %f\\n' 2&gt;/dev/null | sort -nr | head -1\nfind ${OPS_BACKUP_BASE:-/srv/backups/crm}/verify -type f -name 'verify-*.log' -printf '%T@ %f\\n' 2&gt;/dev/null | sort -nr | head -1 | cut -d' ' -f2-\n</code></pre>"},{"location":"13-runbooks/ops-runbook/#11-budouci-rozsireni","title":"11. Budouc\u00ed roz\u0161\u00ed\u0159en\u00ed","text":"<ul> <li>Sidecar git runner.</li> <li>Binlog shipping.</li> <li>Automatizovan\u00fd DR drill.</li> </ul> <p>Aktualizace p\u0159i ka\u017ed\u00e9 zm\u011bn\u011b workflow.</p>"},{"location":"14-checklists/pr-checklist/","title":"PR Checklist","text":"<ul> <li>[ ] Testy pro zm\u011bn\u011bn\u00e9 kritick\u00e9 \u010d\u00e1sti</li> <li>[ ] Aktualizovan\u00e9 modulov\u00e9 dokumenty</li> <li>[ ] \u00daprava .env.example (pokud nov\u00e1 prom\u011bnn\u00e1)</li> <li>[ ] Spu\u0161t\u011bno <code>php artisan docs:refresh</code> a commitnuty zm\u011bny <code>docs/16-generated</code></li> <li>[ ] Zv\u00e1\u017eeno / vytvo\u0159eno ADR</li> </ul>"},{"location":"15-templates/adr-template/","title":"ADR-YYYYMMDD:  <p>Status: Proposed</p>","text":""},{"location":"15-templates/adr-template/#kontext","title":"Kontext","text":""},{"location":"15-templates/adr-template/#rozhodnuti","title":"Rozhodnut\u00ed","text":""},{"location":"15-templates/adr-template/#alternativy","title":"Alternativy","text":""},{"location":"15-templates/adr-template/#dusledky","title":"D\u016fsledky","text":""},{"location":"15-templates/adr-template/#implementace","title":"Implementace","text":""},{"location":"15-templates/module/","title":"<p>Status: draft Odpov\u011bdnost:","text":""},{"location":"15-templates/module/#ucel","title":"\u00da\u010del","text":""},{"location":"15-templates/module/#komponenty","title":"Komponenty","text":""},{"location":"15-templates/module/#datove-entity","title":"Datov\u00e9 entity","text":""},{"location":"15-templates/module/#flow","title":"Flow","text":""},{"location":"15-templates/module/#konfigurace-env","title":"Konfigurace / ENV","text":""},{"location":"15-templates/module/#failure-modes","title":"Failure Modes","text":""},{"location":"15-templates/module/#alerting-monitoring","title":"Alerting / Monitoring","text":""},{"location":"15-templates/module/#zavislosti","title":"Z\u00e1vislosti","text":""},{"location":"15-templates/module/#rozsireni-backlog","title":"Roz\u0161\u00ed\u0159en\u00ed / Backlog","text":""},{"location":"16-generated/backup-report-latest/","title":"Backup Report (latest)","text":"<p>Adres\u00e1\u0159 report\u016f nenalezen. Spus\u0165 <code>GenerateBackupReportJob</code>.</p>"},{"location":"16-generated/db-schema/","title":"DB Schema (generov\u00e1no)","text":"<p>Nepoda\u0159ilo se p\u0159ipojit k DB: <code>SQLSTATE[HY000] [2002] php_network_getaddresses: getaddrinfo for crm_esl_mysql failed: Temporary failure in name resolution</code></p>"},{"location":"16-generated/env-matrix/","title":"ENV Matrix (generov\u00e1no)","text":"Var V .env.example Pou\u017eito v config AC_API_TOKEN Ano AC_BASE_URL Ano APP_DEBUG Ano Ano APP_ENV Ano Ano APP_FAKER_LOCALE Ano APP_FALLBACK_LOCALE Ano APP_KEY Ano Ano APP_LOCALE Ano APP_MAINTENANCE_DRIVER Ano APP_MAINTENANCE_STORE Ano APP_NAME Ano Ano APP_PREVIOUS_KEYS Ano APP_TIMEZONE Ano APP_URL Ano Ano AUTH_GUARD Ano AUTH_MODEL Ano AUTH_PASSWORD_BROKER Ano AUTH_PASSWORD_RESET_TOKEN_TABLE Ano AUTH_PASSWORD_TIMEOUT Ano AWS_ACCESS_KEY_ID Ano AWS_BUCKET Ano AWS_DEFAULT_REGION Ano AWS_ENDPOINT Ano AWS_SECRET_ACCESS_KEY Ano AWS_URL Ano AWS_USE_PATH_STYLE_ENDPOINT Ano BACKUP_ARCHIVE_PASSWORD Ano BACKUP_CLEANUP_ENABLED Ano BACKUP_DB_CONNECTION Ano BACKUP_DB_PASSWORD Ano BACKUP_DB_USERNAME Ano BACKUP_SCHEDULE_CRON Ano BACKUP_SCHEDULE_ENABLED Ano BEANSTALKD_QUEUE Ano BEANSTALKD_QUEUE_HOST Ano BEANSTALKD_QUEUE_RETRY_AFTER Ano CACHE_PREFIX Ano CACHE_STORE Ano DB_CACHE_CONNECTION Ano DB_CACHE_LOCK_CONNECTION Ano DB_CACHE_LOCK_TABLE Ano DB_CACHE_TABLE Ano DB_CHARSET Ano DB_COLLATION Ano DB_CONNECTION Ano Ano DB_DATABASE Ano Ano DB_ENCRYPT Ano DB_FOREIGN_KEYS Ano DB_HOST Ano Ano DB_PASSWORD Ano Ano DB_PORT Ano Ano DB_QUEUE Ano DB_QUEUE_CONNECTION Ano DB_QUEUE_RETRY_AFTER Ano DB_QUEUE_TABLE Ano DB_SOCKET Ano DB_TRUST_SERVER_CERTIFICATE Ano DB_URL Ano DB_USERNAME Ano Ano DYNAMODB_CACHE_TABLE Ano DYNAMODB_ENDPOINT Ano EMBEDDINGS_DIMENSION Ano EMBEDDINGS_LOCAL_URL Ano EMBEDDINGS_MODEL Ano EMBEDDINGS_PROVIDER Ano FILESYSTEM_DISK Ano GOOGLE_GEMINI_API_KEY Ano LOG_CHANNEL Ano LOG_DAILY_DAYS Ano LOG_DEPRECATIONS_CHANNEL Ano LOG_DEPRECATIONS_TRACE Ano LOG_LEVEL Ano LOG_PAPERTRAIL_HANDLER Ano LOG_SLACK_EMOJI Ano LOG_SLACK_USERNAME Ano LOG_SLACK_WEBHOOK_URL Ano LOG_STACK Ano LOG_STDERR_FORMATTER Ano LOG_SYSLOG_FACILITY Ano LOG_TOOLS_LEVEL Ano MAIL_EHLO_DOMAIN Ano MAIL_FROM_ADDRESS Ano MAIL_FROM_NAME Ano MAIL_HOST Ano MAIL_LOG_CHANNEL Ano MAIL_MAILER Ano MAIL_PASSWORD Ano MAIL_PORT Ano MAIL_SCHEME Ano MAIL_SENDMAIL_PATH Ano MAIL_URL Ano MAIL_USERNAME Ano MEMCACHED_HOST Ano MEMCACHED_PASSWORD Ano MEMCACHED_PERSISTENT_ID Ano MEMCACHED_PORT Ano MEMCACHED_USERNAME Ano MYSQL_ATTR_SSL_CA Ano OPENAI_API_KEY Ano OPENROUTER_API_KEY Ano OPENROUTER_APP_NAME Ano OPENROUTER_SITE_URL Ano OPS_ALERTS_ENABLED Ano OPS_DB_DUMP_FAIL_MIN Ano OPS_DB_DUMP_STALE_MIN Ano OPS_SNAPSHOT_STALE_MIN Ano OPS_VERIFY_OVERDUE_HOURS Ano PAPERTRAIL_PORT Ano PAPERTRAIL_URL Ano POSTMARK_MESSAGE_STREAM_ID Ano POSTMARK_TOKEN Ano QDRANT_API_KEY Ano QDRANT_COLLECTION Ano QDRANT_ENABLED Ano QDRANT_TIMEOUT Ano QDRANT_URL Ano QUEUE_CONNECTION Ano QUEUE_FAILED_DRIVER Ano REDIS_CACHE_CONNECTION Ano REDIS_CACHE_DB Ano REDIS_CACHE_LOCK_CONNECTION Ano REDIS_CLIENT Ano REDIS_CLUSTER Ano REDIS_DB Ano REDIS_HOST Ano REDIS_PASSWORD Ano REDIS_PORT Ano REDIS_PREFIX Ano REDIS_QUEUE Ano REDIS_QUEUE_CONNECTION Ano REDIS_QUEUE_RETRY_AFTER Ano REDIS_URL Ano REDIS_USERNAME Ano RESEND_KEY Ano SESSION_CONNECTION Ano SESSION_DOMAIN Ano SESSION_DRIVER Ano Ano SESSION_ENCRYPT Ano SESSION_EXPIRE_ON_CLOSE Ano SESSION_HTTP_ONLY Ano SESSION_LIFETIME Ano SESSION_PARTITIONED_COOKIE Ano SESSION_PATH Ano SESSION_SAME_SITE Ano SESSION_SECURE_COOKIE Ano SESSION_STORE Ano SESSION_TABLE Ano SLACK_BOT_USER_DEFAULT_CHANNEL Ano SLACK_BOT_USER_OAUTH_TOKEN Ano SQS_PREFIX Ano SQS_QUEUE Ano SQS_SUFFIX Ano"},{"location":"16-generated/erd/","title":"ERD (generov\u00e1no, heuristika ze source k\u00f3du)","text":"<pre><code>erDiagram\n  KNOWLEDGECHUNK }o--|| KNOWLEDGEDOCUMENT : belongs_to\n  LEAD }o--|| USER : belongs_to\n  LEAD }o--|| OPPORTUNITY : belongs_to\n  LEAD ||--o{ TASK : morph_many\n  TASK }o--|| USER : belongs_to\n  TASK }o--|| PROJECT : belongs_to\n  TASK }o..o{ POLYMORPHIC : morph_to\n  SALESORDER }o--|| COMPANY : belongs_to\n  SALESORDER }o--|| CONTACT : belongs_to\n  SALESORDER ||--o{ SALESORDERITEM : has_many\n  PRODUCT ||--o{ PRODUCTPRICECHANGE : has_many\n  PRODUCT ||--o{ PRODUCTAVAILABILITYCHANGE : has_many\n  OPPORTUNITY }o--|| CONTACT : belongs_to\n  OPPORTUNITY }o--|| COMPANY : belongs_to\n  OPPORTUNITY }o--|| USER : belongs_to\n  COMPANY }o--|| USER : belongs_to\n  COMPANY ||--o{ CONTACT : has_many\n  COMPANY ||--o{ OPPORTUNITY : has_many\n  COMPANY ||--o{ PROJECT : has_many\n  COMPANY ||--o{ SALESORDER : has_many\n  COMPANY ||--o{ TASK : morph_many\n  CONTACT }o--|| COMPANY : belongs_to\n  CONTACT }o--|| USER : belongs_to\n  CONTACT ||--o{ OPPORTUNITY : has_many\n  CONTACT ||--o{ PROJECT : has_many\n  CONTACT ||--o{ SALESORDER : has_many\n  CONTACT ||--o{ CONTACTCUSTOMFIELD : has_many\n  CONTACT ||--o{ CONTACTIDENTITY : has_many\n  CONTACT ||--o{ TASK : morph_many\n  PRODUCTGROUP ||--o{ PRODUCTGROUP : has_many\n  CONTACTCUSTOMFIELD }o--|| CONTACT : belongs_to\n  PRODUCTPRICECHANGE }o--|| PRODUCT : belongs_to\n  PROJECT }o--|| COMPANY : belongs_to\n  PROJECT }o--|| CONTACT : belongs_to\n  PROJECT }o--|| USER : belongs_to\n  PROJECT ||--o{ TASK : has_many\n  DEAL }o--|| OPPORTUNITY : belongs_to\n  DEAL }o--|| CONTACT : belongs_to\n  DEAL }o--|| USER : belongs_to\n  PRODUCTAVAILABILITYCHANGE }o--|| PRODUCT : belongs_to\n  CONTACTIDENTITY }o--|| CONTACT : belongs_to\n  KNOWLEDGENOTE }o--|| USER : belongs_to\n  KNOWLEDGEDOCUMENT }o--|| USER : belongs_to\n  KNOWLEDGEDOCUMENT ||--o{ KNOWLEDGECHUNK : has_many\n  SALESORDERITEM }o--|| SALESORDER : belongs_to\n  KNOWLEDGECHUNK {\n    string document_id\n    string chunk_index\n    string text\n    array meta\n    array embedding\n    string embedding_dim\n    datetime embedded_at\n    string qdrant_point_id\n    string chunk_hash\n  }\n  LEAD {\n    string company_name\n    string contact_name\n    string email\n    string phone\n    string source\n    string status\n    integer score\n    decimal:2 estimated_value\n    string notes\n    string assigned_to\n    string created_by\n    datetime last_activity_at\n    datetime converted_at\n    string converted_to_opportunity_id\n  }\n  TASK {\n    string title\n    string description\n    string type\n    string status\n    string priority\n    string project_id\n    datetime due_date\n    datetime completed_at\n    string assigned_to\n    string created_by\n    string taskable_type\n    string taskable_id\n    string notes\n  }\n  SALESORDER {\n    string external_order_no\n    string company_id\n    string contact_id\n    date order_date\n    string author\n    decimal:2 total_amount\n    string source\n    string notes\n  }\n  PRODUCT {\n    string external_id\n    string group_id\n    string name\n    string description\n    string price_vat_cents\n    string currency\n    string manufacturer\n    string ean\n    string category_path\n    string category_hash\n    string url\n    string image_url\n    string availability_code\n    string availability_text\n    string stock_quantity\n    datetime availability_synced_at\n    string hash_payload\n    datetime first_imported_at\n    datetime last_synced_at\n    datetime last_price_changed_at\n    datetime last_availability_changed_at\n  }\n  OPPORTUNITY {\n    string name\n    string description\n    decimal:2 value\n    integer probability\n    string stage\n    date expected_close_date\n    string contact_id\n    string company_id\n    string assigned_to\n    string created_by\n    datetime closed_at\n    string close_reason\n    string close_notes\n  }\n  COMPANY {\n    string name\n    string industry\n    string size\n    string status\n    string website\n    string phone\n    string email\n    string address\n    string city\n    string country\n    string notes\n    decimal:2 annual_revenue\n    string employee_count\n    string created_by\n  }\n  ACSYNCRUN {\n    datetime started_at\n    datetime finished_at\n    string limit\n    string offset\n    string created\n    string updated\n    string skipped\n    string skipped_unchanged\n    string errors\n    array sample_created_ids\n    array sample_updated_ids\n    string message\n  }\n  CONTACT {\n    string company_id\n    string first_name\n    string last_name\n    string email\n    string normalized_email\n    string phone\n    string normalized_phone\n    string mobile\n    string position\n    string department\n    string status\n    string marketing_status\n    date birthday\n    string address\n    string city\n    string country\n    string notes\n    array social_links\n    string preferred_contact\n    string created_by\n    datetime last_contacted_at\n    string ac_id\n    string ac_hash\n    datetime ac_updated_at\n    string legacy_external_id\n  }\n  SYSTEMSETTING {\n    string key\n    string value\n  }\n  PRODUCTGROUP {\n    string code\n    string name\n    string name_alt\n    string eshop_url\n    string parent_id\n  }\n  APPLINK {\n    string name\n    string url\n    string icon_url\n    integer position\n    boolean is_active\n  }\n  USER {\n    string name\n    string email\n    string password\n    string is_admin\n  }\n  CONTACTCUSTOMFIELD {\n    string contact_id\n    string key\n    string value\n    string type\n    string ac_field_id\n  }\n  OPSACTIVITY {\n    string type\n    string status\n    string user_id\n    datetime started_at\n    datetime finished_at\n    string duration_ms\n    array meta\n    string log_excerpt\n  }\n  CHATTOOLAUDIT {\n    string user_id\n    string conversation_id\n    string tool\n    string intent\n    array payload\n    array result_meta\n    string duration_ms\n  }\n  TAG {\n    string name\n    string source\n  }\n  PRODUCTPRICECHANGE {\n    string product_id\n    string old_price_cents\n    string new_price_cents\n    datetime changed_at\n  }\n  PROJECT {\n    string name\n    string description\n    string status\n    date start_date\n    date due_date\n    string company_id\n    string contact_id\n    string assigned_to\n    string created_by\n  }\n  DEAL {\n    string opportunity_id\n    string name\n    decimal:2 amount\n    date close_date\n    string status\n    string terms\n    string notes\n    string signed_by_contact_id\n    datetime signed_at\n    string created_by\n  }\n  PRODUCTAVAILABILITYCHANGE {\n    string product_id\n    string old_code\n    string new_code\n    string old_stock_qty\n    string new_stock_qty\n    datetime changed_at\n  }\n  CONTACTIDENTITY {\n    string contact_id\n    string source\n    string external_id\n    string external_hash\n  }\n  KNOWLEDGENOTE {\n    string user_id\n    string title\n    string content\n    array tags\n    string visibility\n  }\n  KNOWLEDGEDOCUMENT {\n    string user_id\n    string title\n    string source_type\n    string mime\n    string size\n    string path\n    string status\n    string visibility\n    array tags\n    string error\n    datetime vectorized_at\n    string embedding_provider\n    string embedding_model\n    string embedding_dim\n    string vectors_count\n    string last_index_duration_ms\n  }\n  SALESORDERITEM {\n    string sales_order_id\n    string sku\n    string alt_code\n    string name\n    string name_alt\n    decimal:3 qty\n    decimal:4 unit_price\n    decimal:4 unit_price_disc\n    decimal:4 cost\n    decimal:4 cost_disc\n    decimal:2 discounts_card\n    decimal:2 discounts_group\n    string product_group\n    string eshop_category_url\n    string tax_code\n    string currency\n  }\n</code></pre>"},{"location":"16-generated/jobs/","title":"Queue Job Katalog (generov\u00e1no)","text":"T\u0159\u00edda Queue Popis Jobs\\AcEnrichContactJob imports Jobs\\ActiveCampaignSyncJob default * Periodick\u00e1 inkrement\u00e1ln\u00ed synchronizace kontakt\u016f z ActiveCampaign. Jobs\\ImportActiveCampaignAll default Jobs\\IndexKnowledgeDocumentJob default * Indexuje jeden KnowledgeDocument do Qdrant: Jobs\\Ops\\CreateGitTagJob ops Jobs\\Ops\\EvaluateBackupHealthJob default Jobs\\Ops\\GenerateBackupReportJob ops Jobs\\Ops\\RunDbBackupJob ops Jobs\\Ops\\RunStorageSnapshotJob ops Jobs\\Ops\\RunVerifyRestoreJob ops"},{"location":"16-generated/model-fields/","title":"Model Fields (generov\u00e1no)","text":"<p>Heuristick\u00fd v\u00fdpis na z\u00e1klad\u011b $fillable a $casts. Skute\u010dn\u00e9 DB typy ov\u011b\u0159te migracemi.</p>"},{"location":"16-generated/model-fields/#knowledgechunk","title":"KnowledgeChunk","text":"Pole Typ (cast) document_id chunk_index text meta array embedding array embedding_dim embedded_at datetime qdrant_point_id chunk_hash"},{"location":"16-generated/model-fields/#lead","title":"Lead","text":"Pole Typ (cast) company_name contact_name email phone source status score integer estimated_value decimal:2 notes assigned_to created_by last_activity_at datetime converted_at datetime converted_to_opportunity_id"},{"location":"16-generated/model-fields/#task","title":"Task","text":"Pole Typ (cast) title description type status priority project_id due_date datetime completed_at datetime assigned_to created_by taskable_type taskable_id notes"},{"location":"16-generated/model-fields/#salesorder","title":"SalesOrder","text":"Pole Typ (cast) external_order_no company_id contact_id order_date date author total_amount decimal:2 source notes"},{"location":"16-generated/model-fields/#product","title":"Product","text":"Pole Typ (cast) external_id group_id name description price_vat_cents currency manufacturer ean category_path category_hash url image_url availability_code availability_text stock_quantity availability_synced_at datetime hash_payload first_imported_at datetime last_synced_at datetime last_price_changed_at datetime last_availability_changed_at datetime"},{"location":"16-generated/model-fields/#opportunity","title":"Opportunity","text":"Pole Typ (cast) name description value decimal:2 probability integer stage expected_close_date date contact_id company_id assigned_to created_by closed_at datetime close_reason close_notes"},{"location":"16-generated/model-fields/#company","title":"Company","text":"Pole Typ (cast) name industry size status website phone email address city country notes annual_revenue decimal:2 employee_count created_by"},{"location":"16-generated/model-fields/#acsyncrun","title":"AcSyncRun","text":"Pole Typ (cast) started_at datetime finished_at datetime limit offset created updated skipped skipped_unchanged errors sample_created_ids array sample_updated_ids array message"},{"location":"16-generated/model-fields/#contact","title":"Contact","text":"Pole Typ (cast) company_id first_name last_name email normalized_email phone normalized_phone mobile position department status marketing_status birthday date address city country notes social_links array preferred_contact created_by last_contacted_at datetime ac_id ac_hash ac_updated_at datetime legacy_external_id"},{"location":"16-generated/model-fields/#systemsetting","title":"SystemSetting","text":"Pole Typ (cast) key value"},{"location":"16-generated/model-fields/#productgroup","title":"ProductGroup","text":"Pole Typ (cast) code name name_alt eshop_url parent_id"},{"location":"16-generated/model-fields/#applink","title":"AppLink","text":"Pole Typ (cast) name url icon_url position integer is_active boolean"},{"location":"16-generated/model-fields/#user","title":"User","text":"Pole Typ (cast) name email password is_admin"},{"location":"16-generated/model-fields/#contactcustomfield","title":"ContactCustomField","text":"Pole Typ (cast) contact_id key value type ac_field_id"},{"location":"16-generated/model-fields/#opsactivity","title":"OpsActivity","text":"Pole Typ (cast) type status user_id started_at datetime finished_at datetime duration_ms meta array log_excerpt"},{"location":"16-generated/model-fields/#chattoolaudit","title":"ChatToolAudit","text":"Pole Typ (cast) user_id conversation_id tool intent payload array result_meta array duration_ms"},{"location":"16-generated/model-fields/#tag","title":"Tag","text":"Pole Typ (cast) name source"},{"location":"16-generated/model-fields/#productpricechange","title":"ProductPriceChange","text":"Pole Typ (cast) product_id old_price_cents new_price_cents changed_at datetime"},{"location":"16-generated/model-fields/#project","title":"Project","text":"Pole Typ (cast) name description status start_date date due_date date company_id contact_id assigned_to created_by"},{"location":"16-generated/model-fields/#deal","title":"Deal","text":"Pole Typ (cast) opportunity_id name amount decimal:2 close_date date status terms notes signed_by_contact_id signed_at datetime created_by"},{"location":"16-generated/model-fields/#productavailabilitychange","title":"ProductAvailabilityChange","text":"Pole Typ (cast) product_id old_code new_code old_stock_qty new_stock_qty changed_at datetime"},{"location":"16-generated/model-fields/#contactidentity","title":"ContactIdentity","text":"Pole Typ (cast) contact_id source external_id external_hash"},{"location":"16-generated/model-fields/#knowledgenote","title":"KnowledgeNote","text":"Pole Typ (cast) user_id title content tags array visibility"},{"location":"16-generated/model-fields/#knowledgedocument","title":"KnowledgeDocument","text":"Pole Typ (cast) user_id title source_type mime size path status visibility tags array error vectorized_at datetime embedding_provider embedding_model embedding_dim vectors_count last_index_duration_ms"},{"location":"16-generated/model-fields/#salesorderitem","title":"SalesOrderItem","text":"Pole Typ (cast) sales_order_id sku alt_code name name_alt qty decimal:3 unit_price decimal:4 unit_price_disc decimal:4 cost decimal:4 cost_disc decimal:4 discounts_card decimal:2 discounts_group decimal:2 product_group eshop_category_url tax_code currency"},{"location":"16-generated/navigation/","title":"Navigace (generov\u00e1no)","text":"<p>Automatick\u00fd p\u0159ehled polo\u017eek CRM menu (GET routy s prefixem <code>/crm</code>). Popisy lze doplnit v <code>docs/_meta/menu.php</code>.</p>"},{"location":"16-generated/navigation/#dashboard","title":"Dashboard","text":"<p>V\u00fdchoz\u00ed p\u0159ehled (widgety, stav synchronizac\u00ed, kl\u00ed\u010dov\u00e9 KPI).</p> Cesta Route name Popis <code>/</code> crm.dashboard Hlavn\u00ed p\u0159ehled a rychl\u00e9 akce."},{"location":"16-generated/navigation/#firmy","title":"Firmy","text":"<p>Evidence firem (profil, revenue, pr\u016fmysl) \u2013 vstup do detailu vztah\u016f.</p> Cesta Route name Popis <code>/companies</code> companies.index (popis chyb\u00ed) <code>/companies/create</code> companies.create (popis chyb\u00ed) <code>/companies/{company}</code> companies.show (popis chyb\u00ed) <code>/companies/{company}/edit</code> companies.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#kontakty","title":"Kontakty","text":"<p>Evidence osob nav\u00e1zan\u00fdch na firmy, segmentace a marketing status.</p> Cesta Route name Popis <code>/contacts</code> contacts.index (popis chyb\u00ed) <code>/contacts/create</code> contacts.create (popis chyb\u00ed) <code>/contacts/{contact}</code> contacts.show (popis chyb\u00ed) <code>/contacts/{contact}/edit</code> contacts.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#leady","title":"Leady","text":"<p>Potenci\u00e1ln\u00ed p\u0159\u00edle\u017eitosti p\u0159ed kvalifikac\u00ed (kanban/pipeline varianty).</p> Cesta Route name Popis <code>/leads</code> leads.index (popis chyb\u00ed) <code>/leads/create</code> leads.create (popis chyb\u00ed) <code>/leads/{lead}</code> leads.show (popis chyb\u00ed) <code>/leads/{lead}/edit</code> leads.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#prilezitosti","title":"P\u0159\u00edle\u017eitosti","text":"<p>Obchodn\u00ed p\u0159\u00edle\u017eitosti s f\u00e1zemi, pravd\u011bpodobnost\u00ed a predikc\u00ed closingu.</p> Cesta Route name Popis <code>/opportunities</code> opportunities.index (popis chyb\u00ed) <code>/opportunities/create</code> opportunities.create (popis chyb\u00ed) <code>/opportunities/{opportunity}</code> opportunities.show (popis chyb\u00ed) <code>/opportunities/{opportunity}/edit</code> opportunities.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#ukoly","title":"\u00dakoly","text":"<p>Operativn\u00ed pr\u00e1ce nav\u00e1zan\u00e1 na entity (polymorfn\u00ed taskable).</p> Cesta Route name Popis <code>/tasks</code> tasks.index (popis chyb\u00ed) <code>/tasks/create</code> tasks.create (popis chyb\u00ed) <code>/tasks/{task}</code> tasks.show (popis chyb\u00ed) <code>/tasks/{task}/edit</code> tasks.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#projekty","title":"Projekty","text":"<p>Dlouhodob\u011bj\u0161\u00ed iniciativy agreguj\u00edc\u00ed \u00fakoly a obchodn\u00ed kontext.</p> Cesta Route name Popis <code>/projects</code> projects.index (popis chyb\u00ed) <code>/projects/create</code> projects.create (popis chyb\u00ed) <code>/projects/{project}</code> projects.show (popis chyb\u00ed) <code>/projects/{project}/edit</code> projects.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#knowledge-base","title":"Knowledge Base","text":"<p>Znalostn\u00ed b\u00e1ze (dokumenty, chunking, vektorov\u00e9 vyhled\u00e1v\u00e1n\u00ed).</p> Cesta Route name Popis <code>/knowledge</code> knowledge.index (popis chyb\u00ed) <code>/knowledge/create</code> knowledge.create (popis chyb\u00ed) <code>/knowledge/search/ajax</code> knowledge.search (popis chyb\u00ed) <code>/knowledge/{knowledge}/edit</code> knowledge.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#marketing","title":"Marketing","text":"<p>Strategie, exekuce, analytika, nastaven\u00ed marketingu.</p> Cesta Route name Popis <code>/marketing</code> marketing.dashboard (popis chyb\u00ed) <code>/marketing/analytika/ab-testovani</code> marketing.analytics.ab (popis chyb\u00ed) <code>/marketing/analytika/ai-sentiment</code> marketing.analytics.sentiment (popis chyb\u00ed) <code>/marketing/analytika/atribuce</code> marketing.analytics.attribution (popis chyb\u00ed) <code>/marketing/analytika/cross-channel</code> marketing.analytics.cross (popis chyb\u00ed) <code>/marketing/analytika/seo</code> marketing.analytics.seo (popis chyb\u00ed) <code>/marketing/cileni/databaze-kontaktu</code> marketing.target.contacts (popis chyb\u00ed) <code>/marketing/cileni/lead-nurturing</code> marketing.target.nurturing (popis chyb\u00ed) <code>/marketing/cileni/segmentace</code> marketing.target.segments (popis chyb\u00ed) <code>/marketing/exekuce/automatizace</code> marketing.exec.automation (popis chyb\u00ed) <code>/marketing/exekuce/email-marketing</code> marketing.exec.email (popis chyb\u00ed) <code>/marketing/exekuce/influenceri-partneri</code> marketing.exec.influencers (popis chyb\u00ed) <code>/marketing/exekuce/kampane</code> marketing.exec.campaigns (popis chyb\u00ed) <code>/marketing/exekuce/knihovna-obsahu</code> marketing.exec.content (popis chyb\u00ed) <code>/marketing/exekuce/landing-pages</code> marketing.exec.landing (popis chyb\u00ed) <code>/marketing/exekuce/reklamy</code> marketing.exec.ads (popis chyb\u00ed) <code>/marketing/nastaveni/ai-sablony</code> marketing.settings.ai (popis chyb\u00ed) <code>/marketing/nastaveni/importy</code> settings.imports (popis chyb\u00ed) <code>/marketing/nastaveni/integrace-api</code> marketing.settings.integrations (popis chyb\u00ed) <code>/marketing/nastaveni/lead-scoring</code> marketing.settings.scoring (popis chyb\u00ed) <code>/marketing/nastaveni/role-prava</code> marketing.settings.roles (popis chyb\u00ed) <code>/marketing/strategie/budget</code> marketing.strategy.budget (popis chyb\u00ed) <code>/marketing/strategie/kalendar</code> marketing.strategy.calendar (popis chyb\u00ed) <code>/marketing/strategie/persony</code> marketing.strategy.personas (popis chyb\u00ed) <code>/marketing/strategie/swot</code> marketing.strategy.swot (popis chyb\u00ed) <code>/marketing/strategie/trendy-ai</code> marketing.strategy.trends (popis chyb\u00ed)"},{"location":"16-generated/navigation/#chat","title":"Chat","text":"<p>Konverza\u010dn\u00ed AI / u\u017eivatelsk\u00e9 relace.</p> Cesta Route name Popis <code>/chat</code> crm.chat (popis chyb\u00ed) <code>/chat/sessions</code> (popis chyb\u00ed) <code>/chat/sessions/{id}/messages</code> (popis chyb\u00ed) <code>/chat/stream</code> (popis chyb\u00ed)"},{"location":"16-generated/navigation/#system","title":"System","text":"<p>Admin konfigurace (ActiveCampaign, Backup, Qdrant, Tools, Chat, integrace).</p> Cesta Route name Popis <code>/system/activecampaign</code> system.ac.index (popis chyb\u00ed) <code>/system/activecampaign/runs</code> system.ac.runs (popis chyb\u00ed) <code>/system/apps</code> system.apps.index (popis chyb\u00ed) <code>/system/backup</code> system.backup.index (popis chyb\u00ed) <code>/system/backup/download/{path}</code> system.backup.download (popis chyb\u00ed) <code>/system/chat</code> system.chat.index (popis chyb\u00ed) <code>/system/chat/diagnostics</code> system.chat.diagnostics (popis chyb\u00ed) <code>/system/chat/lookup</code> system.chat.lookup (popis chyb\u00ed) <code>/system/qdrant</code> system.qdrant.index (popis chyb\u00ed) <code>/system/tools</code> system.tools.index (popis chyb\u00ed)"},{"location":"16-generated/navigation/#deals","title":"Deals","text":"Cesta Route name Popis <code>/deals</code> deals.index (popis chyb\u00ed) <code>/deals/create</code> deals.create (popis chyb\u00ed) <code>/deals/{deal}</code> deals.show (popis chyb\u00ed) <code>/deals/{deal}/edit</code> deals.edit (popis chyb\u00ed)"},{"location":"16-generated/navigation/#knowledge-docs","title":"Knowledge docs","text":"Cesta Route name Popis <code>/knowledge-docs</code> knowledge.docs.index (popis chyb\u00ed) <code>/knowledge-docs/create</code> knowledge.docs.create (popis chyb\u00ed)"},{"location":"16-generated/navigation/#leads-kanban","title":"Leads kanban","text":"Cesta Route name Popis <code>/leads-kanban</code> leads.kanban (popis chyb\u00ed)"},{"location":"16-generated/navigation/#opportunities-pipeline","title":"Opportunities pipeline","text":"Cesta Route name Popis <code>/opportunities-pipeline</code> opportunities.pipeline (popis chyb\u00ed)"},{"location":"16-generated/navigation/#ops","title":"Ops","text":"Cesta Route name Popis <code>/ops</code> ops.dashboard (popis chyb\u00ed) <code>/ops/history</code> ops.history.index (popis chyb\u00ed) <code>/ops/metrics</code> ops.metrics (popis chyb\u00ed)"},{"location":"16-generated/navigation/#orders","title":"Orders","text":"Cesta Route name Popis <code>/orders/{order}/items</code> (popis chyb\u00ed)"},{"location":"16-generated/navigation/#products","title":"Products","text":"Cesta Route name Popis <code>/products</code> products.index (popis chyb\u00ed) <code>/products/{product}</code> products.show (popis chyb\u00ed)"},{"location":"16-generated/navigation/#search","title":"Search","text":"Cesta Route name Popis <code>/search/customers</code> search.customers (popis chyb\u00ed) <code>/search/taskables</code> search.taskables (popis chyb\u00ed)"},{"location":"16-generated/permissions/","title":"Permissions (generov\u00e1no)","text":""},{"location":"16-generated/permissions/#seznam-opravneni","title":"Seznam opr\u00e1vn\u011bn\u00ed","text":"Permission Guard \u017e\u00e1dn\u00e1 data <p>Pozn\u00e1mka: Nepoda\u0159ilo se z\u00edskat runtime data (<code>SQLSTATE[HY000] [2002] php_network_getaddresses: getaddrinfo for crm_esl_mysql failed: Temporary failure in name resolution (Connection: mysql, SQL: select * from</code>permissions<code>order by</code>name<code>asc)</code>). Spus\u0165te v b\u011b\u017e\u00edc\u00edm aplika\u010dn\u00edm kontejneru.</p>"},{"location":"16-generated/routes/","title":"Routy (generov\u00e1no)","text":"Metoda URI N\u00e1zev Middleware Akce GET / root web RoutingController@index GET apps/user-contacts apps.users.index web,auth UserManagementController@index GET apps/user-profile apps.me.show web,auth ProfileController@show POST apps/user-profile apps.me.update web,auth ProfileController@update GET apps/user-profile/{user} apps.users.edit web,auth UserManagementController@edit POST apps/user-profile/{user} apps.users.update web,auth UserManagementController@update GET crm crm.dashboard web,auth Closure GET crm/chat crm.chat web,auth,throttle:30,1 ChatController@page POST crm/chat/messages web,auth,throttle:30,1 ChatController@postMessage GET crm/chat/sessions web,auth,throttle:30,1 ChatController@sessions POST crm/chat/sessions web,auth,throttle:30,1 ChatController@createSession GET crm/chat/sessions/{id}/messages web,auth,throttle:30,1 ChatController@history GET crm/chat/stream web,auth,throttle:30,1 ChatController@stream GET crm/companies companies.index web,auth CompanyController@index POST crm/companies companies.store web,auth CompanyController@store GET crm/companies/create companies.create web,auth CompanyController@create DELETE crm/companies/{company} companies.destroy web,auth CompanyController@destroy GET crm/companies/{company} companies.show web,auth CompanyController@show PUT,PATCH crm/companies/{company} companies.update web,auth CompanyController@update GET crm/companies/{company}/edit companies.edit web,auth CompanyController@edit GET crm/contacts contacts.index web,auth ContactController@index POST crm/contacts contacts.store web,auth ContactController@store GET crm/contacts/create contacts.create web,auth ContactController@create DELETE crm/contacts/{contact} contacts.destroy web,auth ContactController@destroy GET crm/contacts/{contact} contacts.show web,auth ContactController@show PUT,PATCH crm/contacts/{contact} contacts.update web,auth ContactController@update GET crm/contacts/{contact}/edit contacts.edit web,auth ContactController@edit GET crm/deals deals.index web,auth DealController@index POST crm/deals deals.store web,auth DealController@store GET crm/deals/create deals.create web,auth DealController@create DELETE crm/deals/{deal} deals.destroy web,auth DealController@destroy GET crm/deals/{deal} deals.show web,auth DealController@show PUT,PATCH crm/deals/{deal} deals.update web,auth DealController@update GET crm/deals/{deal}/edit deals.edit web,auth DealController@edit GET crm/knowledge knowledge.index web,auth KnowledgeController@index POST crm/knowledge knowledge.store web,auth KnowledgeController@store GET crm/knowledge-docs knowledge.docs.index web,auth KnowledgeDocumentsController@index POST crm/knowledge-docs knowledge.docs.store web,auth KnowledgeDocumentsController@store GET crm/knowledge-docs/create knowledge.docs.create web,auth KnowledgeDocumentsController@create POST crm/knowledge-docs/{id}/purge knowledge.docs.purge web,auth KnowledgeDocumentsController@purge POST crm/knowledge-docs/{id}/reindex knowledge.docs.reindex web,auth KnowledgeDocumentsController@reindex GET crm/knowledge/create knowledge.create web,auth KnowledgeController@create GET crm/knowledge/search/ajax knowledge.search web,auth KnowledgeController@search DELETE crm/knowledge/{knowledge} knowledge.destroy web,auth KnowledgeController@destroy PUT crm/knowledge/{knowledge} knowledge.update web,auth KnowledgeController@update GET crm/knowledge/{knowledge}/edit knowledge.edit web,auth KnowledgeController@edit GET crm/leads leads.index web,auth LeadController@index POST crm/leads leads.store web,auth LeadController@store GET crm/leads-kanban leads.kanban web,auth LeadController@kanban GET crm/leads/create leads.create web,auth LeadController@create DELETE crm/leads/{lead} leads.destroy web,auth LeadController@destroy GET crm/leads/{lead} leads.show web,auth LeadController@show PUT,PATCH crm/leads/{lead} leads.update web,auth LeadController@update GET crm/leads/{lead}/edit leads.edit web,auth LeadController@edit PATCH crm/leads/{lead}/status leads.update-status web,auth LeadController@updateStatus POST crm/leads/{lead}/status web,auth LeadController@updateStatus GET crm/marketing marketing.dashboard web,auth Closure GET crm/marketing/analytika/ab-testovani marketing.analytics.ab web,auth Closure GET crm/marketing/analytika/ai-sentiment marketing.analytics.sentiment web,auth Closure GET crm/marketing/analytika/atribuce marketing.analytics.attribution web,auth Closure GET crm/marketing/analytika/cross-channel marketing.analytics.cross web,auth Closure GET crm/marketing/analytika/seo marketing.analytics.seo web,auth Closure GET crm/marketing/cileni/databaze-kontaktu marketing.target.contacts web,auth Closure GET crm/marketing/cileni/lead-nurturing marketing.target.nurturing web,auth Closure GET crm/marketing/cileni/segmentace marketing.target.segments web,auth Closure GET crm/marketing/exekuce/automatizace marketing.exec.automation web,auth Closure GET crm/marketing/exekuce/email-marketing marketing.exec.email web,auth Closure GET crm/marketing/exekuce/influenceri-partneri marketing.exec.influencers web,auth Closure GET crm/marketing/exekuce/kampane marketing.exec.campaigns web,auth Closure GET crm/marketing/exekuce/knihovna-obsahu marketing.exec.content web,auth Closure GET crm/marketing/exekuce/landing-pages marketing.exec.landing web,auth Closure GET crm/marketing/exekuce/reklamy marketing.exec.ads web,auth Closure GET crm/marketing/nastaveni/ai-sablony marketing.settings.ai web,auth Closure GET crm/marketing/nastaveni/importy settings.imports web,auth ImportsController@index GET crm/marketing/nastaveni/integrace-api marketing.settings.integrations web,auth Closure GET crm/marketing/nastaveni/lead-scoring marketing.settings.scoring web,auth Closure GET crm/marketing/nastaveni/role-prava marketing.settings.roles web,auth Closure GET crm/marketing/strategie/budget marketing.strategy.budget web,auth Closure GET crm/marketing/strategie/kalendar marketing.strategy.calendar web,auth Closure GET crm/marketing/strategie/persony marketing.strategy.personas web,auth Closure GET crm/marketing/strategie/swot marketing.strategy.swot web,auth Closure GET crm/marketing/strategie/trendy-ai marketing.strategy.trends web,auth Closure GET crm/opportunities opportunities.index web,auth OpportunityController@index POST crm/opportunities opportunities.store web,auth OpportunityController@store GET crm/opportunities-pipeline opportunities.pipeline web,auth OpportunityController@pipeline GET crm/opportunities/create opportunities.create web,auth OpportunityController@create DELETE crm/opportunities/{opportunity} opportunities.destroy web,auth OpportunityController@destroy GET crm/opportunities/{opportunity} opportunities.show web,auth OpportunityController@show PUT,PATCH crm/opportunities/{opportunity} opportunities.update web,auth OpportunityController@update GET crm/opportunities/{opportunity}/edit opportunities.edit web,auth OpportunityController@edit GET crm/ops ops.dashboard web,auth,can:ops.view DashboardController@index POST crm/ops/actions/{action} ops.action web,auth,can:ops.execute,throttle:ops-actions ActionController@run GET crm/ops/history ops.history.index web,auth,can:ops.view HistoryController@index GET crm/ops/metrics ops.metrics web,auth,can:ops.view MetricsController GET crm/orders/{order}/items web,auth OrderItemsController@show GET crm/products products.index web,auth,can:products.view ProductController@index GET crm/products/{product} products.show web,auth,can:products.view ProductController@show GET crm/projects projects.index web,auth ProjectController@index POST crm/projects projects.store web,auth ProjectController@store GET crm/projects/create projects.create web,auth ProjectController@create DELETE crm/projects/{project} projects.destroy web,auth ProjectController@destroy GET crm/projects/{project} projects.show web,auth ProjectController@show PUT,PATCH crm/projects/{project} projects.update web,auth ProjectController@update GET crm/projects/{project}/edit projects.edit web,auth ProjectController@edit GET crm/search/customers search.customers web,auth SearchController@customers GET crm/search/taskables search.taskables web,auth SearchController@taskables GET crm/system/activecampaign system.ac.index web,auth ActiveCampaignController@index POST crm/system/activecampaign/import system.ac.import web,auth ActiveCampaignController@importBatch POST crm/system/activecampaign/import-10 system.ac.import10 web,auth ActiveCampaignController@importTen POST crm/system/activecampaign/import-all system.ac.importAll web,auth ActiveCampaignController@importAll POST crm/system/activecampaign/reset-offset system.ac.resetOffset web,auth ActiveCampaignController@resetOffset POST crm/system/activecampaign/run-batch system.ac.runBatch web,auth ActiveCampaignController@runBatch GET crm/system/activecampaign/runs system.ac.runs web,auth ActiveCampaignController@runs POST crm/system/activecampaign/test system.ac.test web,auth ActiveCampaignController@test POST crm/system/activecampaign/toggle system.ac.toggle web,auth ActiveCampaignController@toggleAuto POST crm/system/agentv2/enable system.agentv2.enable web,auth AgentV2SetupController@enable GET crm/system/apps system.apps.index web,auth AppsController@index POST crm/system/apps system.apps.store web,auth AppsController@store POST crm/system/apps/{appLink} system.apps.update web,auth AppsController@update POST crm/system/apps/{appLink}/delete system.apps.destroy web,auth AppsController@destroy GET crm/system/backup system.backup.index web,auth BackupController@index POST crm/system/backup/clean system.backup.clean web,auth BackupController@clean GET crm/system/backup/download/{path} system.backup.download web,auth BackupController@download POST crm/system/backup/run system.backup.run web,auth BackupController@run GET crm/system/chat system.chat.index web,auth ChatSettingsController@index POST crm/system/chat system.chat.save web,auth ChatSettingsController@save POST crm/system/chat/backfill system.chat.backfill web,auth ChatSettingsController@backfillNormalized GET crm/system/chat/diagnostics system.chat.diagnostics web,auth ChatSettingsController@diagnostics GET crm/system/chat/lookup system.chat.lookup web,auth ChatSettingsController@lookup POST crm/system/chat/test system.chat.test web,auth ChatSettingsController@test POST crm/system/migrate system.migrate web,auth MaintenanceController@migrate GET crm/system/qdrant system.qdrant.index web,auth QdrantController@index POST crm/system/qdrant/purge-reindex system.qdrant.purgeReindex web,auth QdrantMaintenanceController@purgeReindex POST crm/system/qdrant/recreate system.qdrant.recreate web,auth QdrantMaintenanceController@recreate POST crm/system/qdrant/save system.qdrant.save web,auth QdrantController@save POST crm/system/qdrant/test system.qdrant.test web,auth QdrantController@test POST crm/system/qdrant/verify system.qdrant.verify web,auth QdrantController@verify GET crm/system/tools system.tools.index web,auth ToolsController@index POST crm/system/tools/playwright/save system.tools.playwright.save web,auth ToolsController@savePlaywright POST crm/system/tools/playwright/test system.tools.playwright.test web,auth ToolsController@testPlaywright POST crm/system/tools/playwright/toggle system.tools.playwright.toggle web,auth ToolsController@togglePlaywright GET crm/tasks tasks.index web,auth TaskController@index POST crm/tasks tasks.store web,auth TaskController@store GET crm/tasks/create tasks.create web,auth TaskController@create DELETE crm/tasks/{task} tasks.destroy web,auth TaskController@destroy GET crm/tasks/{task} tasks.show web,auth TaskController@show PUT,PATCH crm/tasks/{task} tasks.update web,auth TaskController@update GET crm/tasks/{task}/edit tasks.edit web,auth TaskController@edit GET index index web,auth Closure GET login login web,nocache AuthController@showLogin POST login login.attempt web,rotate.session AuthController@login POST logout logout web AuthController@logout GET storage/{path} storage.local Closure GET up Closure GET {any} any web RoutingController@root GET {first}/{second} second web RoutingController@secondLevel GET {first}/{second}/{third} third web RoutingController@thirdLevel"},{"location":"16-generated/schedule/","title":"Schedule (generov\u00e1no)","text":"Typ C\u00edl Frekvence Queue Pozn\u00e1mka command backup:run command backup:clean weeklyOn(1, '4:00') job \\App\\Jobs\\ActiveCampaignSyncJob everyMinute job \\App\\Jobs\\Ops\\EvaluateBackupHealthJob everyTenMinutes ops call closure command products:import-full command products:sync-availability"}]}